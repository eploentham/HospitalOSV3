/*ทดสอบภาษาไทย*/(SELECT 	b_site.b_visit_office_id as HCODE  	, t_patient.patient_hn as HN  	, substring(t_patient.patient_changwat from 1 for 2) as CHANGWAT  	, substring(t_patient.patient_amphur from 3 for 2) as AMPHUR   	, CASE WHEN (length(t_patient.patient_birthday)>=10)then to_char(to_date(to_number(substr(t_patient.patient_birthday,1,4),'9999')-543 || substr(t_patient.patient_birthday,5,6),'yyyy-mm-dd'),'yyyymmdd')                     ELSE ''   END AS DOB 	, t_patient.f_sex_id as SEX  	, t_patient.f_patient_marriage_status_id as MARRIAGE  	, CASE 		WHEN (t_patient.f_patient_occupation_id ='903'			OR  t_patient.f_patient_occupation_id ='904'			OR  t_patient.f_patient_occupation_id ='905'			OR  t_patient.f_patient_occupation_id ='906')  			THEN '900'  		WHEN (t_patient.f_patient_occupation_id ='509')  			THEN '501'  		WHEN (t_patient.f_patient_occupation_id ='804')  			THEN '803'  		ELSE t_patient.f_patient_occupation_id  END AS OCCUPA  	, CASE 		WHEN (t_patient.f_patient_nation_id = '0')  			THEN '00' 		ELSE t_patient.f_patient_nation_id  END AS NATION  	, t_patient.patient_pid as PERSON_ID  FROM 	b_site,t_visit  	INNER JOIN t_patient ON t_visit.t_patient_id = t_patient.t_patient_id      LEFT JOIN f_patient_prefix on f_patient_prefix.f_patient_prefix_id = t_patient.f_patient_prefix_idWHERE  t_visit.f_visit_status_id <> '4' 	AND substring(t_visit.visit_begin_visit_time,1,10) >= ?	AND substring(t_visit.visit_begin_visit_time,1,10) <= ?group by	 HCODE  	, HN  	, CHANGWAT  	, AMPHUR  	,  DOB  	, SEX  	, MARRIAGE  	, OCCUPA  	, NATION  	, PERSON_ID  ORDER BY HN)UNION(SELECT 	b_site.b_visit_office_id as HCODE  	, t_patient.patient_hn as HN  	, substring(t_patient.patient_changwat from 1 for 2) as CHANGWAT  	, substring(t_patient.patient_amphur from 3 for 2) as AMPHUR   	, CASE WHEN (length(t_patient.patient_birthday)>=10)then to_char(to_date(to_number(substr(t_patient.patient_birthday,1,4),'9999')-543 || substr(t_patient.patient_birthday,5,6),'yyyy-mm-dd'),'yyyymmdd')                     ELSE ''   END AS DOB 	, t_patient.f_sex_id as SEX  	, t_patient.f_patient_marriage_status_id as MARRIAGE  	, CASE 		WHEN (t_patient.f_patient_occupation_id ='903'			OR  t_patient.f_patient_occupation_id ='904'			OR  t_patient.f_patient_occupation_id ='905'			OR  t_patient.f_patient_occupation_id ='906')  			THEN '900'  		WHEN (t_patient.f_patient_occupation_id ='509')  			THEN '501'  		WHEN (t_patient.f_patient_occupation_id ='804')  			THEN '803'  		ELSE t_patient.f_patient_occupation_id  END AS OCCUPA  	, CASE 		WHEN (t_patient.f_patient_nation_id = '0')  			THEN '00' 		ELSE t_patient.f_patient_nation_id  END AS NATION  	, t_patient.patient_pid as PERSON_ID  FROM 	b_site,t_visit  	INNER JOIN t_patient ON t_visit.t_patient_id = t_patient.t_patient_id      LEFT JOIN f_patient_prefix on f_patient_prefix.f_patient_prefix_id = t_patient.f_patient_prefix_idWHERE  t_visit.f_visit_status_id <> '4'     AND t_visit.f_visit_type_id = '1'       AND substring(t_visit.visit_staff_doctor_discharge_date_time,1,10) >= ?       AND substring(t_visit.visit_staff_doctor_discharge_date_time,1,10) <= ?group by	 HCODE  	, HN  	, CHANGWAT  	, AMPHUR  	,  DOB  	, SEX  	, MARRIAGE  	, OCCUPA  	, NATION  	, PERSON_ID   ORDER BY HN)