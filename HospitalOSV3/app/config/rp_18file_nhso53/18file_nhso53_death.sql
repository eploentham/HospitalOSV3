--death_53SELECT	b_site.b_visit_office_id AS PCUCODE  --NOT NULL	,t_health_family.patient_pid AS CID    ,t_health_family.health_family_hn_hcis as PID --NOT NULL	,CASE		WHEN length( t_death.death_date_time) > 11			THEN  (to_number(substring(t_death.death_date_time,1,4),'9999')-543)				|| substring(t_death.death_date_time,6,2)				|| substring(t_death.death_date_time,9,2)		ELSE '' END AS DDEATH--konshow : hosv39_beta_scope_010210.xls ÅÓ´Ñº 234,replace(cdeath_a.icd10_number,'.','') as CDEATH_A,replace(cdeath_b.icd10_number,'.','') as CDEATH_B,replace(cdeath_c.icd10_number,'.','') as CDEATH_C,replace(cdeath_d.icd10_number,'.','') as CDEATH_D,replace(t_death.death_external_cause_of_injury,'.','') as ODISEASE,replace(t_death.death_cause,'.','') as CDEATH--konshow--, t_death.death_site AS PDEATH, case when length(t_death.death_date_time) >= 10                then case when length(cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':','')) = 14                                  then (cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':',''))                                  when length(cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':','')) =12                                  then (cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':','')) || '00'                                  when length(cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':','')) =10                                  then (cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':','')) || '0000'                                  when length(cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':','')) = 8                                  then (cast(substring(t_death.death_date_time,1,4) as numeric) - 543                                                || replace(replace(replace(substring(t_death.death_date_time,5),'-',''),',',''),':','')) || '000000'                                  else ''                           end                else ''       end as D_UPDATE --NOT NULLFROM  t_death    INNER JOIN  t_health_family ON t_health_family.t_health_family_id = t_death.t_health_family_id    LEFT JOIN b_icd10 as cdeath_a on t_death.death_primary_diagnosis = cdeath_a.b_icd10_id    LEFT JOIN b_icd10 as cdeath_b on t_death.death_comorbidity = cdeath_b.b_icd10_id    LEFT JOIN b_icd10 as cdeath_c on t_death.death_complication = cdeath_c.b_icd10_id    LEFT JOIN b_icd10 as cdeath_d on t_death.death_others = cdeath_d.b_icd10_id	,b_siteWHERE  t_death.death_active = '1'    AND health_family_active = '1'	AND substring(t_death.death_date_time,1,10) >= ?	AND substring(t_death.death_date_time,1,10) <= ? 