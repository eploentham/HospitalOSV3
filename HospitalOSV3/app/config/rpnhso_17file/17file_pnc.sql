select distinct b_site.b_visit_office_id || substring(t_health_postpartum.t_health_postpartum_id,9)  as PNC_ID,b_site.b_visit_office_id ||  substr(t_nhso_service_pp.t_nhso_service_pp_id,11)  as  T_SERVICE_ID,case when (t_health_postpartum.health_postpartum_pregnant_number is not null                     and trim(t_health_postpartum.health_postpartum_pregnant_number) <> '')            then cast(cast(t_health_postpartum.health_postpartum_pregnant_number as numeric) as varchar)            when t_health_delivery.gravida_number is not null            then cast(cast(t_health_delivery.gravida_number as numeric) as varchar)            else ''end as PREGNANCY_NUMBER,case when (t_health_delivery.health_delivery_born_date is not null and (length(t_health_delivery.health_delivery_born_date)>=10))          then  to_char(to_date(to_number( substr(t_health_delivery.health_delivery_born_date,1,4),'9999')-543 ||                     substr(t_health_delivery.health_delivery_born_date,5,6),'yyyy-mm-dd'),'yyyymmdd')           else ''    end AS SON_DATE,case when (t_health_postpartum.health_postpartum_visit is not null and trim(t_health_postpartum.health_postpartum_visit) <> '')        then cast(cast(t_health_postpartum.health_postpartum_visit as numeric) as varchar)         else ''end as PNC,case when t_health_postpartum.health_postpartum_summary_verify = '1'                    then '1'                    when t_health_postpartum.health_postpartum_summary_verify = '0'                    then '2'          else '0'  end as CHECKBODY, case when (select t_health_family_planing_id from t_health_family_planing                         where t_health_family_planing.t_visit_id = t_visit.t_visit_id and t_health_family_planing.health_family_planing_active = '1') is not null            then '1'           else '0'end as FP,case when t_nhso_postpartum.health_postpartum_guide in ('0','1')           then t_nhso_postpartum.health_postpartum_guide          else ''  end as MUM,case when (select t_nhso_screen_cancer.screen_cancer_cervix_exam from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id) in ('1','2','3')           then (select t_nhso_screen_cancer.screen_cancer_cervix_exam from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id)          else '0' end as PAPSMEAR,case when (select t_nhso_screen_cancer.screen_cancer_cervix_exam from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id) in ('1','2','3')           then b_site.b_visit_office_id ||                    substring((select t_nhso_screen_cancer.t_nhso_screen_cancer_id from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id),11)          else '' end as PAPID,case when (select t_nhso_screen_cancer.screen_cancer_cervix_exam from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id) = '2'           then trim(t_visit.visit_have_refer)           else '0' end as REFERPAP,case when (select t_nhso_screen_cancer.screen_cancer_breast_check from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.screen_cancer_breast_check = '1'                                 and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id) is not null          then '1'          else '0' end as BREAST,case when (select t_nhso_screen_cancer.screen_cancer_breast_check from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.screen_cancer_breast_check = '1'                                 and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id) is not null          then b_site.b_visit_office_id ||                     substring((select t_nhso_screen_cancer.t_nhso_screen_cancer_id from t_nhso_screen_cancer                    where t_nhso_screen_cancer.screen_cancer_active = '1' and t_nhso_screen_cancer.screen_cancer_breast_check = '1'                                 and t_nhso_screen_cancer.t_visit_id = t_visit.t_visit_id),11)          else '' end as BREASTID,t_nhso_service_pp.pp_totalpay as TOTALPAY        ,visit_vn as vnfrom t_health_postpartum     inner join t_nhso_postpartum on t_health_postpartum.t_health_postpartum_id = t_nhso_postpartum.t_health_postpartum_id    inner join t_visit on t_health_postpartum.t_visit_id = t_visit.t_visit_id    inner join t_patient on t_patient.t_patient_id = t_visit.t_patient_id    inner join t_nhso_service_pp on t_nhso_service_pp.pp_id  = t_health_postpartum.t_health_postpartum_id     left join t_health_delivery on t_health_postpartum.t_health_delivery_id = t_health_delivery.t_health_delivery_id,b_sitewhere t_visit.f_visit_status_id <> '4'and t_health_postpartum.health_postpartum_active = '1'and t_nhso_service_pp.pp_active = '1' and t_nhso_service_pp.pp_name like 'PNC%'and  substr(t_visit.visit_begin_visit_time,1,10 )  >= ?and  substr(t_visit.visit_begin_visit_time,1,10 )  <= ?