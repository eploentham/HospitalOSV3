SELECTb_site.b_visit_office_id || substring(t_health_counsel.t_health_counsel_id,9)  as CONSULT_ID,b_site.b_visit_office_id || substring(t_nhso_service_pp.t_nhso_service_pp_id,11)  as T_SERVICE_ID,case when(b_nhso_map_concounseling.f_nhso_counseling_id = '09')    	then '1'	else '0'  	end  as CRONIC,case when(b_nhso_map_concounseling.f_nhso_counseling_id = '10')    	then '1'	else '0' 	end  as TENSION,case when(b_nhso_map_concounseling.f_nhso_counseling_id = '11')    	then '1'	else '0'  	end  as DRUG,case when(b_nhso_map_concounseling.f_nhso_counseling_id = '12')    	then '1'	else '0' 	end  as COUNSELING,case when t_health_counsel.counsel_remark is not null    then trim(t_health_counsel.counsel_remark)    else '' end  as COUNSELING_DETAIL,case when t_health_counsel.counsel_detail is not null    then trim(t_health_counsel.counsel_detail)     else '' end  as COUNSEL_DETAIL,case when (t_nhso_service_pp.pp_totalpay is not null and trim(t_nhso_service_pp.pp_totalpay) <> '')      then cast(trim(t_nhso_service_pp.pp_totalpay) as numeric)     else 0 end as  TOTALPAY        ,visit_vn as vnfrom t_health_counsel    inner join t_visit on t_health_counsel.t_visit_id = t_visit.t_visit_id     inner join t_nhso_service_pp on t_health_counsel.t_health_counsel_id = t_nhso_service_pp.pp_id    inner join t_patient on t_patient.t_patient_id = t_visit.t_patient_id      inner join b_nhso_map_concounseling             on (t_health_counsel.b_health_counsel_type_id = b_nhso_map_concounseling.b_health_service_type_id                and b_nhso_map_concounseling.f_nhso_counseling_id in ('09','10','11','12'))    ,b_sitewhere  t_health_counsel.counsel_active = '1'      and t_visit.f_visit_status_id <> '4' 	and t_nhso_service_pp.pp_active = '1'    and  substring(t_visit.visit_begin_visit_time,1,10 )  >= ?	and  substring(t_visit.visit_begin_visit_time,1,10 )  <= ?