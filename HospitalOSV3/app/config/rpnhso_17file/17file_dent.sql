SELECT distinctb_site.b_visit_office_id  || substring(t_nhso_dental_adult.t_nhso_dental_adult_id,9)  as DENT_ID,b_site.b_visit_office_id || substring(t_nhso_service_pp.t_nhso_service_pp_id,11)  as T_SERVICE_ID,case when (t_nhso_dental_adult.dental_adult_consultdent = '1')    then '1'    else '0'    end as  CONSULT_DENT,case when t_nhso_dental_adult.dental_adult_treat_dent_desc is not null     then replace(trim(t_nhso_dental_adult.dental_adult_treat_dent_desc),'\n','')     else '' end  as OTHERE_DENT ,case when (t_nhso_dental_adult.dental_adult_toothimpaction = '1')    then '1'    else '0'    end as  TOOTH_IMPACTION,case when (t_nhso_dental_adult.dental_adult_residual_ridge_gum = '1')    then '1'    else '0'    end as  RESIDUAL_RIDGE_GUM,case when (t_nhso_dental_adult.dental_adult_dentalcaries = '1')    then '1'    else '0'    end as  DENTALCARIES,case when (t_nhso_dental_adult.dental_adult_dentalcaries = '1' and t_nhso_dental_adult.dental_adult_dentalcaries_no is not null)     then trim(t_nhso_dental_adult.dental_adult_dentalcaries_no)     else ''  end as DENTALCARIES_NO,case when t_nhso_dental_adult.dental_adult_gumnormal in ('1','2')    then t_nhso_dental_adult.dental_adult_gumnormal    else ''    end as  GUM_NORMAL,case when (t_nhso_dental_adult.dental_adult_calculus = '1')    then '1'    else '0'    end as  CALCULUS,case when (t_nhso_dental_adult.dental_periodontali = '1')    then '1'    else '0'    end as  PERIODONTALL,case when t_nhso_dental_adult.dental_adult_gum_etc is not null     then trim(t_nhso_dental_adult.dental_adult_gum_etc)    else ''end as GUN_OTHER,case when ( t_nhso_dental_adult.dental_adult_crown is not null                     and trim(t_nhso_dental_adult.dental_adult_crown) <> ''                     and trim(t_nhso_dental_adult.dental_adult_crown) <> 'null' )   then cast(cast(trim(t_nhso_dental_adult.dental_adult_crown) as numeric) as varchar)   else '0'   end  as CROWN,case when ( t_nhso_dental_adult.dental_adult_pulltooth is not null                     and trim(t_nhso_dental_adult.dental_adult_pulltooth) <> ''                     and trim(t_nhso_dental_adult.dental_adult_pulltooth) <> 'null' )   then cast(cast(trim(t_nhso_dental_adult.dental_adult_pulltooth) as numeric) as varchar)   else '0'   end  as PULL_TOOTH,case when ( t_nhso_dental_adult.dental_adult_rct is not null                     and trim(t_nhso_dental_adult.dental_adult_rct) <> ''                     and trim(t_nhso_dental_adult.dental_adult_rct) <> 'null' )   then cast(cast(trim(t_nhso_dental_adult.dental_adult_rct) as numeric) as varchar)   else '0'   end  as RCT,case when ( t_nhso_dental_adult.dental_adult_wte is not null                     and trim(t_nhso_dental_adult.dental_adult_wte) <> ''                     and trim(t_nhso_dental_adult.dental_adult_wte) <> 'null' )   then cast(cast(trim(t_nhso_dental_adult.dental_adult_wte) as numeric) as varchar)   else '0'   end  as WTE,case when ( t_nhso_dental_adult.dental_adult_denture is not null                     and trim(t_nhso_dental_adult.dental_adult_denture) <> ''                     and trim(t_nhso_dental_adult.dental_adult_denture) <> 'null' )   then cast(cast(trim(t_nhso_dental_adult.dental_adult_denture) as numeric) as varchar)   else '0'   end  as DENTURE,case when (t_nhso_dental_adult.dental_adult_tooth_root_scrape = '1'                     and t_nhso_dental_adult.dental_adult_calculus_scrape is not null                     and trim(t_nhso_dental_adult.dental_adult_calculus_scrape) <> ''                     and trim(t_nhso_dental_adult.dental_adult_calculus_scrape) <> 'null' )   then cast(cast(trim(t_nhso_dental_adult.dental_adult_calculus_scrape) as numeric) as varchar)   else '0'   end  as CALCULUS_SCRAPE,case when (t_nhso_dental_adult.dental_adult_tooth_root_scrape = '1')    then '1'    else '0'    end as  TOOTH_ROOT_SCRAPE,case when (t_nhso_dental_adult.dental_adult_other_dentshould is not null                     and trim(t_nhso_dental_adult.dental_adult_other_dentshould)  <> 'null')    then trim(t_nhso_dental_adult.dental_adult_other_dentshould )     else ''  end as OTHERDENT,case when (t_nhso_dental_adult.dental_adult_service_tartar_scrape = '1')    then '1'    else '0'    end as  SERVICE_TARTAR_SCRAPE,case when (t_nhso_dental_adult.dental_adult_certificate_id_dentist is not null and trim(t_nhso_dental_adult.dental_adult_certificate_id_dentist) <> '')    then trim(t_nhso_dental_adult.dental_adult_certificate_id_dentist)    else ''end as CERTIFICATE_ID_DENTIST,t_nhso_service_pp.pp_totalpay  as TOTALPAY        ,visit_vn as vnfrom t_health_dental     inner join t_visit on t_health_dental.t_visit_id = t_visit.t_visit_id    inner join t_nhso_dental_adult on t_health_dental.t_health_dental_id = t_nhso_dental_adult.t_health_dental_id    inner join t_nhso_service_pp on t_nhso_dental_adult.t_nhso_dental_adult_id = t_nhso_service_pp.pp_id    inner join t_patient on t_visit.t_patient_id = t_patient.t_patient_id     ,b_sitewhere t_visit.f_visit_status_id <> '4'	AND t_nhso_service_pp.pp_active = '1'    AND  substr(t_visit.visit_begin_visit_time,1,10 )  >= ?	AND  substr(t_visit.visit_begin_visit_time,1,10 )  <= ?