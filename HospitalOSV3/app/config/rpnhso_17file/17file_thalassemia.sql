SELECT distinct b_site.b_visit_office_id || substring(t_nhso_thalassemia.t_nhso_thalassemia_id,11) as THALAS_ID,b_site.b_visit_office_id || substring(t_nhso_service_pp.t_nhso_service_pp_id,11)  as T_SERVICE_ID,case when t_nhso_thalassemia.thalassemia_hbtyping = '1'      then t_nhso_thalassemia.thalassemia_hbtyping_type       else '0'      end as HBTYPING,case when t_nhso_thalassemia.thalassemia_alpha = '1'      then t_nhso_thalassemia.thalassemia_alpha_type      else '0'       end as ALPHATHALASSEMIA,case when t_nhso_thalassemia.thalassemia_pnd = '1'      then t_nhso_thalassemia.thalassemia_pnd_type      else '0'       end as PND,case when t_nhso_thalassemia.thalassemia_mutation = '1'      then t_nhso_thalassemia.thalassemia_mutation_type       else '0'       end as MUTATION,case when thalassemia_card_type_hb = '1'       then t_nhso_thalassemia.thalassemia_husband_pid_hb       else ''  end as PID_HB,case when(t_nhso_thalassemia.thalassemia_card_type_hb in ('1','2','3','4'))    then t_nhso_thalassemia.thalassemia_card_type_hb    else ''    end as PID_TYPE,case when t_nhso_thalassemia.thalassemia_card_type_hb = '4'     then t_nhso_thalassemia.thalassemia_other_card     else ''    end as PID_TYPE_NOTE,case when t_nhso_thalassemia.thalassemia_ofmcv_hb = '1'      then t_nhso_thalassemia.thalassemia_ofmcv_type_hb      else '0'       end  as OF_MCV_HB,case when t_nhso_thalassemia.thalassemia_dcipescreen_hb = '1'      then t_nhso_thalassemia.thalassemia_dcipescreen_type_hb      else '0'       end  as DCIP_ESCREEN_HB,case when t_nhso_thalassemia.thalassemia_hbtyping_hb = '1'      then t_nhso_thalassemia.thalassemia_hbtyping_type_hb      else '0'       end  as HBTYPING_HB ,case when t_nhso_thalassemia.thalassemia_alpha_hb = '1'      then  t_nhso_thalassemia.thalassemia_alpha_type_hb      else '0'       end  as ALPHATHALASSEMIA_HB ,case when t_nhso_thalassemia.thalassemia_mutation_hb = '1'     then t_nhso_thalassemia.thalassemia_mutation_type_hb     else '0'      end  as MUTATION_HB ,t_nhso_service_pp.pp_totalpay as totalpay_hb        ,visit_vn as vnfrom t_nhso_thalassemiainner join t_visit on t_nhso_thalassemia.t_visit_id = t_visit.t_visit_idinner join t_nhso_service_pp on t_nhso_thalassemia.t_nhso_thalassemia_id = t_nhso_service_pp.pp_id,b_sitewhere t_visit.f_visit_status_id <> '4'    and t_nhso_service_pp.pp_active = '1'    and t_nhso_thalassemia.thalassemia_active = '1'    and  substr(t_visit.visit_begin_visit_time,1,10 )  >= ?    and  substr(t_visit.visit_begin_visit_time,1,10 )  <= ?