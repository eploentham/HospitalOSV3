selectvisit_hn as hn,visit_vn as an,	CASE WHEN (length(t_visit.visit_begin_visit_time)>=10)then to_char(to_date(to_number(substr(t_visit.visit_begin_visit_time,1,4),'9999')-543 || substr(t_visit.visit_begin_visit_time,5,6),'yyyy-mm-dd'),'yyyymmdd')                     ELSE ''   END AS  dateopd ,t_accident.accident_claim_code as authae,	 CASE WHEN (length(accident_date)>=10)then to_char(to_date(to_number(substr(accident_date,1,4),'9999')-543 || substr(accident_date,5,6),'yyyy-mm-dd'),'yyyymmdd')                     ELSE ''   END AS  aedate ,substr(accident_time,1,2)||substr(accident_time,4,2) as aetime,case when accident_accident_type='' then 'O'    else accident_accident_type end as aetype,refer_in.visit_refer_in_out_refer_hospital as refmaini,refer_in.visit_refer_in_out_observe||refer_in.visit_refer_in_out_treatment|| refer_in.visit_refer_in_out_lab || '0' as ireftype,refer_out.visit_refer_in_out_refer_hospital as refmaino,case when t_visit.f_refer_cause_id='1' then '1000'    when (t_visit.f_refer_cause_id='2'        or t_visit.f_refer_cause_id='3'        or t_visit.f_refer_cause_id='4'        or t_visit.f_refer_cause_id='5'        or t_visit.f_refer_cause_id='6') then  '0100'    when t_visit.f_refer_cause_id='7' then  '0001'     else '0000' end as oreftype,accident_occur_type as ucae,accident_emergency_type as emtype,accident_vn as seq from t_accident inner join t_visit on t_accident.t_visit_id = t_visit.t_visit_idleft join t_visit_refer_in_out as refer_in on (refer_in.t_visit_id = t_visit.t_visit_id     and refer_in.visit_refer_in_out_active = '1'    and refer_in.f_visit_refer_type_id = '0')left join t_visit_refer_in_out as refer_out on (refer_out.t_visit_id = t_visit.t_visit_id     and refer_out.visit_refer_in_out_active = '1'    and refer_out.f_visit_refer_type_id = '1')where substr(visit_begin_visit_time,1,10) >= ?and substr(visit_begin_visit_time,1,10) <= ?    and t_visit.f_visit_type_id <> 'S'order by hn