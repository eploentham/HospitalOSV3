select    t_visit.visit_hn as hn,    t_visit.visit_vn as an,    CASE WHEN (length(t_visit.visit_begin_visit_time)>=10)                then to_char(to_date(to_number(substr(t_visit.visit_begin_visit_time,1,4),'9999')-543 ||                        substr(t_visit.visit_begin_visit_time,5,6),'yyyy-mm-dd'),'yyyymmdd')                ELSE ''   END AS  dateopd    ,case when (substr(b_item.r_rp1253_adpcode_id,1,2)='HC'                         or  substr(b_item.r_rp1253_adpcode_id,1,2)='CA'                         or  substr(b_item.r_rp1253_adpcode_id,1,1)='O') then '1'                when                        (substr(b_item.r_rp1253_adpcode_id,1,2)='IP'                        or  substr(b_item.r_rp1253_adpcode_id,1,2)='01') then '2'                when                        (substr(b_item.r_rp1253_adpcode_id,1,2)='10'                        or  substr(b_item.r_rp1253_adpcode_id,1,2)='20') then '4'                when                        (substr(b_item.r_rp1253_adpcode_id,1,3)='ART'                        or  substr(b_item.r_rp1253_adpcode_id,1,1)='Z') then '5'                when                        ( substr(b_item.r_rp1253_adpcode_id,1,1)='3') then '3'                        else '' end as type    ,b_item.r_rp1253_adpcode_id as code    ,t_order.order_qty as qty    ,t_order.order_price as rate    ,t_visit.visit_vn as seqfrom t_order    inner join b_item on b_item.b_item_id = t_order.b_item_id    inner join t_visit on t_order.t_visit_id = t_visit.t_visit_idwhere substr(t_visit.visit_begin_visit_time,1,10) >= ?    and substr(t_visit.visit_begin_visit_time,1,10) <= ?    and t_visit.f_visit_type_id <> 'S'    and t_order.f_order_status_id <> '3'    and t_visit.f_visit_status_id <>'4'    and (substr(b_item.r_rp1253_adpcode_id,1,2) in ('HC','CA','IP','01','10','20')            OR substr(b_item.r_rp1253_adpcode_id,1,1) in ('O','Z','3')            OR substr(b_item.r_rp1253_adpcode_id,1,3)='ART')order by hn