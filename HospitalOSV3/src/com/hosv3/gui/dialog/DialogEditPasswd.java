/*
 * PanelSetupEditPasswd.java
 *
 * Created on 11 ตุลาคม 2546, 17:14 น.
 */
package com.hosv3.gui.dialog;
import java.awt.*;
import com.hosv3.utility.*;
import com.hosv3.utility.connection.*;
import com.hosv3.control.*;
import com.hosv3.object.*;
import com.hosv3.subject.*;
import com.hospital_os.object.*;
import com.hospital_os.utility.CryptPassword;

/**
 *
 * @panel author : amp
 * @panel update : tong
 */
public class DialogEditPasswd extends javax.swing.JDialog //extends javax.swing.JPanel 
{
    UpdateStatus theUS;
    HosControl theHC;
    HosObject theHO;
    public static boolean actionCommand = false;
    SetupControl theSetupControl;
    SetupSubject theSetupSubject;
    String employee;
    Employee theEmployee2;
    
    public DialogEditPasswd(HosControl hc,UpdateStatus us,Employee emp2)
    {   
        super(us.getJFrame(),true);
        theHC = hc;
        theHO = hc.theHO;
        theSetupControl = hc.theSetupControl;
        theEmployee2 = emp2;
        initComponents();
        setLanguage("");
    }
   public void setLanguage(String msg)
    {
        GuiLang.setLanguage(jLabel3);
	GuiLang.setLanguage(jLabel1);
	GuiLang.setLanguage(jLabel2);
	GuiLang.setLanguage(jLabel4);
	GuiLang.setLanguage(jButtonSave);
	GuiLang.setLanguage(jButtonCancel);
    } 
    public void getEmployee(String employee) 
    {
        jTextFieldCode.setText(employee);
    }
  
    private void setLookup()
    {   
        setComboBox();
    }
    
    private void setComboBox()
    {  
    
    }  
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        defaultFont1 = new com.hospital_os.gui.font.DefaultFont();
        fontFormatTitle1 = new com.hospital_os.gui.font.FontFormatTitle();
        jPanel2 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jTextFieldCode = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        jPasswordFieldPasswd = new javax.swing.JPasswordField();
        jPasswordFieldRePasswd = new javax.swing.JPasswordField();
        jPanel3 = new javax.swing.JPanel();
        jButtonSave = new javax.swing.JButton();
        jButtonCancel = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jLabelStatus = new javax.swing.JLabel();

        getContentPane().setLayout(new java.awt.GridBagLayout());

        jPanel2.setLayout(new java.awt.GridBagLayout());

        jPanel2.setMaximumSize(new java.awt.Dimension(300, 150));
        jPanel2.setMinimumSize(new java.awt.Dimension(300, 150));
        jPanel2.setPreferredSize(new java.awt.Dimension(300, 150));
        jLabel1.setText(java.util.ResourceBundle.getBundle("com/hosv3/property/thai").getString("USERNAME_COL"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        jPanel2.add(jLabel1, gridBagConstraints);

        jLabel2.setText(java.util.ResourceBundle.getBundle("com/hosv3/property/thai").getString("USER_PASSWORD_NEW_COL"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        jPanel2.add(jLabel2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);
        jPanel2.add(jTextFieldCode, gridBagConstraints);

        jLabel3.setFont(fontFormatTitle1);
        jLabel3.setText(java.util.ResourceBundle.getBundle("com/hosv3/property/thai").getString("USER_CHANGE_PASSWORD"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        jPanel2.add(jLabel3, gridBagConstraints);

        jLabel4.setText(java.util.ResourceBundle.getBundle("com/hosv3/property/thai").getString("USER_PASSWORD_RE_NEW_COL"));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        jPanel2.add(jLabel4, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);
        jPanel2.add(jPasswordFieldPasswd, gridBagConstraints);

        jPasswordFieldRePasswd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jPasswordFieldRePasswdActionPerformed(evt);
            }
        });
        jPasswordFieldRePasswd.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyPressed(java.awt.event.KeyEvent evt) {
                jPasswordFieldRePasswdKeyPressed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);
        jPanel2.add(jPasswordFieldRePasswd, gridBagConstraints);

        jPanel3.setLayout(new java.awt.GridBagLayout());

        jButtonSave.setText(java.util.ResourceBundle.getBundle("com/hosv3/property/thai").getString("OK"));
        jButtonSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);
        jPanel3.add(jButtonSave, gridBagConstraints);

        jButtonCancel.setText(java.util.ResourceBundle.getBundle("com/hosv3/property/thai").getString("CANCEL"));
        jButtonCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCancelActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);
        jPanel3.add(jButtonCancel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jPanel2.add(jPanel3, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        getContentPane().add(jPanel2, gridBagConstraints);

        jPanel1.setLayout(new java.awt.GridBagLayout());

        jPanel1.setMaximumSize(new java.awt.Dimension(10, 10));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.ipady = 21;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        jPanel1.add(jLabelStatus, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.ipady = 9;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        getContentPane().add(jPanel1, gridBagConstraints);

    }
    // </editor-fold>//GEN-END:initComponents

    private void jButtonCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonCancelActionPerformed
        dispose();
    }    private void jPasswordFieldRePasswdKeyPressed(java.awt.event.KeyEvent evt) {//GEN-LAST:event_jButtonCancelActionPerformed
        // Add your handling code here://GEN-FIRST:event_jPasswordFieldRePasswdKeyPressed

            jLabelStatus.setText("");
            jLabelStatus.setBackground(Color.GRAY);
    }//GEN-LAST:event_jPasswordFieldRePasswdKeyPressed
    private void jButtonSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonSaveActionPerformed
        checkPassword();
    }//GEN-LAST:event_jButtonSaveActionPerformed
    private void jPasswordFieldRePasswdActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jPasswordFieldRePasswdActionPerformed
       checkPassword();
    }//GEN-LAST:event_jPasswordFieldRePasswdActionPerformed

    private void setEnableAll(boolean var)
    {   
        jTextFieldCode.setEditable(var);
    }
    
    public static boolean showDialog(HosControl hc, UpdateStatus us,Employee theEmployee2)
    {   
        DialogEditPasswd dlg = new DialogEditPasswd(hc,us,theEmployee2);
        String employeename = new String();
        Dimension screenSize =null;
        screenSize = Toolkit.getDefaultToolkit().getScreenSize();
        employeename = theEmployee2.fname + " " + theEmployee2.lname;
        dlg.setTitle("รหัสผ่าน " +  employeename);
        dlg.getEmployee(employeename);
        dlg.setSize(320,200);
        dlg.setLocation((screenSize.width-dlg.getSize().width)/2, screenSize.height/2);       
        dlg.setVisible(true);
        dlg.setLookup();
        dlg.setEnableAll(false);
        dlg.jPasswordFieldPasswd.requestFocusInWindow();
        if(actionCommand)
        {     
              return true;
        }
       return false;
    }
    private void checkPassword()
    {   
        String pass = String.valueOf(jPasswordFieldPasswd.getPassword());
        String passre = String.valueOf(jPasswordFieldRePasswd.getPassword());
        if(!pass.equals(passre))
        {  
            jLabelStatus.setText("รหัสผ่านทั้งสองครั้งไม่ถูกต้อง");
            jPanel1.setBackground(Color.YELLOW);
        }
        else
        {   
            jLabelStatus.setText("");
            jLabelStatus.setBackground(Color.GRAY);
            employee = CryptPassword.encryptText(passre.trim());
            theEmployee2.password=employee;
            theSetupControl.savePassword(theEmployee2);
            dispose();
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.hospital_os.gui.font.DefaultFont defaultFont1;
    private com.hospital_os.gui.font.FontFormatTitle fontFormatTitle1;
    private javax.swing.JButton jButtonCancel;
    private javax.swing.JButton jButtonSave;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabelStatus;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPasswordField jPasswordFieldPasswd;
    private javax.swing.JPasswordField jPasswordFieldRePasswd;
    private javax.swing.JTextField jTextFieldCode;
    // End of variables declaration//GEN-END:variables
    
    
}
