/*
 * DialogChooseICD10FromTemplate.java
 *
 * Created on 20 เมษายน 2549, 17:09 น.
 */

package com.hosv3.gui.panel.transaction;

import javax.swing.*;
import java.awt.*;
import com.hosv3.control.*;
import com.hosv3.utility.connection.*;
import com.hospital_os.object.*; 
import com.hosv3.utility.Constant;
/**
 *
 * @author  tong
 */
public class DialogChooseICD10FromTemplate extends javax.swing.JDialog  implements UpdateStatus{
    
    PanelDiagICD10 thePanelDiagICD10;
    MapVisitDx theMapVisitDx;
    java.awt.GridBagConstraints ThegridBagConstraints;
    ICD10 theICD10;
    Toolkit thekit ;
    Dimension screenSize;
    /** Creates new form DialogChooseICD10FromTemplate */
    public DialogChooseICD10FromTemplate(HosControl hc,GPatientSuit gps,GHospitalSuit ghs,UpdateStatus us) {
        
        super(us.getJFrame(), true);
        thekit = getToolkit();
        thePanelDiagICD10 = new PanelDiagICD10();
        thePanelDiagICD10.setControl(hc,gps,ghs, us);
        thePanelDiagICD10.setShowForMapDxTemplate(false);
        thePanelDiagICD10.setEnabled(true);
        initComponents();
        setGUIPanelDiagICD10();
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel1 = new javax.swing.JPanel();
        jPanelShowDxAndICD10 = new javax.swing.JPanel();
        jLabelDxAndICD10Name = new javax.swing.JLabel();
        jTextFieldShowDxAndICD10 = new javax.swing.JTextField();
        jPanelControl = new javax.swing.JPanel();
        jButtonSave = new javax.swing.JButton();
        jPanelCenter = new javax.swing.JPanel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        jPanel1.setLayout(new java.awt.GridBagLayout());

        jPanelShowDxAndICD10.setLayout(new java.awt.GridBagLayout());

        jLabelDxAndICD10Name.setText("Dx");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jPanelShowDxAndICD10.add(jLabelDxAndICD10Name, gridBagConstraints);

        jTextFieldShowDxAndICD10.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextFieldShowDxAndICD10ActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 0);
        jPanelShowDxAndICD10.add(jTextFieldShowDxAndICD10, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 2);
        jPanel1.add(jPanelShowDxAndICD10, gridBagConstraints);

        jPanelControl.setLayout(new java.awt.GridBagLayout());

        jButtonSave.setText("Save");
        jButtonSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.weightx = 1.0;
        jPanelControl.add(jButtonSave, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.SOUTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 2, 2);
        jPanel1.add(jPanelControl, gridBagConstraints);

        jPanelCenter.setLayout(new java.awt.BorderLayout());

        jPanelCenter.setBorder(new javax.swing.border.TitledBorder(""));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 2);
        jPanel1.add(jPanelCenter, gridBagConstraints);

        getContentPane().add(jPanel1, java.awt.BorderLayout.CENTER);

        pack();
    }
    // </editor-fold>//GEN-END:initComponents

    private void jTextFieldShowDxAndICD10ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jTextFieldShowDxAndICD10ActionPerformed
       // saveICD10();
    }//GEN-LAST:event_jTextFieldShowDxAndICD10ActionPerformed

    private void jButtonSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonSaveActionPerformed
        saveICD10();
    }//GEN-LAST:event_jButtonSaveActionPerformed
    
   
    public boolean confirmBox(String str, int status) {
         int i = JOptionPane.showConfirmDialog(this,str,"เตือน"
                ,JOptionPane.YES_NO_OPTION);
        return (i==JOptionPane.YES_OPTION);
    }

    public javax.swing.JFrame getJFrame() {
        return null;
    }

    public void setStatus(String str, int status) {
        str = Constant.getTextBundle(str);
        JOptionPane.showMessageDialog(this, str, "เตือน", JOptionPane.ERROR_MESSAGE); 
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButtonSave;
    private javax.swing.JLabel jLabelDxAndICD10Name;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanelCenter;
    private javax.swing.JPanel jPanelControl;
    private javax.swing.JPanel jPanelShowDxAndICD10;
    private javax.swing.JTextField jTextFieldShowDxAndICD10;
    // End of variables declaration//GEN-END:variables
    /**
     * ใช้ในการให้ค่ากับ Object หลังจากการกดปุ่มบันทึก
     * @author padungrat(tong)
     * @date 20/04/2549,16:11
     */
    public void saveICD10()
    {
        theICD10 = thePanelDiagICD10.getSelectICD10();
        if(theICD10 == null)
        {
            setStatus("กรุณาเลือกกลุ่มย่อยที่ต้องการ",1);
        }
        else
        {
         //   setStatus("รหัสที่เลือก เป็น "  + theICD10.description + "(" + theICD10.icd10_id +")",  1);
            theMapVisitDx.visit_diag_map_icd = theICD10.icd10_id; 
            // ใช้เคลียร์ค่าที่ส่งไปยัง PanelDiagICD10 sumo 26/7/2549
            thePanelDiagICD10.setClearKeySearchFromDialog();
            this.dispose();
        }
        theICD10 = null;
    }
    
    
    /**
     * ใช้ในการกำหนดให้ panel แสดงข้อมูลให้ถูกต้อง
     * @author padungrat(tong)
     * @date 20/04/2549,16:11
     */
    public void setGUIPanelDiagICD10()
    {
             
        jPanelCenter.add(thePanelDiagICD10.jPanelShowSearch);
        /*
        ThegridBagConstraints = new java.awt.GridBagConstraints();
        ThegridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        ThegridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;
        ThegridBagConstraints.weightx = 1.0;
        ThegridBagConstraints.weighty = 1.0;
        jPanelCenter.add(thePanelDiagICD10, ThegridBagConstraints);
         */
    }
            
    
    /**
     * ใช้ในการแสดง Dialog 
     * @param mapVisitDx เป็น Object ของ MapVisitDx ที่ต้องการให้ค่าหลังจากที่เลือก รหัสโรคบนตารางแล้ว
     * จะต้องไม่เป็น null เพราะจะต้อง set ค่าให้(call by value)
     * @author padungrat(tong)
     * @date 20/04/2549,16:11
     */
    public boolean showDialog(MapVisitDx mapVisitDx)
    {
        theMapVisitDx = mapVisitDx;
        
        updateOG();
        setSize(800, 350);
        setTitle(Constant.getTextBundle("ตัวช่วยลง ICD10 กับการ map DX"));
        setLanguage("");
        
        screenSize = Toolkit.getDefaultToolkit().getScreenSize();//thekit.getScreenSize();
        setLocation((screenSize.width-getSize().width)/2, (screenSize.height-getSize().height)/2);              
        setVisible(true);
   
        return true;
    }
    
    /**
     * ใช้ในการแสดงข้อมูลลงบน GUI
     * @author padungrat(tong)
     * @date 20/04/2549,16:11
     */
    public void updateOG()
    {
        jTextFieldShowDxAndICD10.setText(theMapVisitDx.visit_diag_map_dx);
        // เพิ่มตัวแปรที่ส่งไปให้ PanelDiagIcd10 เพื่อค้นหา Icd10 ที่ตรงกับที่ DxTemplate และแสดง Dx ให้ตาราง sumo 26/7/2549
        thePanelDiagICD10.setSearchICD10(theMapVisitDx.visit_diag_map_icd,theMapVisitDx.visit_diag_map_dx, true);
    }
    /**
     * ใช้ในการกำหนดภาษา
     * @author padungrat(tong)
     * @date 20/04/2549,16:11
     */
    public void setLanguage(String msg)
    {
        jButtonSave.setText(Constant.getTextBundle(jButtonSave.getText()));
    }
    
    
    
}
