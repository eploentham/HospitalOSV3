/*
 * PanelSetupICD9.java
 *
 * Created on 12 ตุลาคม 2546, 12:33 น.
 */
package com.hosv3.gui.panel.detail;

import com.hosv3.utility.Constant;
import java.util.Vector;
import com.hosv3.control.*;
import com.hosv3.utility.connection.*;
import com.hosv3.utility.GuiLang;
import com.hospital_os.usecase.connection.Persistent;
import com.hosv3.gui.component.PanelSetupImp;
import com.hospital_os.object.*;

/**
 *
 * @panel author : amp
 * @code update : amp
 */
public class PanelSDICD9 extends javax.swing.JPanel implements PanelSetupImp {

    UpdateStatus theUS;
    SetupControl theSetupControl;
    LookupControl theLookupControl;
    ICD9 theICD9 = new ICD9();
    Vector icd9 = new Vector();
    int offset = 24;
    int next = 0;
    int prev = 0;
    int saved = 0; // 0 คือ ไม่สามารถ insertได้ 1 คือ insert ได้
    String[] col = {"รหัส", "ชื่อหัตถการ"};

    public PanelSDICD9() {
        initComponents();
        setLanguage();
    }

    public PanelSDICD9(HosControl hc, UpdateStatus us) {
        initComponents();
        setLanguage();
        setControl(hc, us);
    }    /////////////////////Use this for decrease memory usage

    /**
     *@Author : amp
     *@date : 29/02/2549
     *@see : จัดการเกี่ยวกับภาษา    
     */
    public void setLanguage() {
        GuiLang.setLanguage(jLabel3);
        GuiLang.setLanguage(jLabel1);
        GuiLang.setLanguage(jLabel4);
        GuiLang.setLanguage(col);
    }

    public void setControl(HosControl hc, UpdateStatus us) {
        theUS = us;
        theSetupControl = hc.theSetupControl;
        theLookupControl = hc.theLookupControl;
        hc.theHS.theSetupSubject.addpanelrefrash(this);
        hc.theHS.theSetupSubject.addForLiftAttach(this);
    }
    /////////////////////Use this for decrease memory usage    

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        defaultFont1 = new com.hospital_os.gui.font.DefaultFont();
        fontFormatTitle1 = new com.hospital_os.gui.font.FontFormatTitle();
        jLabel1 = new javax.swing.JLabel();
        jTextFieldCode = new javax.swing.JTextField();
        jLabel3 = new javax.swing.JLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTextAreaDescription = new javax.swing.JTextArea();
        jLabel4 = new javax.swing.JLabel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTextAreaOtherDescription = new javax.swing.JTextArea();
        jLabel5 = new javax.swing.JLabel();
        jTextFieldCost = new javax.swing.JTextField();
        jLabel2 = new javax.swing.JLabel();
        jTextFieldICD10TM = new javax.swing.JTextField();

        setMinimumSize(new java.awt.Dimension(300, 400));
        setPreferredSize(new java.awt.Dimension(300, 400));
        setLayout(new java.awt.GridBagLayout());

        jLabel1.setFont(defaultFont1);
        jLabel1.setText("รหัส");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        add(jLabel1, gridBagConstraints);

        jTextFieldCode.setFont(defaultFont1);
        jTextFieldCode.setMinimumSize(new java.awt.Dimension(60, 29));
        jTextFieldCode.setPreferredSize(new java.awt.Dimension(60, 29));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 0, 5, 5);
        add(jTextFieldCode, gridBagConstraints);

        jLabel3.setFont(defaultFont1);
        jLabel3.setText("ชื่อหัตถการ");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        add(jLabel3, gridBagConstraints);

        jScrollPane2.setMaximumSize(new java.awt.Dimension(150, 48));
        jScrollPane2.setMinimumSize(new java.awt.Dimension(150, 48));
        jScrollPane2.setPreferredSize(new java.awt.Dimension(150, 45));

        jTextAreaDescription.setColumns(10);
        jTextAreaDescription.setFont(defaultFont1);
        jTextAreaDescription.setLineWrap(true);
        jTextAreaDescription.setRows(3);
        jTextAreaDescription.setWrapStyleWord(true);
        jScrollPane2.setViewportView(jTextAreaDescription);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        add(jScrollPane2, gridBagConstraints);

        jLabel4.setFont(defaultFont1);
        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("com/hosv3/property/thai"); // NOI18N
        jLabel4.setText(bundle.getString("ICD9_OTHERDESCRIPTION")); // NOI18N
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        add(jLabel4, gridBagConstraints);

        jScrollPane3.setMaximumSize(new java.awt.Dimension(150, 48));
        jScrollPane3.setMinimumSize(new java.awt.Dimension(150, 48));
        jScrollPane3.setPreferredSize(new java.awt.Dimension(150, 45));

        jTextAreaOtherDescription.setColumns(10);
        jTextAreaOtherDescription.setFont(defaultFont1);
        jTextAreaOtherDescription.setLineWrap(true);
        jTextAreaOtherDescription.setRows(3);
        jTextAreaOtherDescription.setWrapStyleWord(true);
        jScrollPane3.setViewportView(jTextAreaOtherDescription);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 7;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        add(jScrollPane3, gridBagConstraints);

        jLabel5.setFont(defaultFont1);
        jLabel5.setText("ต้นทุน");
        jLabel5.setToolTipText("รายงาน 18 แฟ้ม 53");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        add(jLabel5, gridBagConstraints);

        jTextFieldCost.setFont(defaultFont1);
        jTextFieldCost.setHorizontalAlignment(javax.swing.JTextField.TRAILING);
        jTextFieldCost.setMinimumSize(new java.awt.Dimension(60, 29));
        jTextFieldCost.setPreferredSize(new java.awt.Dimension(60, 29));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 0, 5, 5);
        add(jTextFieldCost, gridBagConstraints);

        jLabel2.setText("รหัส ICD_10_TM");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
        add(jLabel2, gridBagConstraints);

        jTextFieldICD10TM.setMinimumSize(new java.awt.Dimension(60, 29));
        jTextFieldICD10TM.setPreferredSize(new java.awt.Dimension(60, 29));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 0);
        add(jTextFieldICD10TM, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents

    public void clearAll() {
        this.theICD9 = new ICD9();
        jTextFieldCode.setText("");
        this.jTextFieldCost.setText("");
        jTextAreaDescription.setText("");
        jTextAreaOtherDescription.setText("");
        //konshow
        setEnabled(true);
    }

    public void setEnabled(boolean var) {
        jTextFieldCode.setEditable(var);
        jTextAreaDescription.setEditable(var);
        jTextAreaOtherDescription.setEditable(var);
    }

    public Persistent getXPer() {
        theICD9.icd9_id = jTextFieldCode.getText();
        theICD9.cost53 = jTextFieldCost.getText();
        theICD9.description = jTextAreaDescription.getText();
        theICD9.other_description = jTextAreaOtherDescription.getText();
        theICD9.icd_10_tm = jTextFieldICD10TM.getText();
        return theICD9;
    }

    public void setXPer(Persistent x) {
        theICD9 = (ICD9) x;
        jTextFieldCode.setText(theICD9.icd9_id);
        this.jTextFieldCost.setText(theICD9.cost53);
        jTextAreaDescription.setText(theICD9.description);
        jTextAreaOtherDescription.setText(theICD9.other_description);
        jTextFieldICD10TM.setText(theICD9.icd_10_tm);
        //konshow
        if (theICD9 != null && theICD9.getCode() != null && theICD9.getCode().substring(3, 8).equals(theLookupControl.readSite().off_id)) {
            setEnabled(true);
        } else {
            setEnabled(false);
        }
    }

    public void setupLookup() {
    }

/**
 * henbe comment 100253 kong ผิด pattern if return  และเขียนโค้ดซับซ้อนเข้าใจยาก ใช้บรรทัดยาวเกินไป
 * konshow edit for comment
 * @param x
 * @return
 */
    public boolean deleteXPer(Persistent x) {
        //konshow
        ICD9 delICD9 = (ICD9) x;
        if (delICD9 == null || delICD9.getCode() == null || !delICD9.getCode().substring(3, 8).equals(theLookupControl.readSite().off_id)) {
            theUS.setStatus("ICD9 ตัวนี้ไม่อนุญาติให้ทำการลบได้", theUS.WARNING);
            return false;
        } 
        boolean confirm = theUS.confirmBox(Constant.getTextBundle("ยืนยันที่จะลบรายการนี้") + " " +
                Constant.getTextBundle("อาจเกิดผลกระทบกับข้อมูลในฐานข้อมูลได้"), UpdateStatus.WARNING);
        if (!confirm) {
            return false;
        }
        return (theSetupControl.deleteICD9(delICD9) > 0);
    }

    public boolean saveXPer(Persistent x) {
        return theSetupControl.saveICD9((ICD9) x) > 0;
    }

    public Vector listXPer(String key, String active, int offset) {
        return theSetupControl.listICD9All(key);
    }

    public boolean isActiveVisible() {
        return false;
    }
    public static String TITLE = Constant.getTextBundle("PANEL_SETUP_ICD9");

    public String getTitle() {
        return TITLE;
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.hospital_os.gui.font.DefaultFont defaultFont1;
    private com.hospital_os.gui.font.FontFormatTitle fontFormatTitle1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel3;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private javax.swing.JTextArea jTextAreaDescription;
    private javax.swing.JTextArea jTextAreaOtherDescription;
    private javax.swing.JTextField jTextFieldCode;
    private javax.swing.JTextField jTextFieldCost;
    private javax.swing.JTextField jTextFieldICD10TM;
    // End of variables declaration//GEN-END:variables
}
