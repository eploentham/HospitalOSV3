/*
 * PanelSDSetupDrugDoseShortcut.java
 *
 * Created on April 1, 2009, 9:20 AM
 */

package com.hosv3.gui.panel.detail;

import com.hospital_os.object.DrugDoseShortcut;
import com.hospital_os.object.DrugFrequency;
import com.hospital_os.object.DrugInstruction;
import com.hospital_os.usecase.connection.Persistent;
import com.hospital_os.utility.ComboboxModel;
import com.hosv3.utility.Constant;
import com.hospital_os.utility.Gutil;
import com.hosv3.control.HosControl;
import com.hosv3.control.LookupControl;
import com.hosv3.control.SetupControl;
import com.hosv3.control.lookup.DrugFrequencyLookup;
import com.hosv3.control.lookup.DrugInstructionLookup;
import com.hosv3.gui.component.PanelSetupImp;
import com.hosv3.object.DrugFrequency2;
import com.hosv3.object.DrugInstruction2;
import com.hosv3.subject.HosSubject;
import com.hosv3.subject.SetupSubject;
import com.hosv3.utility.GuiLang;
import com.hosv3.utility.connection.UpdateStatus;
import java.awt.event.KeyEvent;
import java.util.Vector;

/**
 *
 * @author  Administrator
 */
public class PanelSDDrugDoseShortcut extends javax.swing.JPanel implements PanelSetupImp{
    UpdateStatus theUS;
    HosSubject  theHS;
    SetupControl theSetupControl;
    SetupSubject theSetupSubject;
    ComboboxModel theComboboxModel;
    private DrugDoseShortcut theDrugDoseShortcut = new DrugDoseShortcut();
    DrugInstruction theDrugInstruction = new DrugInstruction();
    DrugFrequency theDrugFrequency = new DrugFrequency();
    LookupControl theLookupControl;
    // Vector billinggroup = new Vector();
    Vector vdrugdose = new Vector();
    Vector vinstr = new Vector();
    Vector vfreq = new Vector();
    int offset = 23;
    int next = 0;
    int prev = 0;
    int saved = 0; // 0 คือ ไม่สามารถ insertได้ 1 คือ insert ได้
    int category = 0;
    /** pu : 04/08/2549 : เก็บ Index ของ Item ตัวล่างสุดของหน้าปัจจุบัน*/
    int curNext = 0;
    /** pu : 04/08/2549 : เก็บ Index ของ Item ตัวล่างสุดของหน้าก่อนหน้าปัจจุบัน*/
    int curPrev = 0;
    String[] col = {"ลำดับ","รายละเอียด"};
    /** Creates new form PanelSDSetupDrugDoseShortcut */
    public PanelSDDrugDoseShortcut() {
        initComponents();
        setLanguage();
    }
    public PanelSDDrugDoseShortcut(HosControl hc,UpdateStatus us)
    {
        initComponents();
        setLanguage();
        setControl(hc,us);
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        defaultFont1 = new com.hospital_os.gui.font.DefaultFont();
        jPanel1 = new javax.swing.JPanel();
        jLabelCode = new javax.swing.JLabel();
        jTextFieldCode = new javax.swing.JTextField();
        jLabelDrugDoseShortcut = new javax.swing.JLabel();
        jTextFieldDrugDoseShortcut = new javax.swing.JTextField();
        jLabelDrugInstruction = new javax.swing.JLabel();
        jLabelDrugFrequency = new javax.swing.JLabel();
        jLabelQtyUnit = new javax.swing.JLabel();
        jTextFieldQtyUnit = new javax.swing.JTextField();
        jCheckBoxActive = new javax.swing.JCheckBox();
        jComboBoxDrugInstruction = new com.hosv3.gui.component.HosComboBox();
        jComboBoxDrugFrequency = new com.hosv3.gui.component.HosComboBox();

        setLayout(new java.awt.GridBagLayout());

        jPanel1.setMinimumSize(new java.awt.Dimension(300, 170));
        jPanel1.setPreferredSize(new java.awt.Dimension(300, 170));
        jPanel1.setLayout(new java.awt.GridBagLayout());

        jLabelCode.setFont(defaultFont1);
        jLabelCode.setText("ชื่อ Dose ย่อ");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 3, 5);
        jPanel1.add(jLabelCode, gridBagConstraints);

        jTextFieldCode.setFont(defaultFont1);
        jTextFieldCode.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jTextFieldCodeKeyReleased(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 0, 3, 5);
        jPanel1.add(jTextFieldCode, gridBagConstraints);

        jLabelDrugDoseShortcut.setFont(defaultFont1);
        jLabelDrugDoseShortcut.setText("คำค้น");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 3, 5);
        jPanel1.add(jLabelDrugDoseShortcut, gridBagConstraints);

        jTextFieldDrugDoseShortcut.setFont(defaultFont1);
        jTextFieldDrugDoseShortcut.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jTextFieldDrugDoseShortcutKeyReleased(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 3, 5);
        jPanel1.add(jTextFieldDrugDoseShortcut, gridBagConstraints);

        jLabelDrugInstruction.setFont(defaultFont1);
        jLabelDrugInstruction.setText("วิธีการใช้ยา");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 3, 5);
        jPanel1.add(jLabelDrugInstruction, gridBagConstraints);

        jLabelDrugFrequency.setFont(defaultFont1);
        jLabelDrugFrequency.setText("ความถี่ในการใช้ยา");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 3, 5);
        jPanel1.add(jLabelDrugFrequency, gridBagConstraints);

        jLabelQtyUnit.setFont(defaultFont1);
        jLabelQtyUnit.setText("จำนวนที่ใช้");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 3, 5);
        jPanel1.add(jLabelQtyUnit, gridBagConstraints);

        jTextFieldQtyUnit.setFont(defaultFont1);
        jTextFieldQtyUnit.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jTextFieldQtyUnitKeyReleased(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 3, 5);
        jPanel1.add(jTextFieldQtyUnit, gridBagConstraints);

        jCheckBoxActive.setFont(defaultFont1);
        jCheckBoxActive.setText("Active");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 3, 5);
        jPanel1.add(jCheckBoxActive, gridBagConstraints);

        jComboBoxDrugInstruction.setFont(defaultFont1);
        jComboBoxDrugInstruction.setPreferredSize(new java.awt.Dimension(120, 24));
        jComboBoxDrugInstruction.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jComboBoxDrugInstructionKeyReleased(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 3, 5);
        jPanel1.add(jComboBoxDrugInstruction, gridBagConstraints);

        jComboBoxDrugFrequency.setFont(defaultFont1);
        jComboBoxDrugFrequency.setPreferredSize(new java.awt.Dimension(120, 24));
        jComboBoxDrugFrequency.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyReleased(java.awt.event.KeyEvent evt) {
                jComboBoxDrugFrequencyKeyReleased(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 3, 5);
        jPanel1.add(jComboBoxDrugFrequency, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        add(jPanel1, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents

    private void jTextFieldCodeKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextFieldCodeKeyReleased
        if(evt.getKeyCode() == KeyEvent.VK_ENTER)
            jTextFieldDrugDoseShortcut.requestFocus();
    }//GEN-LAST:event_jTextFieldCodeKeyReleased

    private void jTextFieldDrugDoseShortcutKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextFieldDrugDoseShortcutKeyReleased
        if(evt.getKeyCode() == KeyEvent.VK_ENTER)
            jComboBoxDrugInstruction.requestFocus();
    }//GEN-LAST:event_jTextFieldDrugDoseShortcutKeyReleased

    private void jTextFieldQtyUnitKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jTextFieldQtyUnitKeyReleased
        //if(evt.getKeyCode() == KeyEvent.VK_ENTER)
            //jButtonSaveActionPerformed(null);
    }//GEN-LAST:event_jTextFieldQtyUnitKeyReleased

    private void jComboBoxDrugInstructionKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBoxDrugInstructionKeyReleased
        if(evt.getKeyCode() == KeyEvent.VK_ENTER)
            jComboBoxDrugFrequency.requestFocus();
    }//GEN-LAST:event_jComboBoxDrugInstructionKeyReleased

    private void jComboBoxDrugFrequencyKeyReleased(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jComboBoxDrugFrequencyKeyReleased
        if(evt.getKeyCode() == KeyEvent.VK_ENTER)
            jTextFieldQtyUnit.requestFocus();
    }//GEN-LAST:event_jComboBoxDrugFrequencyKeyReleased
    
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.hospital_os.gui.font.DefaultFont defaultFont1;
    private javax.swing.JCheckBox jCheckBoxActive;
    private com.hosv3.gui.component.HosComboBox jComboBoxDrugFrequency;
    private com.hosv3.gui.component.HosComboBox jComboBoxDrugInstruction;
    private javax.swing.JLabel jLabelCode;
    private javax.swing.JLabel jLabelDrugDoseShortcut;
    private javax.swing.JLabel jLabelDrugFrequency;
    private javax.swing.JLabel jLabelDrugInstruction;
    private javax.swing.JLabel jLabelQtyUnit;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JTextField jTextFieldCode;
    private javax.swing.JTextField jTextFieldDrugDoseShortcut;
    private javax.swing.JTextField jTextFieldQtyUnit;
    // End of variables declaration//GEN-END:variables

    public void clearAll() {
        this.setTheDrugDoseShortcut(new DrugDoseShortcut());
    }

    public Persistent getXPer() {
        return this.getTheDrugDoseShortcut();
    }

    public void setXPer(Persistent x) {
        this.setTheDrugDoseShortcut((DrugDoseShortcut)x);
    }

    public void setLanguage() {
        GuiLang.setLanguage(col);
        //GuiLang.setLanguage(jLabel5);
        GuiLang.setLanguage(jLabelCode);
        GuiLang.setLanguage(jLabelDrugDoseShortcut);
        GuiLang.setLanguage(jLabelDrugFrequency);
        GuiLang.setLanguage(jLabelDrugInstruction);
        //GuiLang.setLanguage(jLabelICD9code);
        GuiLang.setLanguage(jLabelQtyUnit);
        //GuiLang.setLanguage(jButtonSearch);
       // GuiLang.setLanguage(jButtonSave);
    }

    public void setControl(HosControl hc, UpdateStatus us) {
         theUS = us;
        theHS = hc.theHS;
        //jTable1.setGuiMode(true);
        theSetupControl = hc.theSetupControl;
        theLookupControl = hc.theLookupControl;
        theSetupSubject = hc.theHS.theSetupSubject;
        hc.theHS.theSetupSubject.addpanelrefrash(this);
        hc.theHS.theSetupSubject.addForLiftAttach(this);    
        setupLookup();
        setEnabled(false);
    }
    
    public void setEnabled(boolean var)
    {
        jTextFieldCode.setEnabled(var);
        //jTextFieldDrugDoseShortcut.setEnabled(var);
        //jComboBoxDrugInstruction.setEnabled(var);
        //jComboBoxDrugFrequency.setEnabled(var);
        //jTextFieldQtyUnit.setEnabled(var);
        //jButtonSave.setEnabled(var);
        //jButtonDel.setEnabled(var);
    }

    public void setupLookup() {
        jComboBoxDrugFrequency.setControl(null,new DrugFrequencyLookup(theLookupControl), new DrugFrequency2()); 
        jComboBoxDrugInstruction.setControl(null,new DrugInstructionLookup(theLookupControl), new DrugInstruction2()); 
    }

    public boolean deleteXPer(Persistent x) {
        return (this.theSetupControl.deleteDrugDoseShortcutByPk((DrugDoseShortcut)x)>0);
    }

    public boolean saveXPer(Persistent x) {
        return this.theSetupControl.saveDrugDoseShortcut((DrugDoseShortcut)x)>0;
    }

    public Vector listXPer(String key, String active, int offset) {
        return theSetupControl.listDrugDoseShortcutAll(key,active);
    }

    public boolean isActiveVisible() {
        return true;
    }

    public static String TITLE = Constant.getTextBundle("รายการ Dose ย่อ");
    public String getTitle() {
       return TITLE;
    }

    public DrugDoseShortcut getTheDrugDoseShortcut() {
        theDrugDoseShortcut.code = Gutil.CheckReservedWords(jTextFieldCode.getText());
        theDrugDoseShortcut.description  = Gutil.CheckReservedWords(jTextFieldDrugDoseShortcut.getText());
        theDrugDoseShortcut.drug_instruction_id = ComboboxModel.getCodeComboBox(jComboBoxDrugInstruction);
        theDrugDoseShortcut.drug_frequency_id  = ComboboxModel.getCodeComboBox(jComboBoxDrugFrequency);
        theDrugDoseShortcut.qty = Gutil.CheckReservedWords(jTextFieldQtyUnit.getText());
        if(jCheckBoxActive.isSelected())
            theDrugDoseShortcut.active = "1";
        else    theDrugDoseShortcut.active = "0";
        
        return theDrugDoseShortcut;
    }

    public void setTheDrugDoseShortcut(DrugDoseShortcut item) {
        theDrugDoseShortcut = item;       
        jTextFieldCode.setText(theDrugDoseShortcut.code);
        jTextFieldDrugDoseShortcut.setText(theDrugDoseShortcut.description);
        Gutil.setGuiData(jComboBoxDrugInstruction,theDrugDoseShortcut.drug_instruction_id);
        Gutil.setGuiData(jComboBoxDrugFrequency,theDrugDoseShortcut.drug_frequency_id);
        jTextFieldQtyUnit.setText(theDrugDoseShortcut.qty);
        if((theDrugDoseShortcut.active)!=null&&theDrugDoseShortcut.active.equals("1"))
            jCheckBoxActive.setSelected(true);
        else    jCheckBoxActive.setSelected(false);
    }
    
    public boolean isStartVisible() {
        return false;
    }
        
  
}
