/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * PanelSetupEmail.java
 *
 * Created on 23 มี.ค. 2553, 10:20:48
 */

package com.hosv3.gui.panel.setup;

import com.hospital_os.object.Authentication;
import com.hospital_os.object.AutoReportBug;
import com.hosv3.control.HosControl;
import com.hosv3.control.LookupControl;
import com.hosv3.control.SetupControl;
import com.hosv3.utility.GuiLang;
import com.hosv3.utility.connection.UpdateStatus;

/**
 *
 * @author LionHearth
 */
public class PanelSetupEmail extends javax.swing.JPanel {
    private HosControl theHC;
    private SetupControl theSetupControl;
    AutoReportBug theAutoReportBug;
    private LookupControl theLookupControl;
    /** Creates new form PanelSetupEmail */
    public PanelSetupEmail() {
        initComponents();
    }
    public void setLanguage()
    {
        GuiLang.setLanguage(jLabelSmtpServer);
        GuiLang.setLanguage(jLabelUser);
        GuiLang.setLanguage(jLabelPassword);
        GuiLang.setLanguage(jLabelMailFrom);
        GuiLang.setLanguage(jLabelMailTo);
        GuiLang.setLanguage(jButtonTest);
        GuiLang.setLanguage(jButtonRefresh);
        GuiLang.setLanguage(jButtonSave);
        GuiLang.setLanguage(jLabelTitle);
        GuiLang.setLanguage(jPanel1);
    }
    public void setControl(HosControl hc, UpdateStatus us) {
        theHC = hc;
        theSetupControl = hc.theSetupControl;
        theLookupControl = hc.theLookupControl;
        setAutoReportBug(theLookupControl.readAutoReportBug());
        String auth = theHC.theHO.theEmployee.authentication_id;
        boolean is_admin = auth.equals(Authentication.ADMIN);
        if(is_admin || theHC.theHO.theGActionAuthV.isWriteTreeOtherMail())
            jButtonSave.setVisible(true);
        else
            jButtonSave.setVisible(false);
        setLanguage();
    }
    public void setAutoReportBug(AutoReportBug autoReportBug)
    {
        theAutoReportBug = autoReportBug;
        if(theAutoReportBug==null)
            theAutoReportBug = new AutoReportBug();
        jTextFieldMailFrom.setText(theAutoReportBug.mail_from);
        jTextFieldMailTo.setText(theAutoReportBug.mail_to);
        jTextFieldPassword.setText(theAutoReportBug.password);
        jTextFieldSMTPServer.setText(theAutoReportBug.smtp_host);
        jTextFieldUserName.setText(theAutoReportBug.user_name);
    }
    public void getAutoReportBug()
    {
        if(theAutoReportBug == null)
            theAutoReportBug = new AutoReportBug();
        theAutoReportBug.smtp_host = jTextFieldSMTPServer.getText();
        theAutoReportBug.user_name = jTextFieldUserName.getText();
        theAutoReportBug.password = jTextFieldPassword.getText();
        theAutoReportBug.mail_from = jTextFieldMailFrom.getText();
        theAutoReportBug.mail_to = jTextFieldMailTo.getText();
    }
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        fontFormatTitle1 = new com.hospital_os.gui.font.FontFormatTitle();
        defaultFont1 = new com.hospital_os.gui.font.DefaultFont();
        jLabelTitle = new javax.swing.JLabel();
        jPanel1 = new javax.swing.JPanel();
        jLabelSmtpServer = new javax.swing.JLabel();
        jLabelUser = new javax.swing.JLabel();
        jLabelMailTo = new javax.swing.JLabel();
        jTextFieldSMTPServer = new javax.swing.JTextField();
        jTextFieldUserName = new javax.swing.JTextField();
        jTextFieldMailTo = new javax.swing.JTextField();
        jLabelPassword = new javax.swing.JLabel();
        jLabelMailFrom = new javax.swing.JLabel();
        jTextFieldMailFrom = new javax.swing.JTextField();
        jPanel2 = new javax.swing.JPanel();
        jButtonSave = new javax.swing.JButton();
        jButtonRefresh = new javax.swing.JButton();
        jButtonTest = new javax.swing.JButton();
        jTextFieldPassword = new javax.swing.JPasswordField();

        setLayout(new java.awt.GridBagLayout());

        jLabelTitle.setFont(fontFormatTitle1);
        java.util.ResourceBundle bundle = java.util.ResourceBundle.getBundle("com/hosv3/property/thai"); // NOI18N
        jLabelTitle.setText(bundle.getString("LIST_OPTION")); // NOI18N
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        add(jLabelTitle, gridBagConstraints);

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Setup ระบบแจ้งบักอัตโนมัติ", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, defaultFont1));
        jPanel1.setLayout(new java.awt.GridBagLayout());

        jLabelSmtpServer.setFont(defaultFont1);
        jLabelSmtpServer.setText("SMTP Server");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel1.add(jLabelSmtpServer, gridBagConstraints);

        jLabelUser.setFont(defaultFont1);
        jLabelUser.setText("ชื่อผู้ใช้");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel1.add(jLabelUser, gridBagConstraints);

        jLabelMailTo.setFont(defaultFont1);
        jLabelMailTo.setText("ส่งเมลไปยัง");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel1.add(jLabelMailTo, gridBagConstraints);

        jTextFieldSMTPServer.setMinimumSize(new java.awt.Dimension(250, 22));
        jTextFieldSMTPServer.setPreferredSize(new java.awt.Dimension(250, 22));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 5);
        jPanel1.add(jTextFieldSMTPServer, gridBagConstraints);

        jTextFieldUserName.setMinimumSize(new java.awt.Dimension(250, 22));
        jTextFieldUserName.setPreferredSize(new java.awt.Dimension(250, 22));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 5);
        jPanel1.add(jTextFieldUserName, gridBagConstraints);

        jTextFieldMailTo.setMinimumSize(new java.awt.Dimension(300, 22));
        jTextFieldMailTo.setPreferredSize(new java.awt.Dimension(300, 22));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 5);
        jPanel1.add(jTextFieldMailTo, gridBagConstraints);

        jLabelPassword.setFont(defaultFont1);
        jLabelPassword.setText("รหัสผ่าน");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel1.add(jLabelPassword, gridBagConstraints);

        jLabelMailFrom.setFont(defaultFont1);
        jLabelMailFrom.setText("ส่งเมลจาก");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel1.add(jLabelMailFrom, gridBagConstraints);

        jTextFieldMailFrom.setMinimumSize(new java.awt.Dimension(300, 22));
        jTextFieldMailFrom.setPreferredSize(new java.awt.Dimension(300, 22));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 5);
        jPanel1.add(jTextFieldMailFrom, gridBagConstraints);

        jPanel2.setLayout(new java.awt.GridBagLayout());

        jButtonSave.setFont(defaultFont1);
        jButtonSave.setText("บันทึก");
        jButtonSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.ipadx = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.insets = new java.awt.Insets(5, 0, 0, 0);
        jPanel2.add(jButtonSave, gridBagConstraints);

        jButtonRefresh.setFont(defaultFont1);
        jButtonRefresh.setText("รีเพรช");
        jButtonRefresh.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonRefreshActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 0, 0, 0);
        jPanel2.add(jButtonRefresh, gridBagConstraints);

        jButtonTest.setText("Test");
        jButtonTest.setMargin(new java.awt.Insets(2, 2, 2, 2));
        jButtonTest.setMaximumSize(new java.awt.Dimension(73, 25));
        jButtonTest.setMinimumSize(new java.awt.Dimension(73, 25));
        jButtonTest.setPreferredSize(new java.awt.Dimension(73, 25));
        jButtonTest.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonTestActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.insets = new java.awt.Insets(5, 0, 0, 0);
        jPanel2.add(jButtonTest, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        jPanel1.add(jPanel2, gridBagConstraints);

        jTextFieldPassword.setText("jPasswordField1");
        jTextFieldPassword.setMinimumSize(new java.awt.Dimension(250, 22));
        jTextFieldPassword.setPreferredSize(new java.awt.Dimension(250, 22));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 5);
        jPanel1.add(jTextFieldPassword, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weighty = 1.0;
        add(jPanel1, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents

    private void jButtonSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonSaveActionPerformed
        this.getAutoReportBug();
        int res = this.theSetupControl.saveAutoReportBug(theAutoReportBug);
        if(res == 3)
        {
            jTextFieldSMTPServer.requestFocus();
        }
        else if(res == 4)
        {
            jTextFieldUserName.requestFocus();
        }
        else if(res == 5)
        {
            jTextFieldPassword.requestFocus();
        }
        else if(res == 6)
        {
            jTextFieldMailFrom.requestFocus();
        }
        else if(res == 7)
        {
            jTextFieldMailTo.requestFocus();
        }
    }//GEN-LAST:event_jButtonSaveActionPerformed

    private void jButtonRefreshActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonRefreshActionPerformed

        theHC.theLookupControl.readAutoReportBug();
        setAutoReportBug(theLookupControl.readAutoReportBug());

    }//GEN-LAST:event_jButtonRefreshActionPerformed

    private void jButtonTestActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonTestActionPerformed
        theSetupControl.testAutoReportBug();
    }//GEN-LAST:event_jButtonTestActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.hospital_os.gui.font.DefaultFont defaultFont1;
    private com.hospital_os.gui.font.FontFormatTitle fontFormatTitle1;
    private javax.swing.JButton jButtonRefresh;
    private javax.swing.JButton jButtonSave;
    private javax.swing.JButton jButtonTest;
    private javax.swing.JLabel jLabelMailFrom;
    private javax.swing.JLabel jLabelMailTo;
    private javax.swing.JLabel jLabelPassword;
    private javax.swing.JLabel jLabelSmtpServer;
    private javax.swing.JLabel jLabelTitle;
    private javax.swing.JLabel jLabelUser;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JTextField jTextFieldMailFrom;
    private javax.swing.JTextField jTextFieldMailTo;
    private javax.swing.JPasswordField jTextFieldPassword;
    private javax.swing.JTextField jTextFieldSMTPServer;
    private javax.swing.JTextField jTextFieldUserName;
    // End of variables declaration//GEN-END:variables

    

}
