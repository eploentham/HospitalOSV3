/* * PanelReportBudget.java * * Created on 25 ??????? 2545, 9:18 ?. */package com.hosv3.gui.panel.setup;import java.util.Vector;import javax.swing.*;import com.hosv3.usecase.setup.*;import com.hosv3.control.*;import com.hosv3.utility.connection.*;import com.hosv3.utility.GuiLang;import com.hospital_os.utility.*;import com.hospital_os.object.*;/** * * @author  henbe */public class PanelReportSQLParam extends javax.swing.JPanel implements ManageOptionReq,ManageSQLTemplateParamReq{    /** Creates new form PanelReportBudget */    UpdateStatus theUS;    SetupControl theSetupControl;    LookupControl theLookupControl;    //JFrame frame;    JFileChooser file=new JFileChooser();    Vector vSQLTemplateParam = new Vector();    SQLTemplateParam theSQLTemplateParam;    //?????? Load ???????? ???????????????? query ??????????    boolean select = false;        public PanelReportSQLParam(HosControl hc,UpdateStatus us) {        initComponents();        setLanguage();        setControl(hc,us);		jTable1.setGuiMode(true);    }    public PanelReportSQLParam() {        initComponents();        setLanguage();    }    public void setControl(HosControl hc,UpdateStatus us){		theUS = us;        theSetupControl  = hc.theSetupControl;        theLookupControl = hc.theLookupControl;        hc.theHS.theSetupSubject.addpanelrefrash(this);        //hc.theHS.theSetupSubject.addquerySQLAttach(this);        hc.theHS.theSetupSubject.addForLiftAttach(this);        hc.theHS.theSetupSubject.addquerySQLParamAttach(this);        ExampleFileFilter ff=new ExampleFileFilter();     	ff.addExtension("csv");    	ff.setDescription("Comma Separate Version");        file.addChoosableFileFilter(ff);        setupLookup();    }    public void setupLookup()     {         select = false;         vSQLTemplateParam = theLookupControl.listSQLTemplateParam();        ComboboxModel.initComboBox(jComboBoxBoxSQLTemplateParam,  vSQLTemplateParam);     }    /**     *@Author : amp     *@date : 29/02/2549     *@see : ???????????????????         */    private void setLanguage()    {        GuiLang.setLanguage(jLabel4);        GuiLang.setLanguage(jLabel2);        GuiLang.setLanguage(jLabel3);          GuiLang.setLanguage(jLabelStatus);    }        /** This method is called from within the constructor to     * initialize the form.     * WARNING: Do NOT modify this code. The content of this method is     * always regenerated by the Form Editor.     */    private void initComponents() {//GEN-BEGIN:initComponents        java.awt.GridBagConstraints gridBagConstraints;        fontFormatTitle1 = new com.hospital_os.gui.font.FontFormatTitle();        jScrollPane1 = new javax.swing.JScrollPane();        jTable1 = new com.hosv3.gui.component.HJTableSort();        jPanel2 = new javax.swing.JPanel();        jPanel1 = new javax.swing.JPanel();        jButton2 = new javax.swing.JButton();        jComboBoxBoxSQLTemplateParam = new javax.swing.JComboBox();        jPanel4 = new javax.swing.JPanel();        jLabel2 = new javax.swing.JLabel();        dateComboBox1 = new com.hospital_os.utility.DateComboBox();        jLabel3 = new javax.swing.JLabel();        dateComboBox2 = new com.hospital_os.utility.DateComboBox();        jButtonRefresh = new javax.swing.JButton();        jLabelStatus = new javax.swing.JLabel();        jScrollPane2 = new javax.swing.JScrollPane();        jTextField1 = new javax.swing.JTextArea();        jPanel3 = new javax.swing.JPanel();        jLabel4 = new javax.swing.JLabel();        setLayout(new java.awt.GridBagLayout());        setPreferredSize(new java.awt.Dimension(273, 301));        jScrollPane1.setViewportView(jTable1);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 4;        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;        gridBagConstraints.weightx = 1.0;        gridBagConstraints.weighty = 1.0;        gridBagConstraints.insets = new java.awt.Insets(2, 0, 0, 0);        add(jScrollPane1, gridBagConstraints);        jPanel2.setLayout(new java.awt.GridBagLayout());        jPanel2.setMinimumSize(new java.awt.Dimension(55, 120));        jPanel2.setPreferredSize(new java.awt.Dimension(55, 120));        jPanel1.setLayout(new java.awt.GridBagLayout());        jButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/hospital_os/images/Save16.gif")));        jButton2.setMargin(new java.awt.Insets(5, 5, 5, 5));        jButton2.setMaximumSize(new java.awt.Dimension(25, 25));        jButton2.setMinimumSize(new java.awt.Dimension(26, 26));        jButton2.setPreferredSize(new java.awt.Dimension(26, 26));        jButton2.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                jButton2ActionPerformed(evt);            }        });        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 1;        gridBagConstraints.gridy = 0;        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;        gridBagConstraints.insets = new java.awt.Insets(0, 10, 0, 0);        jPanel1.add(jButton2, gridBagConstraints);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 1;        gridBagConstraints.gridy = 2;        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 1);        jPanel2.add(jPanel1, gridBagConstraints);        jComboBoxBoxSQLTemplateParam.setMinimumSize(new java.awt.Dimension(93, 24));        jComboBoxBoxSQLTemplateParam.setPreferredSize(new java.awt.Dimension(93, 24));        jComboBoxBoxSQLTemplateParam.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                jComboBoxBoxSQLTemplateParamActionPerformed(evt);            }        });        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 0;        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 1);        jPanel2.add(jComboBoxBoxSQLTemplateParam, gridBagConstraints);        jPanel4.setLayout(new java.awt.GridBagLayout());        jLabel2.setText("\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48");        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 5);        jPanel4.add(jLabel2, gridBagConstraints);        dateComboBox1.setEditable(true);        dateComboBox1.setMinimumSize(new java.awt.Dimension(93, 24));        dateComboBox1.setPreferredSize(new java.awt.Dimension(93, 24));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 5);        jPanel4.add(dateComboBox1, gridBagConstraints);        jLabel3.setText("\u0e16\u0e36\u0e07\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48");        jLabel3.setToolTipText("");        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 5);        jPanel4.add(jLabel3, gridBagConstraints);        dateComboBox2.setEditable(true);        dateComboBox2.setMinimumSize(new java.awt.Dimension(93, 24));        dateComboBox2.setPreferredSize(new java.awt.Dimension(93, 24));        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 5);        jPanel4.add(dateComboBox2, gridBagConstraints);        jButtonRefresh.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/hospital_os/images/Refresh16.gif")));        jButtonRefresh.setMargin(new java.awt.Insets(5, 5, 5, 5));        jButtonRefresh.setMaximumSize(new java.awt.Dimension(24, 24));        jButtonRefresh.setMinimumSize(new java.awt.Dimension(26, 26));        jButtonRefresh.setPreferredSize(new java.awt.Dimension(26, 26));        jButtonRefresh.addActionListener(new java.awt.event.ActionListener() {            public void actionPerformed(java.awt.event.ActionEvent evt) {                jButtonRefreshActionPerformed(evt);            }        });        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 5);        jPanel4.add(jButtonRefresh, gridBagConstraints);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 2;        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;        gridBagConstraints.weightx = 1.0;        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 1);        jPanel2.add(jPanel4, gridBagConstraints);        jLabelStatus.setFont(new java.awt.Font("MS Sans Serif", 1, 11));        jLabelStatus.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);        jLabelStatus.setText("Status");        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 3;        gridBagConstraints.gridwidth = 2;        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;        gridBagConstraints.weightx = 1.0;        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 1);        jPanel2.add(jLabelStatus, gridBagConstraints);        jScrollPane2.setMinimumSize(new java.awt.Dimension(22, 75));        jScrollPane2.setPreferredSize(new java.awt.Dimension(22, 75));        jTextField1.setLineWrap(true);        jScrollPane2.setViewportView(jTextField1);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 1;        gridBagConstraints.gridwidth = 2;        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;        gridBagConstraints.weightx = 1.0;        gridBagConstraints.weighty = 1.0;        gridBagConstraints.insets = new java.awt.Insets(1, 1, 1, 1);        jPanel2.add(jScrollPane2, gridBagConstraints);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.gridx = 0;        gridBagConstraints.gridy = 1;        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHEAST;        gridBagConstraints.insets = new java.awt.Insets(3, 0, 0, 3);        add(jPanel2, gridBagConstraints);        jLabel4.setFont(fontFormatTitle1);        jLabel4.setText("SQL \u0e08\u0e32\u0e01\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48");        jPanel3.add(jLabel4);        gridBagConstraints = new java.awt.GridBagConstraints();        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;        add(jPanel3, gridBagConstraints);    }//GEN-END:initComponents    private void jComboBoxBoxSQLTemplateParamActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBoxBoxSQLTemplateParamActionPerformed//        int row = jComboBoxBoxSQLTemplateParam.getSelectedIndex();//        if(row != -1){ //            ComboFix p = (ComboFix)vSQLTemplateParam.get(row);//            theSQLTemplateParam = theSetupControl.readSQLTemplateParamByID(p.code);//            jTextField1.setText(theSQLTemplateParam.sql);//            querySQL();//        }    }//GEN-LAST:event_jComboBoxBoxSQLTemplateParamActionPerformed    private void jButtonRefreshActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonRefreshActionPerformed        querySQL();    }//GEN-LAST:event_jButtonRefreshActionPerformed    private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed        if(file.showSaveDialog(theUS.getJFrame())==JFileChooser.APPROVE_OPTION)        {            String filename = file.getSelectedFile().getAbsoluteFile().toString();             int i = filename.indexOf(".");             if(i == -1)                 filename = filename + ".txt";            IOStream.writeOutputDefault(Gutil.SaveToExcel(jTable1),filename);        }    }//GEN-LAST:event_jButton2ActionPerformed   public void querySQL()    {        String startdate = dateComboBox1.getText();        String enddate = dateComboBox2.getText();        if(!jTextField1.getText().equals("")){            String str = theSetupControl.querySQLParam(jTextField1.getText(),startdate.trim(),enddate.trim());            jLabelStatus.setText(str);            }    }    public void setTable(String[] columnname ,Vector vc)    {        String[] col = columnname;        Item p = new Item();        TaBleModel tm ;        int countrows = 0;        if(vc != null)        {   tm= new TaBleModel(col,vc.size());            if(vc.size() > 0)            {   //????? ??? 1 ???                for(int i=0 ;i<vc.size(); i++)               {    //????????? column                   String[] rowdata = (String[])vc.get(i);                   for(int j = 0 ; j < rowdata.length ;j++)                   {                        tm.setValueAt(rowdata[j],i,j);                   }                   tm.setEditingCol(rowdata.length+1);                   rowdata = null;                   countrows = countrows + 1;                                  }            }            jLabelStatus.setText("Result: " + countrows + " rows" );        }        else        {   tm= new TaBleModel(col,0);        }        jTable1.setModel(tm);    }    public void notifyreFrashPanel() {        setupLookup();    }    public void notifyquerySQLParam(String[] columnname, Vector vString) {        setTable(columnname,vString);    }        public void notifysetEnableForLift(boolean b) {    }    public int editOption(Option option) {        Constant.println("PanelReportSQLParam function is not use.");        return -1;    }    public Vector listOptionAll() {        Constant.println("PanelReportSQLParam function is not use.");        return null;    }    public void reFrashPanel() {    }    public Option readOption() {        Constant.println("PanelReportSQLParam function is not use.");        return null;    }    public int saveOption(Option option) {        Constant.println("PanelReportSQLParam function is not use.");        return -1;    }    public void setEnableForLift(boolean b) {    }    public Vector comboBoxViewSQLTemplateParam() {        Constant.println("PanelReportSQLParam function is not use.");        return null;    }    public int deleteSQLTemplateParam(SQLTemplateParam sqlttemplate) {        Constant.println("PanelReportSQLParam function is not use.");        return -1;    }    public int editSQLTemplateParam(SQLTemplateParam sqlttemplateparam) {        Constant.println("PanelReportSQLParam function is not use.");        return -1;    }    public Vector listSQLTemplateParamAll(String search) {        Constant.println("PanelReportSQLParam function is not use.");        return null;    }    public SQLTemplateParam listSQLTemplateParamByCode(String code) {        Constant.println("PanelReportSQLParam function is not use.");        return null;    }    public Vector listSQLTemplateParamBySearch(String search, String status) {        Constant.println("PanelReportSQLParam function is not use.");        return null;    }    public void querySQLParam(String sql, String startdate, String enddate) {    }    public SQLTemplateParam readSQLTemplateParamByID(String key_id) {        Constant.println("PanelReportSQLParam function is not use.");        return null;    }    public int saveSQLTemplateParam(SQLTemplateParam sqlttemplateparam) {        Constant.println("PanelReportSQLParam function is not use.");        return -1;    }    // Variables declaration - do not modify//GEN-BEGIN:variables    private com.hospital_os.utility.DateComboBox dateComboBox1;    private com.hospital_os.utility.DateComboBox dateComboBox2;    private com.hospital_os.gui.font.FontFormatTitle fontFormatTitle1;    private javax.swing.JButton jButton2;    private javax.swing.JButton jButtonRefresh;    private javax.swing.JComboBox jComboBoxBoxSQLTemplateParam;    private javax.swing.JLabel jLabel2;    private javax.swing.JLabel jLabel3;    private javax.swing.JLabel jLabel4;    private javax.swing.JLabel jLabelStatus;    private javax.swing.JPanel jPanel1;    private javax.swing.JPanel jPanel2;    private javax.swing.JPanel jPanel3;    private javax.swing.JPanel jPanel4;    private javax.swing.JScrollPane jScrollPane1;    private javax.swing.JScrollPane jScrollPane2;    private com.hosv3.gui.component.HJTableSort jTable1;    private javax.swing.JTextArea jTextField1;    // End of variables declaration//GEN-END:variables    public static void main(String[] argc){        JFrame jf = new JFrame();        jf.setSize(800,600);        PanelReportSQLParam hps = new PanelReportSQLParam();        jf.getContentPane().add(hps);        jf.setVisible(true);    }    }