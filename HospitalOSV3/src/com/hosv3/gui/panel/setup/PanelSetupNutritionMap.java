/*
 * PanelSetupNutritionMap.java
 *
 * Created on 26 เมษายน 2549, 18:21 น.
 */

package com.hosv3.gui.panel.setup;

import java.util.*;
import com.hosv3.control.*;
import com.hosv3.utility.connection.*;
import com.hosv3.utility.GuiLang;
import com.hospital_os.utility.*;
import com.hospital_os.object.*;

/**
 *
 * @author  amp
 */
public class PanelSetupNutritionMap extends javax.swing.JPanel
{
    HosControl theHC;
    UpdateStatus theUS; 
    Vector vNutritionOld;
    Vector vNutritionNew;
    
    /** Creates new form PanelSetupDrugInteraction */
    public PanelSetupNutritionMap(HosControl hc,UpdateStatus us)
    {
        theHC = hc;
        theUS = us;
        initComponents();
        setLanguage(); 
        initData();
    }
    
    /**
     *@Author: amp
     *@date: 20/03/2549
     *@see : จัดการเกี่ยวกับภาษา    
     */
    private void setLanguage()
    {
        GuiLang.setLanguage(jLabel16);
        GuiLang.setLanguage(jPanel12);
        GuiLang.setLanguage(jPanel1);
        GuiLang.setLanguage(jPanel3);
        GuiLang.setLanguage(jPanel19);
        GuiLang.setLanguage(jPanel2);
    }
    
    private void initData()
    {
        vNutritionNew = theHC.theLookupControl.listNutritionType();        
        vNutritionOld = theHC.theLookupControl.listNutritionTypeOld();
        setTableNutritionNew(vNutritionNew);
        setTableNutritionOld(vNutritionOld);
        searchMap();
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        buttonGroupInteraction = new javax.swing.ButtonGroup();
        defaultFont1 = new com.hospital_os.gui.font.DefaultFont();
        fontFormatTitle1 = new com.hospital_os.gui.font.FontFormatTitle();
        jPanel19 = new javax.swing.JPanel();
        jLabel16 = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTableMap = new com.hosv3.gui.component.HJTableSort();
        jPanel1 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTableNutritionNew = new javax.swing.JTable();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane3 = new javax.swing.JScrollPane();
        jTableNutrtionOld = new javax.swing.JTable();
        jPanel12 = new javax.swing.JPanel();
        jButtonSaveMap = new javax.swing.JButton();

        setLayout(new java.awt.GridBagLayout());

        jPanel19.setLayout(new java.awt.GridBagLayout());

        jLabel16.setFont(fontFormatTitle1);
        jLabel16.setText("\u0e08\u0e31\u0e1a\u0e04\u0e39\u0e48\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e42\u0e20\u0e0a\u0e19\u0e32\u0e01\u0e32\u0e23");
        jPanel19.add(jLabel16, new java.awt.GridBagConstraints());

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 5, 5);
        add(jPanel19, gridBagConstraints);

        jPanel3.setLayout(new java.awt.GridBagLayout());

        jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "\u0e1c\u0e25\u0e01\u0e32\u0e23\u0e08\u0e31\u0e1a\u0e04\u0e39\u0e48", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, defaultFont1));
        jTableMap.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        jTableMap.setFont(defaultFont1);
        jScrollPane1.setViewportView(jTableMap);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel3.add(jScrollPane1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        add(jPanel3, gridBagConstraints);

        jPanel1.setLayout(new java.awt.GridBagLayout());

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e42\u0e20\u0e0a\u0e19\u0e32\u0e01\u0e32\u0e23\u0e41\u0e1a\u0e1a\u0e43\u0e2b\u0e21\u0e48", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, defaultFont1));
        jPanel1.setMinimumSize(new java.awt.Dimension(300, 200));
        jPanel1.setPreferredSize(new java.awt.Dimension(300, 200));
        jTableNutritionNew.setFont(defaultFont1);
        jTableNutritionNew.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        jScrollPane2.setViewportView(jTableNutritionNew);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel1.add(jScrollPane2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 5, 5);
        add(jPanel1, gridBagConstraints);

        jPanel2.setLayout(new java.awt.GridBagLayout());

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "\u0e23\u0e30\u0e14\u0e31\u0e1a\u0e42\u0e20\u0e0a\u0e19\u0e32\u0e01\u0e32\u0e23\u0e41\u0e1a\u0e1a\u0e40\u0e01\u0e48\u0e32", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, defaultFont1));
        jPanel2.setMinimumSize(new java.awt.Dimension(350, 200));
        jPanel2.setPreferredSize(new java.awt.Dimension(350, 200));
        jTableNutrtionOld.setFont(defaultFont1);
        jTableNutrtionOld.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        jScrollPane3.setViewportView(jTableNutrtionOld);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel2.add(jScrollPane3, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);
        add(jPanel2, gridBagConstraints);

        jPanel12.setLayout(new java.awt.GridBagLayout());

        jButtonSaveMap.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/hospital_os/images/Save16.gif")));
        jButtonSaveMap.setMargin(new java.awt.Insets(0, 0, 0, 0));
        jButtonSaveMap.setMaximumSize(new java.awt.Dimension(24, 24));
        jButtonSaveMap.setMinimumSize(new java.awt.Dimension(24, 24));
        jButtonSaveMap.setPreferredSize(new java.awt.Dimension(24, 24));
        jButtonSaveMap.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveMapActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHEAST;
        gridBagConstraints.weightx = 1.0;
        jPanel12.add(jButtonSaveMap, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.SOUTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 5, 5);
        add(jPanel12, gridBagConstraints);

    }// </editor-fold>//GEN-END:initComponents

    private void jButtonSaveMapActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jButtonSaveMapActionPerformed
    {//GEN-HEADEREND:event_jButtonSaveMapActionPerformed
        int row_new = jTableNutritionNew.getSelectedRow();
        if(row_new == -1) return;
        NutritionType nutritionNew = (NutritionType)vNutritionNew.get(row_new);
        int[] row_old = jTableNutrtionOld.getSelectedRows();
        if(row_old.length==0) return;        
        theHC.theSetupControl.saveNutritionMap(nutritionNew,vNutritionOld,row_old);        
        searchMap();
    }//GEN-LAST:event_jButtonSaveMapActionPerformed
       
    private void setTableNutritionNew(Vector vc)
    {
        String[] column = {GuiLang.setLanguage("ระดับโภชนาการแบบใหม่")};
        TaBleModel tm;
        if(vc != null)
        {           
            tm = new TaBleModel(column,vc.size());
            NutritionType nutritionType;
            for(int i=0,size=vc.size(); i<size; i++)
            {  
                nutritionType = (NutritionType)vc.get(i);
                tm.setValueAt(nutritionType.description,i,0);
            }
            jTableNutritionNew.setModel(tm);
            nutritionType = null;
        }
        else
        {
            tm = new TaBleModel(column,0);
            jTableNutritionNew.setModel(tm);
        }  
    }
    
    private void setTableNutritionOld(Vector vc)
    {
        String[] column = {GuiLang.setLanguage("ระดับโภชนาการแบบเก่า")};
        TaBleModel tm;
        if(vc != null)
        {           
            tm = new TaBleModel(column,vc.size());
            NutritionType nutritionType;
            for(int i=0,size=vc.size(); i<size; i++)
            {  
                nutritionType = (NutritionType)vc.get(i);
                tm.setValueAt(nutritionType.description,i,0);
            }
            jTableNutrtionOld.setModel(tm);
            nutritionType = null;
        }
        else
        {
            tm = new TaBleModel(column,0);
            jTableNutrtionOld.setModel(tm);
        }  
    }
    
    private void searchMap()
    {        
        Vector vMap  = theHC.theSetupControl.listNutritionMap();
        setTableMap(vMap);
    }
    
    private void setTableMap(Vector vc)
    {
        String[] column = {GuiLang.setLanguage("ระดับโภชนาการแบบใหม่"),
                GuiLang.setLanguage("ระดับโภชนาการแบบเก่า")};
        TaBleModel tm;
        if(vc != null)
        {           
            tm = new TaBleModel(column,vc.size());
            NutritionTypeMap nutritionTypeMap;
            for(int i=0,size=vc.size(); i<size; i++)
            {  
                nutritionTypeMap = (NutritionTypeMap)vc.get(i);
                tm.setValueAt(nutritionTypeMap.nutrition_new_description,i,0);
                tm.setValueAt(nutritionTypeMap.nutrition_old_description,i,1);
            }
            jTableMap.setModel(tm);
            nutritionTypeMap = null;
        }
        else
        {
            tm = new TaBleModel(column,0);
            jTableMap.setModel(tm);
        }  
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup buttonGroupInteraction;
    private com.hospital_os.gui.font.DefaultFont defaultFont1;
    private com.hospital_os.gui.font.FontFormatTitle fontFormatTitle1;
    private javax.swing.JButton jButtonSaveMap;
    private javax.swing.JLabel jLabel16;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel12;
    private javax.swing.JPanel jPanel19;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private com.hosv3.gui.component.HJTableSort jTableMap;
    private javax.swing.JTable jTableNutritionNew;
    private javax.swing.JTable jTableNutrtionOld;
    // End of variables declaration//GEN-END:variables
    
}
