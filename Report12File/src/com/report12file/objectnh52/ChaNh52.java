/* * Cha.java * * Created on 8 กันยายน 2548, 12:02 น. * * To change this template, choose Tools | Options and locate the template under * the Source Creation and Management node. Right-click the template and choose * Open. You can then make changes to the template in the Source Editor. */package com.report12file.objectnh52;import com.linuxense.javadbf.DBFField;import com.report12file.object.*;import com.report12file.utility.Report12FileData;import com.report12file.object.Rp12OI;import com.reportcenter.utility.IOStream;import com.reportcenter.utility.StringDate;import java.io.BufferedReader;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;/** * * @author tong(Padungrat) */public class ChaNh52 extends Cha implements Rp12OI{    public String seq;    public String draw;    public ChaNh52() {    }    public String[] getHeaderArray() {        return new String[]{            "hn",            "an",            "date",            "chrgitem",            "amount",            "person_id",            "seq"        };    }    /**     */    public String[] getValueArray() {        return new String[]{            hn	,            an	,            date	,            chrgitem	,            amount	,            pid,            seq        };    }    public DBFField[] getDBFField() throws Exception {        String[] header = getHeaderArray();        DBFField[] fields = new DBFField[header.length];        Report12FileData.initDBFField(0,header,fields,DBFField.FIELD_TYPE_C,9);        Report12FileData.initDBFField(1,header,fields,DBFField.FIELD_TYPE_C,9);        Report12FileData.initDBFField(2,header,fields,DBFField.FIELD_TYPE_D,8);        Report12FileData.initDBFField(3,header,fields,DBFField.FIELD_TYPE_C,2);        Report12FileData.initDBFField(4,header,fields,DBFField.FIELD_TYPE_N,7);        Report12FileData.initDBFField(5,header,fields,DBFField.FIELD_TYPE_C,13);        Report12FileData.initDBFField(6,header,fields,DBFField.FIELD_TYPE_C,15);            return fields;    }    public Object[] getDBFValue() {        ChaNh52 p = this;        Object[] rowData;        rowData = new Object[7];        rowData[0] = p.hn;        rowData[1] = p.an;        rowData[2] = StringDate.StringDateToDate(p.date);        rowData[3] = p.chrgitem;        rowData[4] = Report12FileData.getDouble(p.amount);        rowData[5] = p.pid;        rowData[6] = p.seq;        return rowData;    }    ///////////////////////////////////////////////////////addcheckData    public boolean checkDatadict(StringBuffer sb,int[] error) {        BufferedReader in;        ChaNh52 file = this;        boolean ret = true;        error[0]++;        if(!Report12FileData.checkDataDict(	hn	,	9	,	true	)) { 	error[1	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	an	,	9	,	false	)) { 	error[2	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	date	,	8	,	true	)) { 	error[3	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	chrgitem	,	2	,	false	)) { 	error[4	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	amount	,	7	,	false	)) { 	error[5	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	pid	,	13	,	false	)) { 	error[6	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	seq	,	15	,	true,false	)) { 	error[7	]++;    ret=false;}        if(!ret) {            error[Report12FileData.MAX_COLUMN-1]++;            if(error[Report12FileData.MAX_COLUMN-1]<Report12FileData.MAX_INCOMPLETE_ROW)                sb.append("\r\n\tรายการที่ผิดพลาดคือ เลข HN:"+ file.hn + "  วันที่:" + date);            if(add_digit)                sb.append(" มีการปรับหลักของ HN/VN/AN");        }        return ret;    }    public boolean setValue(ResultSet rs) throws Exception {        ChaNh52 p = this;        p.	hn	 = Report12FileData.getRsString(rs,	1	);        p.	an	 = Report12FileData.getRsString(rs,	2	);        p.	date	 = Report12FileData.getRsString(rs,	3	);        String chrg 	 = Report12FileData.getRsString(rs,	4	);        p.	amount	 = Report12FileData.getRsString(rs,	5	);        p.	pid	 = Report12FileData.getRsString(rs,	6	);        p.	seq	 = Report12FileData.getRsString(rs,	7	);        String draw	 = Report12FileData.getRsString(rs,	8	);        p.	chrgitem = getChrgItem(chrg,draw);        p.hn = Report12FileData.addDigit(p.hn,9);        p.an = Report12FileData.addDigit(p.an,9);        if(Report12FileData.isAddDigit(p.hn,9)        || Report12FileData.isAddDigit(p.an,9))            add_digit = true;        return true;    }    /**     *11	ค่าห้อง/ค่าอาหาร ...เบิกได้	STI0112	ค่าห้อง/ค่าอาหาร ...เบิกไม่ได้	ค่าอวัยวะเทียมและอุปกรณ์บำบัดรักษาโรค 	STI0231	ยาและสารอาหารทางเส้นเลือดที่ใช้ใน รพ.( )  ...เบิกได้	STI0332	ยาและสารอาหารทางเส้นเลือดที่ใช้ใน รพ.( )  ...เบิกไม่ได้41	ยาที่นำไปใช้ต่อที่บ้าน ...เบิกได้	STI04_OH42	ยาที่นำไปใช้ต่อที่บ้าน ...เบิกไม่ได้51	เวชภัณฑ์ที่ไม่ใช่ยา ...เบิกได้	STI0552	เวชภัณฑ์ที่ไม่ใช่ยา ...เบิกไม่ได้61	บริการโลหิตและส่วนประกอบของโลหิต ...เบิกได้	STI0662	บริการโลหิตและส่วนประกอบของโลหิต ...เบิกไม่ได้71	ตรวจวินิจฉัยทางเทคนิคการแพทย์และพยาธิวิทยา ...เบิกได้	STI0772	ตรวจวินิจฉัยทางเทคนิคการแพทย์และพยาธิวิทยา ...เบิกไม่ได้81	ตรวจวินิจฉัยและรักษาทางรังสีวิทยา...เบิกได้	STI0882	ตรวจวินิจฉัยและรักษาทางรังสีวิทยา...เบิกไม่ได้91	ตรวจวินิจฉัยโดยวิธีพิเศษอื่น ๆ ...เบิกได้	STI0992	ตรวจวินิจฉัยโดยวิธีพิเศษอื่น ๆ ...เบิกไม่ได้A1	อุปกรณ์ของใช้และเครื่องมือทางการแพทย์...เบิกได้	STI10A2	อุปกรณ์ของใช้และเครื่องมือทางการแพทย์...เบิกไม่ได้B1	ทำหัตถการ และบริการวิสัญญี ...เบิกได้	STI11B2	ทำหัตถการ และบริการวิสัญญี ...เบิกไม่ได้C1	ค่าบริการทางการพยาบาล ...เบิกได้	STI12C2	ค่าบริการทางการพยาบาล ...เบิกไม่ได้D1	บริการทางทันตกรรม ...เบิกได้	STI13D2	บริการทางทันตกรรม ...เบิกไม่ได้E1	บริการทางกายภาพบำบัด และเวชกรรมฟื้นฟู...เบิกได้	STI14E2	บริการทางกายภาพบำบัด และเวชกรรมฟื้นฟู...เบิกไม่ได้F1	บริการฝังเข็ม/การบำบัดของผู้ประกอบโรคศิลปะอื่น ๆ ...เบิกได้	STI15F2	บริการฝังเข็ม/การบำบัดของผู้ประกอบโรคศิลปะอื่น ๆ ...เบิกไม่ได้	บริการอื่น ๆ	STI16I1	ค่าธรรมเนียมบุคลากรมทางการแพทย์...เบิกได้I2	ค่าธรรมเนียมบุคลากรมทางการแพทย์...เบิกไม่ได้*/    private String getChrgItem(String chg,String draw)    {	if((chg.equals("1") || chg.equals("STI01")) && draw.equals("1")) return "11";	else if((chg.equals("1") || chg.equals("STI01")) && draw.equals("0")) return "12";	else if((chg.equals("3") || chg.equals("STI03")) && draw.equals("1")) return "31";	else if((chg.equals("3") || chg.equals("STI03")) && draw.equals("0")) return "32";	else if((chg.equals("4") || chg.equals("STI04_OH")) && draw.equals("1")) return "41";	else if((chg.equals("4") || chg.equals("STI04_OH")) && draw.equals("0")) return "42";	else if((chg.equals("5") || chg.equals("STI05")) && draw.equals("1")) return "51";	else if((chg.equals("5") || chg.equals("STI05")) && draw.equals("0")) return "52";	else if((chg.equals("6") || chg.equals("STI06")) && draw.equals("1")) return "61";	else if((chg.equals("6") || chg.equals("STI06")) && draw.equals("0")) return "62";	else if((chg.equals("7") || chg.equals("STI07")) && draw.equals("1")) return "71";	else if((chg.equals("7") || chg.equals("STI07")) && draw.equals("0")) return "72";	else if((chg.equals("8") || chg.equals("STI08")) && draw.equals("1")) return "81";	else if((chg.equals("8") || chg.equals("STI08")) && draw.equals("0")) return "82";	else if((chg.equals("9") || chg.equals("STI09")) && draw.equals("1")) return "91";	else if((chg.equals("9") || chg.equals("STI09")) && draw.equals("0")) return "92";	else if((chg.equals("A") || chg.equals("STI10")) && draw.equals("1")) return "A1";	else if((chg.equals("A") || chg.equals("STI10")) && draw.equals("0")) return "A2";	else if((chg.equals("B") || chg.equals("STI11")) && draw.equals("1")) return "B1";	else if((chg.equals("B") || chg.equals("STI11")) && draw.equals("0")) return "B2";	else if((chg.equals("C") || chg.equals("STI12")) && draw.equals("1")) return "C1";	else if((chg.equals("C") || chg.equals("STI12")) && draw.equals("0")) return "C2";	else if((chg.equals("D") || chg.equals("STI13")) && draw.equals("1")) return "D1";	else if((chg.equals("D") || chg.equals("STI13")) && draw.equals("0")) return "D2";	else if((chg.equals("E") || chg.equals("STI14")) && draw.equals("1")) return "E1";	else if((chg.equals("E") || chg.equals("STI14")) && draw.equals("0")) return "E2";	else if((chg.equals("F") || chg.equals("STI15")) && draw.equals("1")) return "F1";	else if((chg.equals("F") || chg.equals("STI15")) && draw.equals("0")) return "F2";	else return "";    }    public Rp12OI initInstant() {        return new ChaNh52();    }    public PreparedStatement getPreparedStatement(Connection con, String startDate, String endDate, int mode) throws Exception {        String sql = IOStream.readInputDefault("config/rp_12file52/12file52_cha.sql");        PreparedStatement pm = con.prepareStatement(sql);        pm.setString(1,startDate);        pm.setString(2,endDate);        pm.setString(3,startDate);        pm.setString(4,endDate);        return pm;    }}