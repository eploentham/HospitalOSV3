/* * Aer.java * * Created on 8 กันยายน 2548, 12:01 น. * * To change this template, choose Tools | Options and locate the template under * the Source Creation and Management node. Right-click the template and choose * Open. You can then make changes to the template in the Source Editor. */package com.report12file.objectnh52;import com.linuxense.javadbf.DBFField;import com.report12file.object.Rp12OI;import com.report12file.utility.Report12FileData;import com.reportcenter.utility.IOStream;import com.reportcenter.utility.StringDate;import java.io.BufferedReader;import java.sql.Connection;import java.sql.PreparedStatement;import java.sql.ResultSet;/** * * @author tong(Padungrat) */public class AerNh52 implements Rp12OI{    public String hn;    public String an;    public String dateopd;    public String authae;    public String aedate;    public String aetime;    public String aetype;    public String refmaini;    public String ireftype;    public String refmaino;    public String oreftype;    public String ucae;    public String emtype;    public String seq;    private boolean add_digit;    /** Creates a new instance of Aer */    public AerNh52() {    }    public String[] getValueArray() {        return new String[]{            hn,            an,            dateopd,            authae,            aedate,            aetime,            aetype,            refmaini,            ireftype,            refmaino,            oreftype,            ucae,            emtype,            seq        };    }    public String[] getWarningArray() {        return new String[]{            "เลข HN",            "เลข AN",            "วันที่รับบริการ",            "Claim code",            "วันที่เกิดอุบัติเหตุ",            "เวลาที่เกิดอุบัติเหตุ",            "สิทธิการรักษาอื่น",            "โรงพบาบาลที่ส่งมา",            "วัตถุประสงค์การรับ Refer",            "โรงพยาบาลส่งต่อ",            "วัตถุประสงค์การส่งต่อ",            "รหัสอุบัติเหตุ/ฉุกเฉิน",            "รหัสข้อบ่งชี้กรณีฉุกเฉิน",            "รหัสการบริการ"        };    }    public String[] getHeaderArray() {        return new String[]{            "hn",            "an",            "dateopd",            "authae",            "aedate",            "aetime",            "aetype",            "refmaini",            "ireftype",            "refmaino",            "oreftype",            "ucae",            "emtype",            "seq"        };    }    public String getFileName() {        return "AER";    }    public Rp12OI initInstant() {        return new AerNh52();    }    public boolean setValue(ResultSet rs) throws Exception {            hn	 = Report12FileData.getRsString(rs,	1	);            an	 = Report12FileData.getRsString(rs,	2	);            dateopd	 = Report12FileData.getRsString(rs,	3	);            authae	 = Report12FileData.getRsString(rs,	4	);            aedate	 = Report12FileData.getRsString(rs,	5	);            aetime	 = Report12FileData.getRsString(rs,	6	);            aetype	 = Report12FileData.getRsString(rs,	7	);            refmaini	 = Report12FileData.getRsString(rs,	8	);            ireftype	 = Report12FileData.getRsString(rs,	9	);            refmaino	 = Report12FileData.getRsString(rs,	10	);            oreftype	 = Report12FileData.getRsString(rs,	11	);            ucae	 = Report12FileData.getRsString(rs,	12	);            emtype	 = Report12FileData.getRsString(rs,	13	);            seq	 = Report12FileData.getRsString(rs,	14	);            AerNh52 p = this;        p.hn = Report12FileData.addDigit(p.hn,9);        p.an = Report12FileData.addDigit(p.an,9);        if(Report12FileData.isAddDigit(p.hn,9)        || Report12FileData.isAddDigit(p.an,9))            add_digit = true;        return true;    }    public boolean checkDatadict(StringBuffer sb, int[] error) {        BufferedReader in;        AerNh52 file = this;        boolean ret = true;        error[0]++;        if(!Report12FileData.checkDataDict(	hn	,	9	,	true,false	)) { 	error[1	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	an	,	9	,	false	)) { 	error[2	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	dateopd	,	8	,	true	)) { 	error[3	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	authae	,	12	,	false	)) { 	error[4	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	aedate	,	8	,	true	)) { 	error[5	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	aetime	,	4	,	true	)) { 	error[6	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	aetype	,	1	,	true	)) { 	error[7	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	refmaini	,	5	,	false,true	)) { 	error[8	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	ireftype	,	4	,	false,true	)) { 	error[9	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	refmaino	,	5	,	false,true	)) { 	error[10	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	oreftype	,	4	,	false,true	)) { 	error[11	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	ucae	,	1	,	true,false	)) { 	error[12	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	emtype	,	1	,	false	)) { 	error[13	]++;    ret=false;}        if(!Report12FileData.checkDataDict(	seq	,	15	,	true,false	)) { 	error[14	]++;    ret=false;}        if(!ret) {            error[Report12FileData.MAX_COLUMN-1]++;            if(error[Report12FileData.MAX_COLUMN-1]<Report12FileData.MAX_INCOMPLETE_ROW)                sb.append("\r\n\tรายการที่ผิดพลาดคือ เลข HN:"+ file.hn + "  วันที่:" + dateopd);            if(add_digit)                sb.append(" มีการปรับหลักของ HN/VN/AN");        }        return ret;    }    public PreparedStatement getPreparedStatement(Connection con, String startDate, String endDate, int mode) throws Exception {        String sql = IOStream.readInputDefault("config/rp_12file52/12file52_aer.sql");        PreparedStatement pm = con.prepareStatement(sql);        pm.setString(1,startDate);        pm.setString(2,endDate);        return pm;    }    public DBFField[] getDBFField() throws Exception {        String[] header = getHeaderArray();        DBFField[] fields = new DBFField[header.length];        Report12FileData.initDBFField(0,header,fields,DBFField.FIELD_TYPE_C,9);        Report12FileData.initDBFField(1,header,fields,DBFField.FIELD_TYPE_C,9);        Report12FileData.initDBFField(2,header,fields,DBFField.FIELD_TYPE_D,8);        Report12FileData.initDBFField(3,header,fields,DBFField.FIELD_TYPE_C,12);        Report12FileData.initDBFField(4,header,fields,DBFField.FIELD_TYPE_D,8);        Report12FileData.initDBFField(5,header,fields,DBFField.FIELD_TYPE_C,4);        Report12FileData.initDBFField(6,header,fields,DBFField.FIELD_TYPE_C,1);        Report12FileData.initDBFField(7,header,fields,DBFField.FIELD_TYPE_C,5);        Report12FileData.initDBFField(8,header,fields,DBFField.FIELD_TYPE_C,4);        Report12FileData.initDBFField(9,header,fields,DBFField.FIELD_TYPE_C,5);        Report12FileData.initDBFField(10,header,fields,DBFField.FIELD_TYPE_C,4);        Report12FileData.initDBFField(11,header,fields,DBFField.FIELD_TYPE_C,1);        Report12FileData.initDBFField(12,header,fields,DBFField.FIELD_TYPE_C,1);        Report12FileData.initDBFField(13,header,fields,DBFField.FIELD_TYPE_C,15);            return fields;    }    public Object[] getDBFValue() {        Object[] rowData = new Object[14];        rowData[0] = hn;        rowData[1] = an;        rowData[2] = StringDate.StringDateToDate(dateopd);        rowData[3] = authae;        rowData[4] = StringDate.StringDateToDate(aedate);        rowData[5] = aetime;        rowData[6] = aetype;        rowData[7] = refmaini;        rowData[8] = ireftype;        rowData[9] = refmaino;        rowData[10] = oreftype;        rowData[11] = ucae;        rowData[12] = emtype;        rowData[13] = seq;        return rowData;    }}