package com.hospital_os.objdb;import com.hospital_os.usecase.connection.*;import com.hospital_os.utility.*;import com.hospital_os.object.*;import java.util.*;import java.sql.*;public class AutoOrderItemDB{    public ConnectionInf theConnectionInf;    public AutoOrderItem dbObj;    final private String idtable = "113";    /**     * @param ConnectionInf db     * @roseuid 3F65897F0326     */    public AutoOrderItemDB(ConnectionInf db)    {        theConnectionInf=db;        dbObj = new AutoOrderItem();        initConfig();    }    public boolean initConfig()    {        dbObj.table="b_item_auto";        dbObj.pk_field="b_item_auto_id";        dbObj.auto_order_item_id     ="item_auto_number";        dbObj.item_id     ="b_item_id";        dbObj.plan_id     ="b_contract_plans_id";        dbObj.monday     ="item_auto_mon_fri_show";        dbObj.saturday     ="item_auto_saturday_show";        dbObj.sunday     ="item_auto_sunday_show";        dbObj.mon_time_start     ="mon_time_mon_fri_start";        dbObj.mon_time_stop     ="mon_time_mon_fri_stop";        dbObj.sat_time_start     ="item_auto_saturday_show_start_time";        dbObj.sat_time_stop     ="item_auto_saturday_show_stop_time";        dbObj.sun_time_start     ="item_auto_sunday_show_start_time";        dbObj.sun_time_stop     ="item_auto_sunday_show_stop_time";        dbObj.mon_alltime     ="item_auto_mon_fri_show_all_time";        dbObj.sat_alltime     ="item_auto_saturday_show_all_time";        dbObj.sun_alltime  ="item_auto_sunday_show_all_time";        /*        dbObj.table = "auto_order_item";        dbObj.pk_field = "key_id";        dbObj.auto_order_item_id = "auto_order_item_id";        dbObj.item_id = "item_id";        dbObj.plan_id ="plan_id";        dbObj.monday ="monday";        dbObj.saturday="saturday";        dbObj.sunday="sunday";        dbObj.mon_alltime="mon_alltime";        dbObj.sat_alltime="sat_alltime";        dbObj.sun_alltime="sun_alltime";        dbObj.mon_time_start="mon_time_start";        dbObj.mon_time_stop="mon_time_stop";        dbObj.sat_time_start="sat_time_start";        dbObj.sat_time_stop="sat_time_stop";        dbObj.sun_time_start="sun_time_start";        dbObj.sun_time_stop="sun_time_stop";         **/        return true;    }    /**     * @param cmd     * @param o     * @return int     * @roseuid 3F6574DE0394     */    public int insert(AutoOrderItem o) throws Exception    {        String sql="";        AutoOrderItem p=o;        p.generateOID(idtable);        sql="insert into " + dbObj.table + " ("        + dbObj.pk_field        + " ,"	+ dbObj.auto_order_item_id        + " ,"	+ dbObj.item_id        + " ,"  + dbObj.plan_id        + " ,"  + dbObj.monday        + " ,"  + dbObj.saturday        + " ,"  + dbObj.sunday        + " ,"  + dbObj.mon_alltime        + " ,"  + dbObj.sat_alltime        + " ,"  + dbObj.sun_alltime        + " ,"  + dbObj.mon_time_start        + " ,"  + dbObj.mon_time_stop        + " ,"  + dbObj.sat_time_start        + " ,"  + dbObj.sat_time_stop        + " ,"  + dbObj.sun_time_start        + " ,"  + dbObj.sun_time_stop        + " ) values ('"        + p.getObjectId()        + "','" + p.auto_order_item_id        + "','" + p.item_id        + "','" + p.plan_id        + "','" + p.monday        + "','" + p.saturday        + "','" + p.sunday        + "','" + p.mon_alltime        + "','" + p.sat_alltime        + "','" + p.sun_alltime        + "','" + p.mon_time_start        + "','" + p.mon_time_stop        + "','" + p.sat_time_start        + "','" + p.sat_time_stop        + "','" + p.sun_time_start        + "','" + p.sun_time_stop        + "')";        sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }    public int update(AutoOrderItem o) throws Exception    {        String sql="update " + dbObj.table + " set ";        AutoOrderItem p=o;        String field =""        + "', " + dbObj.auto_order_item_id + "='" + p.auto_order_item_id        + "', " + dbObj.item_id + "='" + p.item_id        + "', " + dbObj.plan_id + "='" + p.plan_id        + "', " + dbObj.monday + "='" + p.monday        + "', " + dbObj.saturday + "='" + p.saturday        + "', " + dbObj.sunday + "='" + p.sunday        + "', " + dbObj.mon_alltime + "='" + p.mon_alltime        + "', " + dbObj.sat_alltime + "='" + p.sat_alltime        + "', " + dbObj.sun_alltime + "='" + p.sun_alltime        + "', " + dbObj.mon_time_start + "='" + p.mon_time_start        + "', " + dbObj.mon_time_stop + "='" + p.mon_time_stop        + "', " + dbObj.sat_time_start + "='" + p.sat_time_start        + "', " + dbObj.sat_time_stop + "='" + p.sat_time_stop        + "', " + dbObj.sun_time_start + "='" + p.sun_time_start        + "', " + dbObj.sun_time_stop + "='" + p.sun_time_stop        + "' where " + dbObj.pk_field + "='" + p.getObjectId() +"'";        sql = Gutil.convertSQLToMySQL(sql+field.substring(2),theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }        public int delete(AutoOrderItem o) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.pk_field + "='" + o.getObjectId() +"'";        return theConnectionInf.eUpdate(sql);    }        public AutoOrderItem selectByPK(String pk) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.pk_field        + " = '" + pk + "'";        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (AutoOrderItem)v.get(0);    }        public AutoOrderItem selectByCode(String code) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.auto_order_item_id        + " = '" + code + "'";        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (AutoOrderItem)v.get(0);    }        public Vector selectAllAutoOrder() throws Exception    {        Vector vc = new Vector();        String sql ="select * from " + dbObj.table + " order by "+        dbObj.auto_order_item_id;                vc = eQuery(sql);        if(vc.size()==0)            return null;        else            return vc;    }        public Vector selectAutoOrderByName(String key) throws Exception    {                  String sql="select b_item_auto.b_item_auto_id as item_auto_id ," +                    " b_item_auto.item_auto_number as auto_number," +                    " b_item_auto.b_item_id as item_id," +                    " b_item.item_common_name as common_name," +                    " b_item_auto.b_contract_plans_id as plans_id," +                    " b_item_auto.item_auto_mon_fri_show as mon_fri_show," +                    " b_item_auto.item_auto_saturday_show as saturday_show," +                    " b_item_auto.item_auto_sunday_show as sunday_show," +                    " b_item_auto.item_auto_mon_fri_show_all_time as mon_fri_show_all_time," +                    " b_item_auto.item_auto_sunday_show_all_time as sunday_show_all_time," +                    " b_item_auto.item_auto_saturday_show_all_time as saturday_show_all_time," +                    " b_item_auto.mon_time_mon_fri_start as mon_fri_start," +                    " b_item_auto.mon_time_mon_fri_stop as mon_fri_stop," +                    " b_item_auto.item_auto_saturday_show_start_time as saturday_show_start_time," +                    " b_item_auto.item_auto_saturday_show_stop_time as saturday_show_stop_time," +                    " b_item_auto.item_auto_sunday_show_start_time as sunday_show_start_time," +                    " b_item_auto.item_auto_sunday_show_stop_time as sunday_show_stop_time" +                    " from b_item_auto inner join b_item " +                    " on b_item.b_item_id = b_item_auto.b_item_id " +                    " where (UPPER(b_item_auto.item_auto_number) like UPPER('" + key.toUpperCase() + "')" +                     " or UPPER(b_item.item_common_name)like UPPER('" + key.toUpperCase() + "')" +                    " or UPPER(b_item.item_trade_name)like UPPER('" + key.toUpperCase() + "')" +                    " or UPPER(b_item.item_nick_name)like UPPER('" + key.toUpperCase() + "'))";                    sql = sql +  " order by b_item_auto.item_auto_number ";                    Vector vc = sEQuery(sql);        if(vc.size()==0)            return null;        else            return vc;    }        public Vector selectAll() throws Exception    {        Vector vc = new Vector();        String sql ="select * from " + dbObj.table + " order by "+        dbObj.auto_order_item_id;        vc = veQuery(sql);        if(vc.size()==0)            return null;        else            return vc;    }            /**     *@deprecated henbe unused     *     */    public Vector veQuery(String sql) throws Exception    {        ComboFix p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new ComboFix();            p.code = rs.getString(dbObj.pk_field);            p.name = rs.getString(dbObj.auto_order_item_id);            list.add(p);        }        rs.close();        return list;    }        public Vector eQuery(String sql) throws Exception    {        AutoOrderItem p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new AutoOrderItem();            p.setObjectId(rs.getString(dbObj.pk_field));            p.auto_order_item_id = rs.getString(dbObj.auto_order_item_id);            p.item_id = rs.getString(dbObj.item_id);            p.plan_id = rs.getString(dbObj.plan_id);            p.monday = rs.getString(dbObj.monday);            p.saturday = rs.getString(dbObj.saturday);            p.sunday = rs.getString(dbObj.sunday);            p.mon_alltime = rs.getString(dbObj.mon_alltime);            p.sun_alltime = rs.getString(dbObj.sun_alltime);            p.sat_alltime = rs.getString(dbObj.sat_alltime);            p.mon_time_start = rs.getString(dbObj.mon_time_start);            p.mon_time_stop = rs.getString(dbObj.mon_time_stop);            p.sat_time_start = rs.getString(dbObj.sat_time_start);            p.sat_time_stop = rs.getString(dbObj.sat_time_stop);            p.sun_time_start = rs.getString(dbObj.sun_time_start);            p.sun_time_stop = rs.getString(dbObj.sun_time_stop);            list.add(p);        }        rs.close();        return list;    }        public Vector sEQuery(String sql) throws Exception    {        AutoOrderItem p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new AutoOrderItem();           //p.setObjectId(rs.getString("b_item_auto.b_item_auto_id"));           // p.setObjectId(rs.getString(dbObj.pk_field));           /* p.auto_order_item_id = rs.getString("b_item_auto.item_auto_number");            p.item_id = rs.getString("b_item_auto.b_item_id");            p.description = rs.getString("b_item.item_common_name");            p.plan_id = rs.getString("b_item_auto.b_contract_plans_id");            p.monday = rs.getString("b_item_auto.item_auto_mon_fri_show");            p.saturday = rs.getString("b_item_auto.item_auto_saturday_show");            p.sunday = rs.getString("b_item_auto.item_auto_sunday_show");            p.mon_alltime = rs.getString("b_item_auto.item_auto_mon_fri_show_all_time");            p.sun_alltime = rs.getString("b_item_auto.item_auto_sunday_show_all_time");            p.sat_alltime = rs.getString("b_item_auto.item_auto_saturday_show_all_time");            p.mon_time_start = rs.getString("b_item_auto.mon_time_mon_fri_start");            p.mon_time_stop = rs.getString("b_item_auto.mon_time_mon_fri_stop");            p.sat_time_start = rs.getString("b_item_auto.item_auto_saturday_show_start_time");            p.sat_time_stop = rs.getString("b_item_auto.item_auto_saturday_show_stop_time");            p.sun_time_start = rs.getString("b_item_auto.item_auto_sunday_show_start_time");            p.sun_time_stop = rs.getString("b_item_auto.item_auto_sunday_show_stop_time");*/                      /* p.auto_order_item_id = rs.getString(dbObj.auto_order_item_id);            p.item_id = rs.getString(dbObj.item_id);            p.description = rs.getString(dbObj.description);            p.plan_id = rs.getString(dbObj.plan_id);            p.monday = rs.getString(dbObj.monday);            p.saturday = rs.getString(dbObj.saturday);            p.sunday = rs.getString(dbObj.sunday);            p.mon_alltime = rs.getString(dbObj.mon_alltime);            p.sun_alltime = rs.getString(dbObj.sun_alltime);            p.sat_alltime = rs.getString(dbObj.sat_alltime);            p.mon_time_start = rs.getString(dbObj.mon_time_start);            p.mon_time_stop = rs.getString(dbObj.mon_time_stop);            p.sat_time_start = rs.getString(dbObj.sat_time_start);            p.sat_time_stop = rs.getString(dbObj.sat_time_stop);            p.sun_time_start = rs.getString(dbObj.sun_time_start);            p.sun_time_stop = rs.getString(dbObj.sun_time_stop);*/                                    p.setObjectId(rs.getString("item_auto_id"));            p.auto_order_item_id = rs.getString("auto_number");            p.item_id = rs.getString("item_id");            p.description = rs.getString("common_name");            p.plan_id = rs.getString("plans_id");            p.monday = rs.getString("mon_fri_show");            p.saturday = rs.getString("saturday_show");            p.sunday = rs.getString("sunday_show");            p.mon_alltime = rs.getString("mon_fri_show_all_time");            p.sun_alltime = rs.getString("sunday_show_all_time");            p.sat_alltime = rs.getString("saturday_show_all_time");            p.mon_time_start = rs.getString("mon_fri_start");            p.mon_time_stop = rs.getString("mon_fri_stop");            p.sat_time_start = rs.getString("saturday_show_start_time");            p.sat_time_stop = rs.getString("saturday_show_stop_time");            p.sun_time_start = rs.getString("sunday_show_start_time");            p.sun_time_stop = rs.getString("sunday_show_stop_time");            list.add(p);        }        rs.close();        return list;    }    }