package com.hospital_os.objdb;import com.hospital_os.usecase.connection.*;import com.hospital_os.utility.*;import com.hospital_os.object.*;import java.util.*;import java.sql.*;public class ParticipateOrDB{    public ConnectionInf theConnectionInf;    public ParticipateOr dbObj;    final public String idtable = "205";    /**     * @param ConnectionInf db     * @roseuid 3F65897F0326     */    public ParticipateOrDB(ConnectionInf db)    {        theConnectionInf=db;        dbObj = new ParticipateOr();        initConfig();    }        public ParticipateOrDB()    {        theConnectionInf=null;        dbObj = new ParticipateOr();        initConfig();    }        public boolean initConfig()    {        dbObj.table="t_diag_icd9_participate_or";        dbObj.pk_field="t_diag_icd9_participate_or_id";        dbObj.vn  ="diag_icd9_participate_or_vn";        dbObj.employee  ="diag_icd9_participate_or_staff_participate";        dbObj.icd9_id="b_icd9_id";        dbObj.t_diag_icd9_id = "t_diag_icd9_id";        dbObj.staff_insert = "diag_icd9_participate_or_staff_insert";        dbObj.time_insert = "diag_icd9_participate_or_time_insert";        dbObj.staff_update = "diag_icd9_participate_or_staff_update";        dbObj.time_update = "diag_icd9_participate_or_time_update";        dbObj.active = "diag_icd9_participate_or_active";        /*        dbObj.table = "participate_or";        dbObj.pk_field = "participate_or_id";        dbObj.vn = "vn";        dbObj.employee = "employee";        dbObj.icd9_id = "icd9_id";         */                return true;    }            /**     * @param cmd     * @param o     * @return int     * @roseuid 3F6574DE0394     */    public int insert(ParticipateOr o) throws Exception    {        String sql="";        ParticipateOr p=o;        p.generateOID(idtable);        sql="insert into " + dbObj.table + " ("        + dbObj.pk_field        + " ,"	+ dbObj.vn        + " ,"	+ dbObj.employee        + " ,"  + dbObj.icd9_id        + " ,"  + dbObj.t_diag_icd9_id        + " ,"  + dbObj.staff_insert        + " ,"  + dbObj.time_insert        + " ,"  + dbObj.staff_update        + " ,"  + dbObj.time_update        + " ,"  + dbObj.active        + " ) values ('"        + p.getObjectId()        + "','" + p.vn        + "','" + p.employee        + "','" + p.icd9_id        + "','" + p.t_diag_icd9_id        + "','" + p.staff_insert        + "','" + p.time_insert        + "','" + p.staff_update        + "','" + p.time_update        + "','" + p.active        + "')";                sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }        public int update(ParticipateOr o) throws Exception    {        String sql= "update " + dbObj.table + " set ";        ParticipateOr p=o;        String field = ""        + "', " +  dbObj.vn + "='" + p.vn        + "', " +  dbObj.employee + "='" + p.employee        + "', " +  dbObj.icd9_id + "='" + p.icd9_id        + "', " +  dbObj.t_diag_icd9_id + "='" + p.t_diag_icd9_id        + "', " +  dbObj.staff_insert + "='" + p.staff_insert        + "', " +  dbObj.time_insert + "='" + p.time_insert        + "', " +  dbObj.staff_update + "='" + p.staff_update        + "', " +  dbObj.time_update + "='" + p.time_update        + "', " +  dbObj.active + "='" + p.active        + "' where " + dbObj.pk_field + "='" + p.getObjectId() +"'";                sql = Gutil.convertSQLToMySQL(sql+field.substring(2),theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }            public int delete(ParticipateOr o) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.pk_field + "='" + o.getObjectId() +"'";                return theConnectionInf.eUpdate(sql);    }        public int deleteByIcd(String icd,String vn) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.icd9_id        + "='" + icd +"' and " + dbObj.vn        + "='" + vn +"' ";                return theConnectionInf.eUpdate(sql);    }        public ParticipateOr selectByEmAndIcd(ParticipateOr o) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.icd9_id        + " = '" + o.icd9_id + "' and " + dbObj.employee        + " = '" + o.employee  + "' and "+ dbObj.vn        + " = '" + o.vn +"'";                        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (ParticipateOr)v.get(0);    }            public Vector selectByIcd9(String code,String vn) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.icd9_id + " = '" + code         + "' and " + dbObj.vn + " = '" + vn        + "' and " + dbObj.active + " = '1'";                Vector v=eQuery(sql);                if(v.size()==0)            return null;        else            return v;    }        public Vector selectAll() throws Exception    {        String sql="select * from " + dbObj.table;        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return v;    }        public Vector eQuery(String sql) throws Exception    {        ParticipateOr p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new ParticipateOr();            p.setObjectId(rs.getString(dbObj.pk_field));            p.vn = rs.getString(dbObj.vn);            p.employee = rs.getString(dbObj.employee);            p.icd9_id = rs.getString(dbObj.icd9_id);            p.t_diag_icd9_id = rs.getString(dbObj.t_diag_icd9_id);            p.staff_insert = rs.getString(dbObj.staff_insert);            p.time_insert = rs.getString(dbObj.time_insert);            p.staff_update = rs.getString(dbObj.staff_update);            p.time_update = rs.getString(dbObj.time_update);            p.active = rs.getString(dbObj.active);            list.add(p);        }        rs.close();        return list;    }    }