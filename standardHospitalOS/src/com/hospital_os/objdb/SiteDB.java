package com.hospital_os.objdb;import com.hospital_os.usecase.connection.*;import com.hospital_os.utility.*;import com.hospital_os.object.*;import java.util.*;import java.sql.*;public class SiteDB{       private static String siteid = null;    public ConnectionInf theConnectionInf;    public Site dbObj;    final public String idtable = "246";    /**     * @param ConnectionInf db     * @roseuid 3F65897F0326     */    public SiteDB(ConnectionInf db)    {        theConnectionInf=db;        dbObj = new Site();        initConfig();    }    public  SiteDB()    {        theConnectionInf = null;        dbObj = new Site();        initConfig();    }    public boolean initConfig()    {        dbObj.table="b_site";        dbObj.pk_field="b_site_id";        dbObj.off_id   ="b_visit_office_id";        dbObj.off_name   ="site_name";        dbObj.full_name   ="site_full_name";        dbObj.address   ="site_house";        dbObj.village   ="site_moo";        dbObj.tambon   ="site_tambon";        dbObj.amphor   ="site_amphur";        dbObj.changwat   ="site_changwat";        dbObj.postcode   ="site_postcode";        dbObj.admin   ="site_admin_name";        dbObj.tel   ="site_phone_number";        dbObj.opd_type   ="f_opd_type_id";        dbObj.receipt_option   ="site_receipt_type";        dbObj.hn_for_drug_fund="site_drug_fund_id";        dbObj.server_image_reserve_name="server_image_reserve_name";        dbObj.local_folder_image_reserve_name="local_folder_image_reserve_name";        /*        dbObj.table = "site";        dbObj.pk_field = "site_id";        dbObj.off_id = "off_id";        dbObj.off_name = "off_name";        dbObj.full_name = "full_name";        dbObj.address = "address";        dbObj.village = "village";        dbObj.tambon = "tambon";        dbObj.amphor = "amphor";        dbObj.changwat = "changwat";        dbObj.postcode = "postcode";        dbObj.admin = "admin";        dbObj.tel = "tel";        dbObj.opd_type = "opd_type";        dbObj.receipt_option = "receipt_option";        dbObj.hn_for_drug_fund = "hn_for_drug_fund";         */        return true;    }            /**     * @param cmd     * @param o     * @return int     * @roseuid 3F6574DE0394     */    public int insert(Site o) throws Exception    {        String sql="";        Site p=o;        p.generateOID(idtable);        sql="insert into " + dbObj.table + " ("        + dbObj.pk_field        + " ,"	+ dbObj.off_id        + " ,"	+ dbObj.off_name        + " ,"	+ dbObj.full_name        + " ,"	+ dbObj.address        + " ,"	+ dbObj.village        + " ,"	+ dbObj.tambon        + " ,"	+ dbObj.amphor        + " ,"	+ dbObj.changwat        + " ,"	+ dbObj.postcode        + " ,"	+ dbObj.admin        + " ,"	+ dbObj.tel        + " ,"	+ dbObj.opd_type        + " ,"	+ dbObj.receipt_option        + " ,"	+ dbObj.hn_for_drug_fund        + " ) values ('"        + p.getObjectId()        + "','" + p.off_id        + "','" + p.off_name        + "','" + p.full_name        + "','" + p.address        + "','" + p.village        + "','" + p.tambon        + "','" + p.amphor        + "','" + p.changwat        + "','" + p.postcode        + "','" + p.admin        + "','" + p.tel        + "','" + p.opd_type        + "','" + p.receipt_option        + "','" + p.hn_for_drug_fund        + "')";                sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }    public int update(Site o) throws Exception    {        String sql="update " + dbObj.table + " set ";        Site p=o;        String field =""        + "', " + dbObj.off_id + "='" + p.off_id        + "', " + dbObj.off_name + "='" + p.off_name        + "', " + dbObj.full_name + "='" + p.full_name        + "', " + dbObj.address + "='" + p.address        + "', " + dbObj.village + "='" + p.village        + "', " + dbObj.tambon + "='" + p.tambon        + "', " + dbObj.amphor + "='" + p.amphor        + "', " + dbObj.changwat + "='" + p.changwat        + "', " + dbObj.postcode + "='" + p.postcode        + "', " + dbObj.admin + "='" + p.admin        + "', " + dbObj.tel + "='" + p.tel        + "', " + dbObj.opd_type + "='" + p.opd_type        + "', " + dbObj.receipt_option + "='" + p.receipt_option        + "', " + dbObj.hn_for_drug_fund + "='" + p.hn_for_drug_fund        +"'";                sql = Gutil.convertSQLToMySQL(sql+field.substring(2),theConnectionInf.gettypeDatabase());                return theConnectionInf.eUpdate(sql);    }        public int delete(Site o) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.pk_field + "='" + o.getObjectId() +"'";        return theConnectionInf.eUpdate(sql);    }        public Site selectByPK(String pk) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.pk_field        + " = '" + pk + "'";                Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (Site)v.get(0);    }        public Site selectAll() throws Exception    {          String sql ="select * from " + dbObj.table + " order by "+        dbObj.off_name;                Constant.println("sql===================: "+sql);                Vector v=eQuery(sql);                if(v.size()==0)            return null;        else            return (Site)v.get(0);            }        public String selectSiteOfficeID() throws Exception    {          String sql ="select * from " + dbObj.table + " order by "+        dbObj.off_name;                Vector v=eQuery(sql);                if(v.size()==0)            return "00000";        else            return ((Site)v.get(0)).off_id ;            }            /**     *@deprecated henbe unused     *     */        public Vector veQuery(String sql) throws Exception    {        ComboFix p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new ComboFix();            p.code = rs.getString(dbObj.pk_field);            p.name = rs.getString(dbObj.off_name);            list.add(p);        }        rs.close();        return list;    }            public Vector eQuery(String sql) throws Exception    {        Site p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new Site();            p.setObjectId(rs.getString(dbObj.pk_field));            p.off_id = rs.getString(dbObj.off_id);            p.off_name = rs.getString(dbObj.off_name);            p.full_name = rs.getString(dbObj.full_name);            p.address = rs.getString(dbObj.address);            p.village = rs.getString(dbObj.village);            p.tambon = rs.getString(dbObj.tambon);            p.amphor = rs.getString(dbObj.amphor);            p.changwat = rs.getString(dbObj.changwat);            p.postcode = rs.getString(dbObj.postcode);            p.admin = rs.getString(dbObj.admin);            p.tel = rs.getString(dbObj.tel);            p.opd_type = rs.getString(dbObj.opd_type);            p.receipt_option = rs.getString(dbObj.receipt_option);            p.hn_for_drug_fund = rs.getString(dbObj.hn_for_drug_fund);            p.server_image_reserve_name = rs.getString(dbObj.server_image_reserve_name);            p.local_folder_image_reserve_name = rs.getString(dbObj.local_folder_image_reserve_name);            list.add(p);        }        rs.close();        return list;    }            public static String getSiteID(ConnectionInf theConnectionInf)    {                       if(siteid == null)        {   SiteDB theSiteDB = new SiteDB(theConnectionInf);            try{                theConnectionInf.open();                siteid = theSiteDB.selectSiteOfficeID();                      }            catch(Exception ex)            {                ex.printStackTrace(Constant.getPrintStream());            //    siteid = "00000";            }                        theSiteDB = null;                   }               return siteid;    }}