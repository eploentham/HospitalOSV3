package com.hospital_os.objdb;import com.hospital_os.usecase.connection.*;import com.hospital_os.utility.*;import com.hospital_os.object.*;import java.util.*;import java.sql.*;public class LabResultItemDB{    public ConnectionInf theConnectionInf;    public LabResultItem dbObj;    final public String idtable = "177";    /**     * @param ConnectionInf db     * @roseuid 3F65897F0326     */    public LabResultItemDB(ConnectionInf db)    {        theConnectionInf=db;        dbObj = new LabResultItem();        initConfig();    }        public boolean initConfig()    {        dbObj.table="b_item_lab_result";        dbObj.pk_field="b_item_lab_result_id";        dbObj.lab_result_item_id   ="item_lab_result_number";        dbObj.name   ="item_lab_result_name";        dbObj.unit   ="item_lab_result_unit";        dbObj.item_id ="b_item_id";        dbObj.default_value = "item_lab_result_default";        dbObj.labresult_id = "item_lab_result_group_id";        dbObj.max = "item_lab_result_result_max";        dbObj.min = "item_lab_result_result_min";        dbObj.number = "item_lab_result_number";        dbObj.resultType = "f_lab_result_type_id";        dbObj.ncd_fbs = "item_ncd_fbs";        dbObj.ncd_hct = "item_ncd_hct";                return true;    }//    public boolean initConfig()//    {//        //        dbObj.table="b_item_lab_result";//        dbObj.pk_field="b_item_lab_result_id";//        dbObj.lab_result_item_id   ="item_lab_result_number";//        dbObj.name   ="item_lab_result_name";//        dbObj.unit   ="item_lab_result_unit";//        dbObj.item_id ="b_item_id";//        dbObj.default_value = "item_lab_result_default";//        /*//        dbObj.table = "lab_result_item";//        dbObj.pk_field = "key_id";//        dbObj.lab_result_item_id = "lab_result_item_id";//        dbObj.name = "name";//        dbObj.unit = "unit";//        dbObj.item_id = "item_id";//         *///        return true;//    }            /**     * @param cmd     * @param o     * @return int     * @roseuid 3F6574DE0394     */            public int insert(LabResultItem o) throws Exception     {        String sql="";        LabResultItem p=o;        p.generateOID(idtable);        sql="insert into " + dbObj.table + " ("        + dbObj.pk_field        + " ,"	+ dbObj.lab_result_item_id        + " ,"	+ dbObj.name        + " ,"	+ dbObj.labresult_id        + " ,"	+ dbObj.max        + " ,"	+ dbObj.min        //+ " ,"	+ dbObj2.number        + " ,"	+ dbObj.resultType        + " ,"	+ dbObj.unit        + " ,"	+ dbObj.item_id        + " ,"	+ dbObj.default_value        + " ,"	+ dbObj.ncd_fbs        + " ,"	+ dbObj.ncd_hct                    + " ) values ('"        + p.getObjectId()        + "','" + p.lab_result_item_id        + "','" + p.name        + "','" + p.labresult_id        + "','" + p.max        + "','" + p.min        //+ "','" + p.number        + "','" + p.resultType        + "','" + p.unit        + "','" + p.item_id        + "','" + p.default_value        + "','" + p.ncd_fbs          + "','" + p.ncd_hct                + "')";        sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());        int i = theConnectionInf.eUpdate(sql);                return  i ;    }                   public int update(LabResultItem o) throws Exception     {        String sql="update " + dbObj.table + " set ";        LabResultItem p=o;        String field =""        + "', " + dbObj.lab_result_item_id + "='" + p.lab_result_item_id        + "', " + dbObj.name + "='" + p.name        + "', " + dbObj.labresult_id + "='" + p.labresult_id        + "', " + dbObj.max + "='" + p.max        + "', " + dbObj.min + "='" + p.min        //+ "', " + dbObj2.number + "='" + p.number        + "', " + dbObj.resultType + "='" + p.resultType        + "', " + dbObj.unit + "='" + p.unit        + "', " + dbObj.item_id + "='" + p.item_id        + "', " + dbObj.default_value + "='" + p.default_value        + "', " + dbObj.ncd_fbs + "='" + p.ncd_fbs          + "', " + dbObj.ncd_hct + "='" + p.ncd_hct                  + "' where " + dbObj.pk_field + "='" + p.getObjectId() +"'";        sql = Gutil.convertSQLToMySQL(sql+field.substring(2),theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }//    public int insert(LabResultItem o) throws Exception//    {//        String sql="";//        LabResultItem p=o;//        p.generateOID(idtable);//        sql="insert into " + dbObj.table + " ("//        + dbObj.pk_field//        + " ,"	+ dbObj.lab_result_item_id//        + " ,"	+ dbObj.name//        + " ,"	+ dbObj.unit//        + " ,"	+ dbObj.item_id//        + " ) values ('"//        + p.getObjectId()//        + "','" + p.lab_result_item_id//        + "','" + p.name//        + "','" + p.unit//        + "','" + p.item_id//            //        + "')";//        sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());//        int i = theConnectionInf.eUpdate(sql);//        //        return  i ;//    }//    public int update(LabResultItem o) throws Exception//    {//        String sql="update " + dbObj.table + " set ";//        LabResultItem p=o;//        String field =""//        + "', " + dbObj.lab_result_item_id + "='" + p.lab_result_item_id//        + "', " + dbObj.name + "='" + p.name//        + "', " + dbObj.unit + "='" + p.unit//        + "', " + dbObj.item_id + "='" + p.item_id//        + "' where " + dbObj.pk_field + "='" + p.getObjectId() +"'";//        sql = Gutil.convertSQLToMySQL(sql+field.substring(2),theConnectionInf.gettypeDatabase());//        return theConnectionInf.eUpdate(sql);//    }           public int delete(LabResultItem o) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.pk_field + "='" + o.getObjectId() +"'";        return theConnectionInf.eUpdate(sql);    }         public int delete(String pk) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.pk_field + "='" + pk +"'";        return theConnectionInf.eUpdate(sql);    }        public LabResultItem selectByPK(String pk) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.pk_field        + " = '" + pk + "'";                Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (LabResultItem)v.get(0);    }        public LabResultItem selectByItemID(String item_id) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.item_id        + " = '" + item_id + "'";                        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (LabResultItem)v.get(0);    }        public Vector selectByItem(String pk) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.item_id        + " = '" + pk + "'";                Vector v=eQuery(sql);                if(v.size()==0)            return null;        else            return v;    }        public Vector selectAll() throws Exception    {        String sql="select * from " + dbObj.table;        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return v;    }    public Vector eQuery(String sql) throws Exception    {        LabResultItem p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new LabResultItem();            p.setObjectId(rs.getString(dbObj.pk_field));            p.lab_result_item_id = rs.getString(dbObj.lab_result_item_id);            p.name = rs.getString(dbObj.name);            p.labresult_id = rs.getString(dbObj.labresult_id);            p.max = rs.getString(dbObj.max);            p.min = rs.getString(dbObj.min);            p.number = rs.getString(dbObj.number);            p.resultType = rs.getString(dbObj.resultType);            p.unit = rs.getString(dbObj.unit);            p.item_id = rs.getString(dbObj.item_id);            p.default_value = rs.getString(dbObj.default_value);            p.ncd_fbs = rs.getString(dbObj.ncd_fbs);            p.ncd_hct = rs.getString(dbObj.ncd_hct);            list.add(p);        }        rs.close();        return list;    }//    public Vector eQuery(String sql) throws Exception//    {//        LabResultItem p;//        Vector list = new Vector();//        ResultSet rs = theConnectionInf.eQuery(sql);//        while(rs.next())//        {//            p = new LabResultItem();//            p.setObjectId(rs.getString(dbObj.pk_field));//            p.lab_result_item_id = rs.getString(dbObj.lab_result_item_id);//            p.name = rs.getString(dbObj.name);//            p.unit = rs.getString(dbObj.unit);//            p.item_id = rs.getString(dbObj.item_id);//            list.add(p);//        }//        rs.close();//        return list;//    }     public Vector selectByLabResultGroup(String labresult_id) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.labresult_id        + " = '" + labresult_id + "'";                Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return v;    }          public Vector selectByLabResultType(String resulttype_id) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.resultType        + " = '" + resulttype_id + "'";                Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return v;    }     }