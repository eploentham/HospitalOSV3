package com.hospital_os.objdb;import com.hospital_os.usecase.connection.*;import com.hospital_os.utility.*;import com.hospital_os.object.*;import java.util.*;import java.sql.*;public class PpDB{    public ConnectionInf theConnectionInf;    public Pp dbObj;    final public String idtable = "214";    /**     * @param ConnectionInf db     * @roseuid 3F65897F0326     */    public PpDB(ConnectionInf db)    {        theConnectionInf=db;        dbObj = new Pp();        initConfig();    }    public boolean initConfig()    {        dbObj.table = "t_health_pp";        dbObj.pk_field = "t_health_pp_id";        dbObj.t_health_delivery_id  = "t_health_delivery_id";        dbObj.t_patient_id   = "t_patient_id";        dbObj.health_pp_bweigth   = "health_pp_bweigth";        dbObj.health_pp_asphyxia   = "health_pp_asphyxia";        dbObj.health_pp_vitk   = "health_pp_vitk";        dbObj.health_pp_bresult   = "health_pp_bresult";                dbObj.health_pp_note  = "health_pp_note";        dbObj.t_patient_id_mother   = "t_patient_id_mother";        dbObj.health_pp_active   = "health_pp_active";        dbObj.health_pp_staff_record   = "health_pp_staff_record";        dbObj.health_pp_staff_cancel   = "health_pp_staff_cancel";        dbObj.health_pp_staff_modify  = "health_pp_staff_modify";        dbObj.health_pp_record_date_time   = "health_pp_record_date_time";        dbObj.health_pp_cancel_date_time   = "health_pp_cancel_date_time";        dbObj.health_pp_modify_date_time  = "health_pp_modify_date_time";        return true;    }            /**     * @param cmd     * @param o     * @return int     * @roseuid 3F6574DE0394     */    public int insert(Pp o) throws Exception    {        String sql="";        Pp p=o;        p.generateOID(idtable);        sql="insert into " + dbObj.table + " ("        + dbObj.pk_field        + " ,"	+ dbObj.t_health_delivery_id        + " ,"	+  dbObj.t_patient_id        + " ,"	+  dbObj.health_pp_bweigth        + " ,"	+  dbObj.health_pp_asphyxia        + " ,"	+  dbObj.health_pp_vitk        + " ,"	+  dbObj.health_pp_bresult                + " ,"	+  dbObj.health_pp_note        + " ,"	+  dbObj.t_patient_id_mother        + " ,"	+  dbObj.health_pp_active        + " ,"	+  dbObj.health_pp_staff_record        + " ,"	+  dbObj.health_pp_staff_cancel        + " ,"	+  dbObj.health_pp_staff_modify        + " ,"	+  dbObj.health_pp_record_date_time        + " ,"	+  dbObj.health_pp_cancel_date_time        + " ,"	+  dbObj.health_pp_modify_date_time        + " ) values ('"        + p.getObjectId()        + "','" + p.t_health_delivery_id        + "','" + p.t_patient_id        + "','" + p.health_pp_bweigth        + "','" + p.health_pp_asphyxia        + "','" + p.health_pp_vitk        + "','" + p.health_pp_bresult                + "','" + p.health_pp_note        + "','" + p.t_patient_id_mother        + "','" + p.health_pp_active        + "','" + p.health_pp_staff_record        + "','" + p.health_pp_staff_cancel        + "','" + p.health_pp_staff_modify        + "','" + p.health_pp_record_date_time        + "','" + p.health_pp_cancel_date_time        + "','" + p.health_pp_modify_date_time        + "')";        sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }        public Vector selectPatientIDbyMchID(String mch_id) throws Exception    {        String sql = "SELECT " + dbObj.t_patient_id + " FROM" +        " " + dbObj.table + " WHERE " + dbObj.t_health_delivery_id + "='" + mch_id + "'";        Vector vc = eQueryPatientID(sql);        if(vc.size() == 0)            return null;        else            return vc;    }        public int deletePpbyMchID(Pp o) throws Exception    {        String sql = "UPDATE " + dbObj.table + " SET" +        " " + dbObj.health_pp_active + "='" + Active.isDisable() + "' " +        "," + dbObj.health_pp_cancel_date_time + "='" + o.health_pp_cancel_date_time+ "'" +        "," + dbObj.health_pp_staff_cancel + "='" + o.health_pp_staff_cancel + "'" +        " WHERE " + dbObj.health_pp_active + "= '" + Active.isEnable() + "'" +        " AND " + dbObj.t_health_delivery_id + "= '" + o.t_health_delivery_id + "'" ;                        return theConnectionInf.eUpdate(sql);    }            public int update(Pp o) throws Exception    {        String sql="update " + dbObj.table + " set ";        Pp p=o;        String field =""        + "', " + dbObj.pk_field  + "='" + p.getObjectId()        + "', " + dbObj.t_health_delivery_id + "='" + p.t_health_delivery_id        + "', " + dbObj.t_patient_id + "='" + p.t_patient_id        + "', " + dbObj.health_pp_bweigth  + "='" + p.health_pp_bweigth        + "', " + dbObj.health_pp_asphyxia  + "='" + p.health_pp_asphyxia        + "', " + dbObj.health_pp_vitk   + "='" + p.health_pp_vitk        + "', " + dbObj.health_pp_bresult  + "='" + p.health_pp_bresult                + "', " + dbObj.health_pp_note  + "='" + p.health_pp_note        + "', " + dbObj.t_patient_id_mother + "='" + p.t_patient_id_mother        + "', " + dbObj.health_pp_active  + "='" + p.health_pp_active        + "', " + dbObj.health_pp_staff_record  + "='" + p.health_pp_staff_record        + "', " + dbObj.health_pp_staff_cancel  + "='" + p.health_pp_staff_cancel        + "', " + dbObj.health_pp_staff_modify  + "='" + p.health_pp_staff_modify        + "', " + dbObj.health_pp_record_date_time  + "='" + p.health_pp_record_date_time        + "', " + dbObj.health_pp_cancel_date_time + "='" + p.health_pp_cancel_date_time        + "', " + dbObj.health_pp_modify_date_time + "='" + p.health_pp_modify_date_time        + "' where " + dbObj.pk_field + "='" + p.getObjectId() +"'";        sql = Gutil.convertSQLToMySQL(sql+field.substring(2),theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }        public int delete(Pp o) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.pk_field + "='" + o.getObjectId() +"'";        return theConnectionInf.eUpdate(sql);    }        public Pp selectByPK(String pk) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.pk_field        + " = '" + pk + "'";        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (Pp)v.get(0);    }    public Vector selectFromMchID(String mch_id) throws Exception    {        String sql =  "SELECT * FROM " +dbObj.table + " Where " + dbObj.t_health_delivery_id + "" +        " ='" + mch_id + "' and " +  dbObj.health_pp_active + "='" + Active.isEnable() +"'";                Vector v = eQuery(sql);        if(v.size() == 0)            return null;        else            return v;    }        public Vector eQuery(String sql) throws Exception    {        Pp p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new Pp();                        p.setObjectId(rs.getString(dbObj.pk_field));            p.t_health_delivery_id = rs.getString(dbObj.t_health_delivery_id);            p.t_patient_id = rs.getString(dbObj.t_patient_id);            p.health_pp_bweigth = rs.getString(dbObj.health_pp_bweigth);            p.health_pp_asphyxia= rs.getString(dbObj.health_pp_asphyxia);            p.health_pp_vitk  = rs.getString(dbObj.health_pp_vitk);            p.health_pp_bresult = rs.getString(dbObj.health_pp_bresult);                        p.health_pp_note= rs.getString(dbObj.health_pp_note);            p.t_patient_id_mother= rs.getString(dbObj.t_patient_id_mother);            p.health_pp_active = rs.getString(dbObj.health_pp_active);            p.health_pp_staff_record  = rs.getString(dbObj.health_pp_staff_record);            p.health_pp_staff_cancel = rs.getString(dbObj.health_pp_staff_cancel);            p.health_pp_staff_modify = rs.getString(dbObj.health_pp_staff_modify);            p.health_pp_record_date_time = rs.getString(dbObj.health_pp_record_date_time);            p.health_pp_cancel_date_time  = rs.getString(dbObj.health_pp_cancel_date_time);            p.health_pp_modify_date_time= rs.getString(dbObj.health_pp_modify_date_time);            list.add(p);        }        rs.close();        return list;    }        public Vector eQueryPatientID(String sql) throws Exception    {                Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        Pp patient_id;        while(rs.next())        {            patient_id = new Pp();            patient_id.t_patient_id = rs.getString(dbObj.t_patient_id);            list.add(patient_id);            patient_id = null;        }        rs.close();        return list;    }}