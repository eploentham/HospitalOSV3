package com.hospital_os.objdb;import com.hospital_os.usecase.connection.*;import com.hospital_os.utility.*;import com.hospital_os.object.*;import java.util.*;import java.sql.*;public class GroupCronicDB{    public ConnectionInf theConnectionInf;    public GroupCronic dbObj;    final public String idtable = "165";    /**     * @param ConnectionInf db     * @roseuid 3F65897F0326     */    public GroupCronicDB(ConnectionInf db)    {        theConnectionInf=db;        dbObj = new GroupCronic();        initConfig();    }    public GroupCronicDB()    {        theConnectionInf = null;        dbObj = new GroupCronic();        initConfig();    }        public boolean initConfig()    {        Vector result = new Vector();                dbObj.table="b_group_chronic";        dbObj.pk_field="b_group_chronic_id";        dbObj.group_cronic_id    ="group_chronic_number";        dbObj.description_th     ="group_chronic_description_th";        dbObj.description_en     ="group_chronic_description_en";        dbObj.active ="group_chronic_active";         /*        dbObj.table = "groupcronic";        dbObj.pk_field = "key_id";                  dbObj.group_cronic_id="group_cronic_id";        dbObj.description_en = "description_en";        dbObj.description_th= "description_th";        dbObj.active ="active";          */                return true;    }        /**     * @param cmd     * @param o     * @return int     * @roseuid 3F6574DE0394     */        public int insert(GroupCronic o) throws Exception    {        String sql="";        GroupCronic p=o;        p.generateOID(idtable);        sql="insert into " + dbObj.table + " ("        +  dbObj.pk_field        + " ,"  +dbObj.group_cronic_id        + " ,"	+ dbObj.description_en        + " ,"	+ dbObj.description_th        + " ,"  + dbObj.active        + " ) values ('"        + p.getObjectId()        + "','" + p.group_cronic_id        + "','" + p.description_en        + "','" + p.description_th        + "','" + p.active        + "')";                sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }        public int update(GroupCronic o) throws Exception    {        String sql="";        GroupCronic p=o;        sql="update " + dbObj.table + " set "                + dbObj.group_cronic_id +"='" + p.group_cronic_id + "',"        + dbObj.description_th + "='" + p.description_th + "',"        + dbObj.description_en + "='" + p.description_en + "',"        + dbObj.active + "='" + p.active +"' where "        + dbObj.pk_field + "='" + p.getObjectId() + "'";        sql = Gutil.convertSQLToMySQL(sql,theConnectionInf.gettypeDatabase());        return theConnectionInf.eUpdate(sql);    }        public int delete(GroupCronic gc) throws Exception    {        String sql="delete from " + dbObj.table        + " where " + dbObj.pk_field + "='" + gc.getObjectId() +"'";        return theConnectionInf.eUpdate(sql);    }        public Vector selectByPk(String pk,String active)throws Exception    {                String sql="select * from " + dbObj.table        + " where " ;        if(pk.trim().length() !=0)        {                        sql= sql +"("+ dbObj.group_cronic_id + " like '%" + pk + "%') or ("            + dbObj.description_th  + " like '%" + pk + "%') or ("            + dbObj.description_en  + " like '%" + pk + "%') and ("            + dbObj.active + " = '" + active + "')";        }        else        {            sql= sql + dbObj.active + "='" + active +"'";        }                        Vector v=eQuery(sql);                if(v.size()==0)            return null;        else            return v;    }            public GroupCronic selectByKeyId(String pk) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.pk_field + " = '" + pk + "'";                        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (GroupCronic)v.get(0);    }            public GroupCronic selectByCode(String code) throws Exception    {        String sql="select * from " + dbObj.table        + " where " + dbObj.group_cronic_id + " = '" + code + "'";                        Vector v=eQuery(sql);        if(v.size()==0)            return null;        else            return (GroupCronic)v.get(0);    }            public Vector selectAll() throws Exception    {        String sql="select * from " + dbObj.table ;                Vector v=veQuery(sql);                if(v.size()==0)            return null;        else            return v;    }            public Vector eQuery(String sql) throws Exception    {        GroupCronic p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        int i=0;        while(rs.next())        {            p = new GroupCronic();            p.setObjectId(rs.getString(dbObj.pk_field));            p.group_cronic_id= rs.getString(dbObj.group_cronic_id);            p.description_en= rs.getString(dbObj.description_en);            p.description_th = rs.getString(dbObj.description_th);            p.active = rs.getString(dbObj.active);            list.add(p);            i++;            if(i>100) break;        }        rs.close();        return list;    }        public Vector veQuery(String sql) throws Exception    {        ComboFix p;        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql);        while(rs.next())        {            p = new ComboFix();            p.code = rs.getString(dbObj.pk_field);            p.name = rs.getString(dbObj.description_th);            list.add(p);        }        rs.close();        return list;    }        }