package com.hospital_os.objdb;import com.hospital_os.usecase.connection.*;import com.hospital_os.utility.*;import com.hospital_os.object.*;import java.util.*;import java.sql.*;public class AccidentDB{    public ConnectionInf theConnectionInf;    public Accident dbObj;    final private String idtable = "101";    /**     * @param ConnectionInf db     * @roseuid 3F65897F0326     */    public AccidentDB(ConnectionInf db)    {        theConnectionInf=db;        dbObj = new Accident();        initConfig();    }        public boolean initConfig()    {        dbObj.table = "t_accident";                dbObj.pk_field = "t_accident_id";        dbObj.hn ="accident_hn";        dbObj.vn_id = "t_visit_id";        dbObj.acctime = "accident_time";        dbObj.name_rd = "accident_road_name";        dbObj.acc_rd = "f_accident_road_type_id";        dbObj.in_out = "f_accident_highway_inout_type_id";        dbObj.kilo = "accident_kilo";        dbObj.accmu = "accident_moo";        dbObj.acctb = "f_address_id_accident_tambon";        dbObj.accam = "f_address_id_accident_amphur";        dbObj.acccw = "f_address_id_accident_changwat";        dbObj.ptstatus = "f_accident_patient_status_id";        dbObj.ptmobie = "f_accident_patient_vechicle_type_id";        dbObj.acc_use = "f_accident_victim_type_id";        dbObj.acc_alc = "accident_alcohol";        dbObj.acc_pro = "f_accident_protection_type_id";        dbObj.reporter = "accident_staff_record";        dbObj.date_accident ="accident_date";        dbObj.patient_id = "t_patient_id";        dbObj.vn = "accident_vn";        dbObj.accident_type = "accident_accident_type";        dbObj.occur_type = "accident_occur_type";        dbObj.emergency_type ="accident_emergency_type";        dbObj.cost_detail = "accident_cost_detail";        dbObj.hitch_constitution = "accident_hitch_constitution";        dbObj.claim_code = "accident_claim_code";        dbObj.to_hos_time = "accident_to_hos_date";        dbObj.to_hos_date = "accident_to_hos_time";        dbObj.staff_refer_patient = "accident_staff_refer_patient";        dbObj.staff_refer_patient_tel = "accident_staff_refer_patient_tel";        dbObj.staff_history_patient = "accident_staff_history_patient";        dbObj.staff_history_patient_tel = "accident_staff_history_patient_tel";        dbObj.proprietress_other= "accident_proprietress_other";        dbObj.proprietress_money= "accident_proprietress_money";        dbObj.proprietress_clock= "accident_proprietress_clock";        dbObj.proprietress_ring= "accident_proprietress_ring";        dbObj.proprietress_necklace= "accident_proprietress_necklace";        dbObj.b_setup_accident_type_id = "b_setup_accident_type_id";        dbObj.record_date_time = "accident_staff_record_date_time";        dbObj.staff_update = "accident_staff_update";        dbObj.update_date_time = "accident_update_date_time";        dbObj.staff_cancel = "accident_staff_cancel";        dbObj.cancel_date_time = "accident_cancel_date_time";        dbObj.active = "accident_active";        return true;    }    /*////////////////////////////////////////////////////////////////////////////////////*/    public int updatePatientByPatient(String old_id,String new_id)throws Exception    {           String sql = "Update " + dbObj.table + " set "        + dbObj.patient_id + " = '" + new_id + "',"        + dbObj.acc_rd + " = "+dbObj.staff_cancel+"||'-'||'" + old_id + "'"        + " where "        + dbObj.patient_id + " = '" + old_id +"'";        return theConnectionInf.eUpdate(sql.toString());    }        /**     * @param cmd     * @param o     * @return int     * @roseuid 3F6574DE0394     */    public int insert(Accident o) throws Exception    {        Accident p=o;        p.generateOID(idtable);        StringBuffer sql = new StringBuffer("insert into " ).append( dbObj.table ).append( " ("        ).append( dbObj.pk_field        ).append( " ,"  ).append( dbObj.hn        ).append( " ,"  ).append( dbObj.vn        ).append( " ,"	).append( dbObj.vn_id        ).append( " ,"	).append( dbObj.acctime        ).append( " ,"	).append( dbObj.name_rd        ).append( " ,"	).append( dbObj.acc_rd        ).append( " ,"	).append( dbObj.in_out        ).append( " ,"	).append( dbObj.kilo        ).append( " ,"	).append( dbObj.accmu        ).append( " ,"	).append( dbObj.acctb        ).append( " ,"	).append( dbObj.accam        ).append( " ,"	).append( dbObj.acccw        ).append( " ,"	).append( dbObj.ptstatus        ).append( " ,"	).append( dbObj.ptmobie        ).append( " ,"	).append( dbObj.acc_use        ).append( " ,"	).append( dbObj.acc_alc        ).append( " ,"	).append( dbObj.acc_pro        ).append( " ,"	).append( dbObj.reporter        ).append( " ,"  ).append( dbObj.date_accident        ).append( " ,"  ).append( dbObj.patient_id        ).append( " ,"	).append( dbObj.accident_type        ).append( " ,"	).append( dbObj.occur_type        ).append( " ,"	).append( dbObj.emergency_type        ).append( " ,"  ).append( dbObj.cost_detail        ).append( " ,"  ).append( dbObj.hitch_constitution        ).append( " ,"  ).append( dbObj.claim_code        ).append( " ,"  ).append( dbObj.to_hos_time        ).append( " ,"  ).append( dbObj.to_hos_date        ).append( " ,"  ).append( dbObj.staff_refer_patient        ).append( " ,"  ).append( dbObj.staff_refer_patient_tel        ).append( " ,"  ).append( dbObj.staff_history_patient        ).append( " ,"  ).append( dbObj.staff_history_patient_tel        ).append( " ,"  ).append( dbObj.proprietress_other        ).append( " ,"  ).append( dbObj.proprietress_money        ).append( " ,"  ).append( dbObj.proprietress_clock        ).append( " ,"  ).append( dbObj.proprietress_ring        ).append( " ,"  ).append( dbObj.proprietress_necklace        ).append( " ,"  ).append( dbObj.b_setup_accident_type_id        ).append( " ,"  ).append( dbObj.record_date_time        ).append( " ,"  ).append( dbObj.staff_update        ).append( " ,"  ).append( dbObj.update_date_time        ).append( " ,"  ).append( dbObj.staff_cancel        ).append( " ,"  ).append( dbObj.cancel_date_time        ).append( " ,"  ).append( dbObj.active        ).append( " ) values ('"        ).append( p.getObjectId()        ).append( "','" ).append( p.hn        ).append( "','" ).append( p.vn        ).append( "','" ).append( p.vn_id        ).append( "','" ).append( p.acctime        ).append( "','" ).append( p.name_rd        ).append( "','" ).append( p.acc_rd        ).append( "','" ).append( p.in_out        ).append( "','" ).append( p.kilo        ).append( "','" ).append( p.accmu        ).append( "','" ).append( p.acctb        ).append( "','" ).append( p.accam        ).append( "','" ).append( p.acccw        ).append( "','" ).append( p.ptstatus        ).append( "','" ).append( p.ptmobie        ).append( "','" ).append( p.acc_use        ).append( "','" ).append( p.acc_alc        ).append( "','" ).append( p.acc_pro        ).append( "','" ).append( p.reporter        ).append( "','" ).append( p.date_accident        ).append( "','" ).append( p.patient_id        ).append( "','" ).append( p.accident_type        ).append( "','" ).append( p.occur_type        ).append( "','" ).append( p.emergency_type        ).append( "','" ).append( p.cost_detail        ).append( "','" ).append( p.hitch_constitution        ).append( "','" ).append( p.claim_code        ).append( "','" ).append( p.to_hos_time        ).append( "','" ).append( p.to_hos_date        ).append( "','" ).append( p.staff_refer_patient        ).append( "','" ).append( p.staff_refer_patient_tel        ).append( "','" ).append( p.staff_history_patient        ).append( "','" ).append( p.staff_history_patient_tel        ).append( "','" ).append( p.proprietress_other        ).append( "','" ).append( p.proprietress_money        ).append( "','" ).append( p.proprietress_clock        ).append( "','" ).append( p.proprietress_ring        ).append( "','" ).append( p.proprietress_necklace        ).append( "','" ).append( p.b_setup_accident_type_id        ).append( "','" ).append( p.record_date_time        ).append( "','" ).append( p.staff_update        ).append( "','" ).append( p.update_date_time        ).append( "','" ).append( p.staff_cancel        ).append( "','" ).append( p.cancel_date_time        ).append( "','" ).append( p.active        ).append( "')");        return theConnectionInf.eUpdate(sql.toString());    }        /**     * @author henbe     * ??ä?????????? limit ?????????????????????????t???? out of memmory     */    public Vector selectByHnDate(String hn,String dateFrom ,String dateTo) throws Exception    {        Vector vc = new Vector();        StringBuffer sql;        if(hn.trim().length() !=0)        {            sql = new StringBuffer("select * from " ).append( dbObj.table            ).append( " where " ).append( dbObj.hn ).append( "='" ).append( hn ).append( "' and " ).append( dbObj.date_accident            ).append( " >= '" ).append( dateFrom ).append( "' and " ).append( dbObj.date_accident            ).append( " <= '" ).append( dateTo ).append( "'");        }        else        {            sql = new StringBuffer("select * from " ).append( dbObj.table            ).append( " where " ).append( dbObj.date_accident            ).append( " >= '" ).append( dateFrom ).append( "' and " ).append( dbObj.date_accident            ).append( " <= '" ).append( dateTo  ).append( "'");        }        sql.append( " and " ).append( dbObj.active ).append( "='1' limit 50");        return eQuery(sql.toString());    }            public int update(Accident p) throws Exception    {        StringBuffer sql = new StringBuffer("update " ).append( dbObj.table ).append( " set ")                .append( dbObj.hn ).append( "='" ).append( p.hn        ).append( "', " ).append( dbObj.vn ).append( "='" ).append( p.vn        ).append( "', " ).append( dbObj.vn_id ).append( "='" ).append( p.vn_id        ).append( "', " ).append( dbObj.acctime ).append( "='" ).append( p.acctime        ).append( "', " ).append( dbObj.name_rd ).append( "='" ).append( p.name_rd        ).append( "', " ).append( dbObj.acc_rd ).append( "='" ).append( p.acc_rd        ).append( "', " ).append( dbObj.in_out ).append( "='" ).append( p.in_out        ).append( "', " ).append( dbObj.kilo ).append( "='" ).append( p.kilo        ).append( "', " ).append( dbObj.accmu ).append( "='" ).append( p.accmu        ).append( "', " ).append( dbObj.acctb ).append( "='" ).append( p.acctb        ).append( "', " ).append( dbObj.accam ).append( "='" ).append( p.accam        ).append( "', " ).append( dbObj.acccw ).append( "='" ).append( p.acccw        ).append( "', " ).append( dbObj.ptstatus ).append( "='" ).append( p.ptstatus        ).append( "', " ).append( dbObj.ptmobie ).append( "='" ).append( p.ptmobie        ).append( "', " ).append( dbObj.acc_use ).append( "='" ).append( p.acc_use        ).append( "', " ).append( dbObj.acc_alc ).append( "='" ).append( p.acc_alc        ).append( "', " ).append( dbObj.acc_pro ).append( "='" ).append( p.acc_pro        ).append( "', " ).append( dbObj.reporter ).append( "='" ).append( p.reporter        ).append( "', " ).append( dbObj.date_accident ).append( "='" ).append( p.date_accident        ).append( "', " ).append( dbObj.patient_id ).append( "='" ).append( p.patient_id        ).append( "', " ).append( dbObj.accident_type ).append( "='" ).append( p.accident_type        ).append( "', " ).append( dbObj.occur_type ).append( "='" ).append( p.occur_type        ).append( "', " ).append( dbObj.emergency_type ).append( "='" ).append( p.emergency_type        ).append( "', " ).append( dbObj.cost_detail ).append( "='" ).append( p.cost_detail        ).append( "', " ).append( dbObj.hitch_constitution ).append( "='" ).append( p.hitch_constitution        ).append( "', " ).append( dbObj.claim_code ).append( "='" ).append( p.claim_code        ).append( "', " ).append( dbObj.to_hos_time ).append( "='" ).append( p.to_hos_time        ).append( "', " ).append( dbObj.to_hos_date ).append( "='" ).append( p.to_hos_date        ).append( "', " ).append( dbObj.staff_refer_patient ).append( "='" ).append( p.staff_refer_patient        ).append( "', " ).append( dbObj.staff_refer_patient_tel ).append( "='" ).append( p.staff_refer_patient_tel        ).append( "', " ).append( dbObj.staff_history_patient ).append( "='" ).append( p.staff_history_patient        ).append( "', " ).append( dbObj.staff_history_patient_tel ).append( "='" ).append( p.staff_history_patient_tel        ).append( "', " ).append( dbObj.proprietress_other ).append( "='" ).append( p.proprietress_other        ).append( "', " ).append( dbObj.proprietress_money ).append( "='" ).append( p.proprietress_money        ).append( "', " ).append( dbObj.proprietress_clock ).append( "='" ).append( p.proprietress_clock        ).append( "', " ).append( dbObj.proprietress_ring ).append( "='" ).append( p.proprietress_ring        ).append( "', " ).append( dbObj.proprietress_necklace ).append( "='" ).append( p.proprietress_necklace        ).append( "', " ).append( dbObj.b_setup_accident_type_id ).append( "='" ).append( p.b_setup_accident_type_id        ).append( "', " ).append( dbObj.record_date_time).append( "='" ).append( p.record_date_time        ).append( "', " ).append( dbObj.staff_update).append( "='" ).append( p.staff_update        ).append( "', " ).append( dbObj.update_date_time).append( "='" ).append( p.update_date_time        ).append( "', " ).append( dbObj.staff_cancel).append( "='" ).append( p.staff_cancel        ).append( "', " ).append( dbObj.cancel_date_time).append( "='" ).append( p.cancel_date_time        ).append( "', " ).append( dbObj.active).append( "='" ).append( p.active                ).append( "' where " ).append( dbObj.pk_field ).append( "='" ).append( p.getObjectId() ).append("'");                return theConnectionInf.eUpdate(sql.toString());    }        public int delete(Accident o) throws Exception    {        StringBuffer sql = new StringBuffer("UPDATE  " ).append( dbObj.table ).append( "" ).append(                " SET " ).append( dbObj.active ).append( " = '" ).append( o.active ).append( "'," ).append(                " " ).append( dbObj.staff_cancel ).append( " = '" ).append( o.staff_cancel ).append( "'," ).append(                " " ).append( dbObj.cancel_date_time ).append( " = '" ).append( o.cancel_date_time ).append( "' "        ).append( " where " ).append( dbObj.pk_field ).append( "='" ).append( o.getObjectId() ).append("'");        return theConnectionInf.eUpdate(sql.toString());    }        public Accident selectByPK(String pk) throws Exception    {        StringBuffer sql = new StringBuffer("select * from " ).append( dbObj.table        ).append( " where " ).append( dbObj.pk_field        ).append( " = '" ).append( pk ).append( "'");        Vector v=eQuery(sql.toString());        if(v.size()==0)            return null;        else            return (Accident)v.get(0);    }        public Accident selectByVN(String vn) throws Exception    {        StringBuffer sql = new StringBuffer("select * from " ).append( dbObj.table        ).append( " where " ).append( dbObj.vn        ).append( " = '" ).append( vn ).append( "'"        ).append( " and " ).append( dbObj.active ).append( "='1'");        Vector v=eQuery(sql.toString());        if(v.size()==0)            return null;        else            return (Accident)v.get(0);    }        public Vector selectByAll() throws Exception    {        StringBuffer sql = new StringBuffer("select * from " ).append( dbObj.table);        Vector v=eQuery(sql.toString());        if(v.size()==0)            return null;        else            return v;    }        public Vector eQuery(String sql) throws Exception    {        Vector list = new Vector();        ResultSet rs = theConnectionInf.eQuery(sql.toString());        while(rs.next()){            Accident p = rs2Object(rs);            list.add(p);        }        rs.close();        return list;    }    public Accident rs2Object(ResultSet rs)throws Exception     {            Accident p = new Accident();            p.setObjectId(rs.getString(dbObj.pk_field));            p.hn = rs.getString(dbObj.hn);            p.vn = rs.getString(dbObj.vn);            p.vn_id = rs.getString(dbObj.vn_id);            p.acctime = rs.getString(dbObj.acctime);            p.name_rd = rs.getString(dbObj.name_rd);            p.acc_rd = rs.getString(dbObj.acc_rd);            p.in_out = rs.getString(dbObj.in_out);            p.kilo = rs.getString(dbObj.kilo);            p.accmu = rs.getString(dbObj.accmu);            p.acctb = rs.getString(dbObj.acctb);            p.accam = rs.getString(dbObj.accam);            p.acccw = rs.getString(dbObj.acccw);            p.ptstatus = rs.getString(dbObj.ptstatus);            p.ptmobie = rs.getString(dbObj.ptmobie);            p.acc_use = rs.getString(dbObj.acc_use);            p.acc_alc = rs.getString(dbObj.acc_alc);            p.acc_pro = rs.getString(dbObj.acc_pro);            p.reporter = rs.getString(dbObj.reporter);            p.date_accident = rs.getString(dbObj.date_accident);            p.patient_id = rs.getString(dbObj.patient_id);            p.accident_type = rs.getString(dbObj.accident_type);            p.occur_type = rs.getString(dbObj.occur_type);            p.emergency_type = rs.getString(dbObj.emergency_type);            p.cost_detail = rs.getString(dbObj.cost_detail);            p.hitch_constitution = rs.getString(dbObj.hitch_constitution);            p.claim_code = rs.getString(dbObj.claim_code);            p.to_hos_time = rs.getString(dbObj.to_hos_time);            p.to_hos_date = rs.getString(dbObj.to_hos_date);            p.staff_refer_patient = rs.getString(dbObj.staff_refer_patient);            p.staff_refer_patient_tel = rs.getString(dbObj.staff_refer_patient_tel);            p.staff_history_patient = rs.getString(dbObj.staff_history_patient);            p.staff_history_patient_tel = rs.getString(dbObj.staff_history_patient_tel);            p.proprietress_other = rs.getString(dbObj.proprietress_other);            p.proprietress_money = rs.getString(dbObj.proprietress_money);            p.proprietress_clock = rs.getString(dbObj.proprietress_clock);            p.proprietress_ring = rs.getString(dbObj.proprietress_ring);            p.proprietress_necklace = rs.getString(dbObj.proprietress_necklace);            p.b_setup_accident_type_id = rs.getString(dbObj.b_setup_accident_type_id);            p.record_date_time = rs.getString(dbObj.record_date_time);            p.staff_update = rs.getString(dbObj.staff_update);            p.update_date_time = rs.getString(dbObj.update_date_time);            p.staff_cancel = rs.getString(dbObj.staff_cancel);            p.cancel_date_time = rs.getString(dbObj.cancel_date_time);            p.active = rs.getString(dbObj.active);            return p;    }    }