/*
 * PanelSetupReferHospital.java
 *
 * Created on 19 มิถุนายน 2549, 15:19 น.
 */

package com.reportnan.gui.panelsetup;

import com.reportnan.subject.ManageControlSubjectSetup;
import com.reportnan.utility.Language;
import com.reportnan.usecase.ManageGUI;
import com.reportnan.usecase.SaveNCDItemGroupMapItem;
import com.reportnan.utility.TableModelGUI;
import com.reportnan.object.NCDItemGroup;
import com.reportnan.object.NCDItemGroupMapItem;
import com.reportnan.gui.panel.DialogSearchItem;

import com.hospital_os.object.Item;

import java.util.*;
import javax.swing.*;
/**
 *
 * @author  ojika
 */
public class PanelSetupNCDItemGroup extends javax.swing.JPanel implements ManageGUI,SaveNCDItemGroupMapItem
{
    
    /** Creates new form PanelSetupReferHospital */
    ManageControlSubjectSetup theMCS;
    final String panelName = "SetupNCDItemGroup";
    String[] colNameGroup;
    String[] colNameItem;
    TableModelGUI theTableModelGUI;
    NCDItemGroup theNCDItemGroup;
    NCDItemGroupMapItem theNCDItemGroupMapItem;
    /**ใช้ตรวจสอบว่าข้อมูล item ที่เลือกสำหรับการเพิ่มนั้นมีอยู่ในข้อมูลเดิมหรือไม่*/
    int status = 1;    
    /** Vector ของกลุ่มรายการ NCD */
    Vector vNCDItemGroup;
    /** Vector ของรายการตรวจรักษา ของกลุ่มรายการ NCD */
    Vector vNCDItemGroupMapItem;
    
    public PanelSetupNCDItemGroup(ManageControlSubjectSetup mcs)
    {
        theMCS = mcs;
        initComponents();
        setLanguage();
        this.theMCS.theManageSubject.theNCDItemGroupMapItemSubject.registerMainReportManage(this);
        searchNCDItemGroup();
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel1 = new javax.swing.JPanel();
        jLabelPanelName = new javax.swing.JLabel();
        jPanel2 = new javax.swing.JPanel();
        jPanel7 = new javax.swing.JPanel();
        jLabelSearch = new javax.swing.JLabel();
        jTextFieldSearch = new javax.swing.JTextField();
        jButtonSearch = new javax.swing.JButton();
        jScrollPane1 = new javax.swing.JScrollPane();
        jTableNCDItemGroup = new javax.swing.JTable();
        jPanel3 = new javax.swing.JPanel();
        jPanel5 = new javax.swing.JPanel();
        jLabelCode = new javax.swing.JLabel();
        jTextFieldCode = new javax.swing.JTextField();
        jLabelDescription = new javax.swing.JLabel();
        jTextFieldDescription = new javax.swing.JTextField();
        jPanel4 = new javax.swing.JPanel();
        jButtonAdd = new javax.swing.JButton();
        jButtonDelete = new javax.swing.JButton();
        jPanel6 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTableNCDItemGroupMapItem = new javax.swing.JTable();

        setLayout(new java.awt.GridBagLayout());

        jPanel1.setLayout(new java.awt.GridBagLayout());

        jLabelPanelName.setFont(new java.awt.Font("Tahoma", 1, 14));
        jLabelPanelName.setText("SetupNCDItemGroup");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.weightx = 1.0;
        jPanel1.add(jLabelPanelName, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 3);
        add(jPanel1, gridBagConstraints);

        jPanel2.setLayout(new java.awt.GridBagLayout());

        jPanel2.setMinimumSize(new java.awt.Dimension(250, 25));
        jPanel2.setPreferredSize(new java.awt.Dimension(300, 433));
        jPanel7.setLayout(new java.awt.GridBagLayout());

        jLabelSearch.setText("Search");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        jPanel7.add(jLabelSearch, gridBagConstraints);

        jTextFieldSearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jTextFieldSearchActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 0);
        jPanel7.add(jTextFieldSearch, gridBagConstraints);

        jButtonSearch.setText("Search");
        jButtonSearch.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSearchActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 0);
        jPanel7.add(jButtonSearch, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 0, 0, 0);
        jPanel2.add(jPanel7, gridBagConstraints);

        jTableNCDItemGroup.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        jTableNCDItemGroup.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                jTableNCDItemGroupMouseReleased(evt);
            }
        });

        jScrollPane1.setViewportView(jTableNCDItemGroup);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 0, 0, 0);
        jPanel2.add(jScrollPane1, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.VERTICAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 3, 3, 0);
        add(jPanel2, gridBagConstraints);

        jPanel3.setLayout(new java.awt.GridBagLayout());

        jPanel5.setLayout(new java.awt.GridBagLayout());

        jLabelCode.setText("Code");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        jPanel5.add(jLabelCode, gridBagConstraints);

        jTextFieldCode.setEditable(false);
        jTextFieldCode.setPreferredSize(new java.awt.Dimension(100, 21));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 3);
        jPanel5.add(jTextFieldCode, gridBagConstraints);

        jLabelDescription.setText("Description");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 0, 0, 0);
        jPanel5.add(jLabelDescription, gridBagConstraints);

        jTextFieldDescription.setEditable(false);
        jTextFieldDescription.setPreferredSize(new java.awt.Dimension(100, 21));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 3);
        jPanel5.add(jTextFieldDescription, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanel3.add(jPanel5, gridBagConstraints);

        jPanel4.setLayout(new java.awt.GridBagLayout());

        jButtonAdd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/hosv3/gui/images/plus16.gif")));
        jButtonAdd.setMargin(new java.awt.Insets(0, 0, 0, 0));
        jButtonAdd.setMaximumSize(new java.awt.Dimension(24, 24));
        jButtonAdd.setMinimumSize(new java.awt.Dimension(24, 24));
        jButtonAdd.setPreferredSize(new java.awt.Dimension(24, 24));
        jButtonAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonAddActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        jPanel4.add(jButtonAdd, gridBagConstraints);

        jButtonDelete.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/hosv3/gui/images/minus16.gif")));
        jButtonDelete.setMargin(new java.awt.Insets(0, 0, 0, 0));
        jButtonDelete.setPreferredSize(new java.awt.Dimension(24, 24));
        jButtonDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonDeleteActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 0);
        jPanel4.add(jButtonDelete, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.SOUTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 3, 0);
        jPanel3.add(jPanel4, gridBagConstraints);

        jPanel6.setLayout(new java.awt.GridBagLayout());

        jTableNCDItemGroupMapItem.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {

            }
        ));
        jTableNCDItemGroupMapItem.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                jTableNCDItemGroupMapItemMouseReleased(evt);
            }
        });

        jScrollPane2.setViewportView(jTableNCDItemGroupMapItem);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 0, 3, 3);
        jPanel6.add(jScrollPane2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanel3.add(jPanel6, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 3, 3, 3);
        add(jPanel3, gridBagConstraints);

    }// </editor-fold>//GEN-END:initComponents

    private void jTableNCDItemGroupMapItemMouseReleased(java.awt.event.MouseEvent evt)//GEN-FIRST:event_jTableNCDItemGroupMapItemMouseReleased
    {//GEN-HEADEREND:event_jTableNCDItemGroupMapItemMouseReleased
        // เลือกรายการ Item ของกลุ่มรายการ NCD
        selectNCDItemGroupMapItem(jTableNCDItemGroupMapItem.getSelectedRow());
    }//GEN-LAST:event_jTableNCDItemGroupMapItemMouseReleased

    private void jButtonDeleteActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jButtonDeleteActionPerformed
    {//GEN-HEADEREND:event_jButtonDeleteActionPerformed
        // ลบรายการตรวจรักษาที่เลือก จากรายการของกลุ่มรายการ NCD
        int confirm_del = JOptionPane.showConfirmDialog(this,Language.getTextBundle("confirm_del_effect_report"),Language.getTextBundle("confirm_del"),JOptionPane.YES_NO_OPTION);
        if(confirm_del == 0)
        {
            deleteNCDItemGroupMapItem();
        }
        
    }//GEN-LAST:event_jButtonDeleteActionPerformed

    private void jButtonAddActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jButtonAddActionPerformed
    {//GEN-HEADEREND:event_jButtonAddActionPerformed
        // เรียก Dialog ของรายการ Item เพื่อนำมาบันทึกให้กับ กลุ่มรายการ NCD ที่เลือก 
        addNCDItemGroupMapItem();
    }//GEN-LAST:event_jButtonAddActionPerformed

    private void jTableNCDItemGroupMouseReleased(java.awt.event.MouseEvent evt)//GEN-FIRST:event_jTableNCDItemGroupMouseReleased
    {//GEN-HEADEREND:event_jTableNCDItemGroupMouseReleased
        // เลือกกลุ่มรายการ NCD
        selectNCDItemGroup(jTableNCDItemGroup.getSelectedRow());
    }//GEN-LAST:event_jTableNCDItemGroupMouseReleased

    private void jButtonSearchActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jButtonSearchActionPerformed
    {//GEN-HEADEREND:event_jButtonSearchActionPerformed
        // ค้นหากลุ่มรายการของ NCD
        searchNCDItemGroup();
    }//GEN-LAST:event_jButtonSearchActionPerformed

    private void jTextFieldSearchActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jTextFieldSearchActionPerformed
    {//GEN-HEADEREND:event_jTextFieldSearchActionPerformed
        // ค้นหากลุ่มรายการของ NCD โดยใช้ event ของปุ่ม search
        jButtonSearchActionPerformed(evt);
    }//GEN-LAST:event_jTextFieldSearchActionPerformed
    /**
     * ลบรายการตรวจรักษา ของกลุ่มรายการ NCD ที่เลือกออกจากฐานข้อมูล
     * @Author Ojika
     * @Date 21/06/2549
     **/
    private void deleteNCDItemGroupMapItem()
    {
        if(this.theNCDItemGroupMapItem != null)
        {
            // ส่งค่าของ Object ไปลบ
            this.theMCS.theManageControl.theNCDItemGroupControl.deleteNCDItemGroupMapItem(this.theNCDItemGroupMapItem.getObjectId()); 
            // แจ้งบอกสถานะการลบรายการ         
            
            // เรียกค้นหาอีกครั้ง
            searchNCDItemGroupMapItem(this.theNCDItemGroup.getObjectId());
        }        
    }    
    
    /**
     * สำหรับค้นหารายการตรวจรักษาของกลุ่มรายการ NCD และ ส่งข้อมูลไปแสดงในตาราง
     * @Author Ojika
     * @Date 21/06/2549
     **/
    private void searchNCDItemGroupMapItem(String NCDItemGroupId)
    {
        // ค้นหารายการ โดยส่ง keyword ไปค้น
        this.vNCDItemGroupMapItem = new Vector();
        
        this.vNCDItemGroupMapItem = this.theMCS.theManageControl.theNCDItemGroupControl.searchNCDItemGroupMapItemByNCDItemGroupId(this.theNCDItemGroup.getObjectId());
                
        // ส่งข้อมูลที่ได้จากการค้นหานั้นไปแสดงยังตาราง
        setTableNCDItemGroupMapItem(this.vNCDItemGroupMapItem);     
    }
    
    /**
     * เลือกรายการตรวจรักษากลุ่มรายการ NCD และ Set ค่าให้กับ Object ของรายการตรวจรักษา
     * @Author Ojika
     * @Date 21/06/2549
     **/
     private void selectNCDItemGroupMapItem(int row)
     {
        if(row > -1)
        {
            // มีการเลือกจากตาราง
            if(this.vNCDItemGroupMapItem != null)
            {                
                this.theNCDItemGroupMapItem = (NCDItemGroupMapItem)vNCDItemGroupMapItem.get(row);                
            }
        }
     }
     
    /**
     * แสดง Dialog สำหรับเลือก รายการตรวจรักษา
     * @Author Ojika
     * @Date 21/06/2549 
     **/
    private void addNCDItemGroupMapItem()
    {
        DialogSearchItem dialog = new DialogSearchItem(new JFrame(), true,this.theMCS, 1);
        dialog.show();
    }
    
    /**
     * เลือกกลุ่มรายการ NCD
     * @Author Ojika
     * @Date 21/06/2549
     **/
     private void selectNCDItemGroup(int row)
     {        
        if(row > -1)
        {
            this.vNCDItemGroupMapItem = null;
            // มีการเลือกจากตาราง
            if(this.vNCDItemGroup != null)
            {           
                this.theNCDItemGroup = (NCDItemGroup)vNCDItemGroup.get(row);
                // ดึงข้อมูล NCDItemGroupMapItem
                this.vNCDItemGroupMapItem = this.theMCS.theManageControl.theNCDItemGroupControl.searchNCDItemGroupMapItemByNCDItemGroupId(this.theNCDItemGroup.getObjectId());
                // แสดงรายละเอียดข้อมูล    
                setObjectToData();
            }
        }
     }
     
     /**
      * แสดงค่าจาก Object ให้กับ GUI
      * @Author Ojika
      * @Date 21/06/2549
      **/
     private void setObjectToData()
     {
        if(this.theNCDItemGroup != null)
        {
            jTextFieldCode.setText(this.theNCDItemGroup.ncd_item_group_number);
            jTextFieldDescription.setText(this.theNCDItemGroup.ncd_item_group_description);
            
            if(this.vNCDItemGroupMapItem != null && this.vNCDItemGroupMapItem.size() > 0)
            {
                // สั่ง Set ตาราง
                setTableNCDItemGroupMapItem(this.vNCDItemGroupMapItem);
            }
            else
            {
                setTableNCDItemGroupMapItem(null);
            }
        }
        else
        {
            clearGUI();
        }
     }
     
     /**
     * แสดงข้อมูลที่ได้จากการค้นหาในตาราง 
     * @author Ojika
     * @Date 21/06/2549
     **/
    private void setTableNCDItemGroupMapItem(Vector vData)
    {       
        theTableModelGUI = new TableModelGUI(colNameItem, 0);
        if(vData != null && vData.size() > 0)
        {
            int size = vData.size();
            theTableModelGUI = new TableModelGUI(colNameItem, size);
            theNCDItemGroupMapItem = null;
            for(int i = 0 ; i < size ;i++)
            {
                theNCDItemGroupMapItem = (NCDItemGroupMapItem)vData.get(i);
                theTableModelGUI.setValueAt(theNCDItemGroupMapItem.ncd_item_group_map_item_number,i, 0); 
                theTableModelGUI.setValueAt(theNCDItemGroupMapItem.ncd_item_group_map_item_description,i, 1);
                theNCDItemGroupMapItem = null;
            }
            
        }
        
        jTableNCDItemGroupMapItem.setModel(theTableModelGUI);
        
        jTableNCDItemGroupMapItem.getColumnModel().getColumn(0).setPreferredWidth(25);
        jTableNCDItemGroupMapItem.getColumnModel().getColumn(1).setPreferredWidth(100);
        
    }  
    
    /**
      * เคลียร์ข้อมูลบน Gui 
      * @Author Ojika
      * @Date 21/06/2549
      **/
     private void clearGUI()
     {
        jTextFieldCode.setText("");
        jTextFieldDescription.setText("");
        
        setTableNCDItemGroupMapItem(null);
     }   
     
    /**
     * สำหรับค้นหากลุ่มรายการ NCD เพื่อนำไปแสดงในตาราง
     * @Author ojika
     * @Date 20/06/2549
     **/
    private void searchNCDItemGroup()
    {
        // ค้นหารายการ โดยส่ง keyword ไปค้น
        this.vNCDItemGroup = new Vector();
        String keyword = jTextFieldSearch.getText().trim();
        
        this.vNCDItemGroup = this.theMCS.theManageControl.theNCDItemGroupControl.searchNCDItemGroupByKeyword(keyword);
        
        // ส่งข้อมูลที่ได้จากการค้นหานั้นไปแสดงยังตาราง
        setTableNCDItemGroup(this.vNCDItemGroup);
        
        this.vNCDItemGroupMapItem = null;
        clearGUI();
    }
    
    /**
     * แสดงข้อมูลกลุ่มรายการ NCD ที่ได้จากการค้นหาในตาราง
     * @author ojika
     * @Date 20/06/2549
     **/
    private void setTableNCDItemGroup(Vector vData)
    {
        theTableModelGUI = new TableModelGUI(colNameGroup, 0);
        if(vData != null)
        {
            int size = vData.size();
            theTableModelGUI = new TableModelGUI(colNameGroup, size);
            theNCDItemGroup = null;
            for(int i = 0 ; i < size ;i++)
            {
                theNCDItemGroup = (NCDItemGroup)vData.get(i);
                theTableModelGUI.setValueAt(theNCDItemGroup.ncd_item_group_number,i, 0);
                theTableModelGUI.setValueAt(theNCDItemGroup.ncd_item_group_description,i, 1);
                theNCDItemGroup = null;
            }
            
        }
        
        jTableNCDItemGroup.setModel(theTableModelGUI);
        
        jTableNCDItemGroup.getColumnModel().getColumn(0).setPreferredWidth(25);
        jTableNCDItemGroup.getColumnModel().getColumn(1).setPreferredWidth(100);
    }
    
    /**
     * set ภาษาให้กับ Gui
     */
    private void setLanguage()
    {
        colNameGroup = new String[] {Language.getTextBundle("Code"),Language.getTextBundle("Description")};
        colNameItem = new String[] {Language.getTextBundle("Code"),Language.getTextBundle("Description")};
        
        jLabelPanelName.setText(Language.getTextBundle(jLabelPanelName.getText()));
        jLabelSearch.setText(Language.getTextBundle(jLabelSearch.getText()));
        jButtonSearch.setText(Language.getTextBundle(jButtonSearch.getText()));
        jLabelCode.setText(Language.getTextBundle(jLabelCode.getText()));
        jLabelDescription.setText(Language.getTextBundle(jLabelDescription.getText()));
    }

    public String getPanelName()
    {
        return this.panelName;
    }

    public void setEnableButtonSetupPanel(boolean enabled)
    {
    }

    public void notifySaveNCDItemGroupMapItem(Vector vItem)
    {
        // ส่งค่า Vector Item จาก Dialog
        // บันทึกค่ารายการให้กับกลุ่มรายการของ NCD
        if(vItem != null && vItem.size() > 0)
        {
            if(this.theNCDItemGroup != null)
            {
                Item theItem = new Item();
                int size = vItem.size();
                for(int i =0;i<size;i++)
                {
                    theItem = (Item)vItem.get(i);
                    
                    this.theNCDItemGroupMapItem = new NCDItemGroupMapItem();
                    
                    this.theNCDItemGroupMapItem.r_ncd_item_group_id = this.theNCDItemGroup.getObjectId();
                    this.theNCDItemGroupMapItem.b_item_id = theItem.getObjectId();
                    this.theNCDItemGroupMapItem.ncd_item_group_map_item_number = theItem.item_id;
                    this.theNCDItemGroupMapItem.ncd_item_group_map_item_description = theItem.common_name;
                    
                    checkSameData(this.theNCDItemGroupMapItem);
                    this.theNCDItemGroupMapItem = null;
                    searchNCDItemGroupMapItem(this.theNCDItemGroup.getObjectId());
                }
                theItem = null;
            }
            else
            {
                JOptionPane.showMessageDialog(this,Language.getTextBundle("PleaseSelectNCDGroup"),Language.getTextBundle("Warning"),JOptionPane.WARNING_MESSAGE);
            }
        }
        
        //เรียก Function การค้นหาเพื่อเปลี่ยนข้อมูใหม่
        //searchNCDItemGroupMapItem(this.theNCDItemGroup.getObjectId());
    }
    
    /**
     * ตรวจสอบรายการที่มีอยู่แล้ว
     * @Author ojika
     * @Date 21/06/2549
     */
    private void checkSameData(NCDItemGroupMapItem theNCDItem)
    {
        if(this.vNCDItemGroupMapItem != null)
        {
            int size = this.vNCDItemGroupMapItem.size();
            if(size > 0)
            {
                for(int i =0;i<size;i++)
                {
                    if(!theNCDItem.b_item_id.equals(((NCDItemGroupMapItem)this.vNCDItemGroupMapItem.get(i)).b_item_id))
                    {
                        status = 1;
                    }
                    else
                    {
                        status = 0;
                        JOptionPane.showMessageDialog(this,Language.getTextBundle("Same_Item") + theNCDItem.ncd_item_group_map_item_description ,Language.getTextBundle("Warning"),JOptionPane.WARNING_MESSAGE);
                        break;
                    }
                }
                if(status != 0)
                {
                    // ไม่มีข้อมูลซ้ำส่งไปบันทึก
                    this.theMCS.theManageControl.theNCDItemGroupControl.saveNCDItemGroupMapItem(theNCDItem);
                }
            }
        }
        else
        {
            // ไม่มีข้อมูลสำหรับตรวจสอบส่งไปบันทึก
            this.theMCS.theManageControl.theNCDItemGroupControl.saveNCDItemGroupMapItem(theNCDItem);
        }
        
    }
    
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton jButtonAdd;
    private javax.swing.JButton jButtonDelete;
    private javax.swing.JButton jButtonSearch;
    private javax.swing.JLabel jLabelCode;
    private javax.swing.JLabel jLabelDescription;
    private javax.swing.JLabel jLabelPanelName;
    private javax.swing.JLabel jLabelSearch;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanel4;
    private javax.swing.JPanel jPanel5;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel jPanel7;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTable jTableNCDItemGroup;
    private javax.swing.JTable jTableNCDItemGroupMapItem;
    private javax.swing.JTextField jTextFieldCode;
    private javax.swing.JTextField jTextFieldDescription;
    private javax.swing.JTextField jTextFieldSearch;
    // End of variables declaration//GEN-END:variables
    
}
