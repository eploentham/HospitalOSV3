/*
 * PanelReportFile.java
 *
 * Created on 3 มิถุนายน 2549, 14:40 น.
 */

package com.reportnan.gui.panel;

import com.hospital_os.utility.ComboboxModel;
import com.hospital_os.utility.Gutil;
import com.reportnan.utility.Constant;
import com.reportnan.utility.Report;
import java.util.*;
import java.awt.*;

import javax.swing.*;

import com.reportnan.usecase.ShowPanelSelectResp;
import com.reportnan.usecase.MainReportResp;
import com.reportnan.subject.ManageControlSubject;
import com.reportnan.utility.DateUtil;
import com.reportnan.utility.Language;
/**
 *
 * @author  pu
 */
public class PanelReportFile extends javax.swing.JPanel implements ShowPanelSelectResp,MainReportResp
{
    public ManageControlSubject theMSC;
    MainReport theMainReport;
    ComboboxModel theComboboxModel;
    public String cur_path = System.getProperty("user.dir");
    private JFileChooser  chooser;
    private Report report ;
    private String cardname = "";
    private String cardname_old = "";
    private String fileType = "";
    private String oldPath = ".";
    private String select_path = "";
    private String startDate = "";
    private String endDate = "";
    private boolean isSelectBetweenDate = false;
    private boolean isProcessRunning = false;
    HashMap theHashMap;
    /** Creates new form PanelReportFile */
    public PanelReportFile(){ 
        initComponents();
    }
    public void setControl(ManageControlSubject msc)
    {
        theMSC = msc;
        theMSC.theManageSubject.theMainReportSubject.registerMainReportManage(this);
        theMSC.theManageSubject.theShowPanelSelectSubject.registerGUIManage(this);
        theMainReport = new MainReport(theMSC);
        
        setControlSubject();
        theComboboxModel = new ComboboxModel();
        initComboBox();
        setLanguage();
        getObjectReport();
        addCardReport();
        //setGuiForShowReport(320,60);        
    }
    
    public void setControlSubject()
    {
        System.out.println("--- Pass set connection");
        this.setEnableGUI(true);
    }
    
    /**ใช้ในการกำหนดให้ Combobox แสดงค่าเริ่มต้น*/
    public void initComboBox()
    {
        initReportName();
        initReportType();
    }
    
    public void getObjectReport()
    {
        theHashMap = Constant.Report;
    }   
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanelControl = new javax.swing.JPanel();
        jLabelReport = new javax.swing.JLabel();
        jLabelStartDate = new javax.swing.JLabel();
        jComboBoxReport = new javax.swing.JComboBox();
        jLabelType = new javax.swing.JLabel();
        jPanel3 = new javax.swing.JPanel();
        dateComboBoxStartDate = new com.hospital_os.utility.DateComboBox();
        dateComboBoxEndDate = new com.hospital_os.utility.DateComboBox();
        jLabelEndDate = new javax.swing.JLabel();
        jButtonView = new javax.swing.JButton();
        jComboBoxType = new javax.swing.JComboBox();
        jButtonSave = new javax.swing.JButton();
        jPanelDetail = new javax.swing.JPanel();

        setLayout(new java.awt.GridBagLayout());

        jPanelControl.setLayout(new java.awt.GridBagLayout());

        jLabelReport.setText("รูปแบบรายงาน");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanelControl.add(jLabelReport, gridBagConstraints);

        jLabelStartDate.setText("จากวันที่");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanelControl.add(jLabelStartDate, gridBagConstraints);

        jComboBoxReport.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBoxReportActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 6, 0, 3);
        jPanelControl.add(jComboBoxReport, gridBagConstraints);

        jLabelType.setText("ชนิดของไฟล์");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanelControl.add(jLabelType, gridBagConstraints);

        jPanel3.setLayout(new java.awt.GridBagLayout());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanel3.add(dateComboBoxStartDate, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanel3.add(dateComboBoxEndDate, gridBagConstraints);

        jLabelEndDate.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        jLabelEndDate.setText("ถึงวันที่");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanel3.add(jLabelEndDate, gridBagConstraints);

        jButtonView.setText("Query");
        jButtonView.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonViewActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanel3.add(jButtonView, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = java.awt.GridBagConstraints.REMAINDER;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 0);
        jPanelControl.add(jPanel3, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 0);
        jPanelControl.add(jComboBoxType, gridBagConstraints);

        jButtonSave.setText("Save");
        jButtonSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(3, 3, 0, 3);
        jPanelControl.add(jButtonSave, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 3);
        add(jPanelControl, gridBagConstraints);

        jPanelDetail.setLayout(new java.awt.CardLayout());
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 3);
        add(jPanelDetail, gridBagConstraints);
    }// </editor-fold>//GEN-END:initComponents

    private void jComboBoxReportActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jComboBoxReportActionPerformed
    {//GEN-HEADEREND:event_jComboBoxReportActionPerformed
        setShowPanel(jComboBoxReport.getSelectedIndex());
    }//GEN-LAST:event_jComboBoxReportActionPerformed
    
    private void jButtonViewActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jButtonViewActionPerformed
    {//GEN-HEADEREND:event_jButtonViewActionPerformed
        queryData();
    }//GEN-LAST:event_jButtonViewActionPerformed
    
    private void jButtonSaveActionPerformed(java.awt.event.ActionEvent evt)//GEN-FIRST:event_jButtonSaveActionPerformed
    {//GEN-HEADEREND:event_jButtonSaveActionPerformed
        if(this.setPathFileToSave())
        {
            this.setDataForSaveReport();
        }
    }//GEN-LAST:event_jButtonSaveActionPerformed
        /**
     *แสดงรายงาน จากการเลือกจาก ComboBox
     */
    public void setShowPanel(int select)
    {
        //ตรวจสอบลำดับต้องมากกว่า -1
        if(select > -1)
        {   //ตรวจสอบ hashmap มีค่าข้อมูลหรือไม่
            if(theHashMap != null)
            {
                //ให้ค่ากับ object report
                this.report = (Report)theHashMap.get(String.valueOf(select+1));  
                
                if(this.report.INDEX.equals(Integer.toString(select+1)))
               {
                   System.out.println("SelectedIndex : " + this.report.INDEX);
                   this.cardname = this.report.ENG_NAME;
                   
                   if(!this.cardname.equalsIgnoreCase(cardname_old))
                    {
                        this.cardname_old = this.cardname;
                        setEnableSaveToFile(false);
                    }
                   this.theMSC.theManageSubject.theAllPanelSubject.notifySetInitAllGUI();
                   this.showCardReport(this.cardname);
               }
            }
        }          
        
    }
    
    private String getNameEngReport(int i)
    {
        report = (Report)Constant.Report.get(String.valueOf(i+1));
        return report.ENG_NAME;
    }
    /**
     *เพิ่มแถบการออกรายงาน
     *
     */
    public void addCardReport()
    {
        jPanelDetail.add(theMainReport.thePanelResident,theMainReport.thePanelResident.getCardName());
        jPanelDetail.add(theMainReport.thePanelPatientInClinic,theMainReport.thePanelPatientInClinic.getCardName());
        jPanelDetail.add(theMainReport.thePanelPatientOPDRemain,theMainReport.thePanelPatientOPDRemain.getCardName());
        jPanelDetail.add(theMainReport.thePanelAccident19Cause,theMainReport.thePanelAccident19Cause.getCardName());
        jPanelDetail.add(theMainReport.thePanelEmergencyPatient,theMainReport.thePanelEmergencyPatient.getCardName());
        jPanelDetail.add(theMainReport.thePanelPatientOperated,theMainReport.thePanelPatientOperated.getCardName());        
        jPanelDetail.add(theMainReport.thePanelDailyOPDPatient,theMainReport.thePanelDailyOPDPatient.getCardName());
        jPanelDetail.add(theMainReport.thePanelIPDPatient,theMainReport.thePanelIPDPatient.getCardName());
        jPanelDetail.add(theMainReport.thePanel505INClinic,theMainReport.thePanel505INClinic.getCardName());
        jPanelDetail.add(theMainReport.thePanelPatientNCD,theMainReport.thePanelPatientNCD.getCardName());
    }
    
    private void setGuiForShowReport(int x,int y)
    {
        this.jPanelControl.setPreferredSize(new java.awt.Dimension(x, y));
        this.jPanelControl.setMinimumSize(new java.awt.Dimension(x, y));
    }
    
    /**ใช้ในการ Query ข้อมูล และส่งข้อมูลไปยัง รายงานที่เลือกไว้*/
    public void queryData()
    {
        if(checkData())
        {
            int rowReport = jComboBoxReport.getSelectedIndex();
            System.out.println("Select name Report : " +getNameEngReport(rowReport));
          
            if(theMainReport.thePanelResident.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanelResident.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());
            }  
            else if(theMainReport.thePanelPatientInClinic.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanelPatientInClinic.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());
            }
            else if(theMainReport.thePanelPatientOPDRemain.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanelPatientOPDRemain.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());
            }
            else if(theMainReport.thePanelAccident19Cause.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanelAccident19Cause.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());
            }
            else if(theMainReport.thePanelEmergencyPatient.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanelEmergencyPatient.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());
            }
            else if(theMainReport.thePanelPatientOperated.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanelPatientOperated.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());
            }
            else if(theMainReport.thePanelDailyOPDPatient.getCardName().equalsIgnoreCase(getNameEngReport(rowReport))) 
            {
                theMainReport.thePanelDailyOPDPatient.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());  
            }
            else if(theMainReport.thePanelIPDPatient.getCardName().equalsIgnoreCase(getNameEngReport(rowReport))) 
            {
                theMainReport.thePanelIPDPatient.setQueryReport(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());  
            }
            else if(theMainReport.thePanel505INClinic.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanel505INClinic.setQueryReport(dateComboBoxStartDate.getText(), dateComboBoxEndDate.getText());
            }
            else if(theMainReport.thePanelPatientNCD.getCardName().equalsIgnoreCase(getNameEngReport(rowReport)))
            {
                theMainReport.thePanelPatientNCD.setQueryReport(dateComboBoxStartDate.getText(), dateComboBoxEndDate.getText());
            }
        }
        else
        {
            JOptionPane.showMessageDialog(this,Language.getTextBundle("TimeWarning"),Language.getTextBundle("Warning"),JOptionPane.WARNING_MESSAGE);
            
        }
    }
    
    /**
     *  ใช้ในการตรวจสอบค่าของข้อมูลต่างๆว่าถูกต้องตามความต้องการหรือไม่
     *  @return boolean ถ้าเป็น true จะไม่มี่ปัญหากับข้อมูล ถ้าเป็น false จะมีปัญหากับข้อมูล
     */
    private boolean checkData()
    {
        boolean result = false;
        result = this.isBetweenDateFormat();
        return result;
    }
    
     /*
      *  ใช้ในการตรวจสอบวันที่สำหรับการออกรายงาน ให้อยู่ในรูปแบบที่ถูกต้อง คือ วันที่เริ่มต้นในการ query
      *  ต้องไม่เป็นวันที่ในอนาคต หรือเป็นวันที่มากกว่าวันที่ถูกระบุว่าเป็นวันที่สิ้นสุดของการ query
      *  @return boolean ถ้าค่าเป็น true แสดงว่าเป็บช่วงวันที่ที่ถูกต้อง ถ้าเป็น false แสดงว่าเป็นช่วงวันที่ไม่ถูกต้อง
      */
    private boolean isBetweenDateFormat()
    {
        setBetweenDate(dateComboBoxStartDate.getText(),dateComboBoxEndDate.getText());
        if(Gutil.beforDate(DateUtil.getDateFromText(this.startDate),DateUtil.getDateFromText(this.endDate)) || (this.startDate.compareTo(this.endDate) <= 0))
        {
            isSelectBetweenDate = true;
        }
        else
        {
            isSelectBetweenDate = false;
        }
        return isSelectBetweenDate;
    }
      /*
       *กำหนดค่าให้กับตัวแปรวันที่เริ่มต้น และวันที่สิ้นสุด ในการนำมา query
       *@param startDate วันที่เริ่มต้น
       *@param endDate วันที่สิ้นสุด
       */
    private  void setBetweenDate(String startDate,String endDate)
    {
        this.startDate = startDate;
        this.endDate = endDate;
    }
    public boolean setPathFileToSave()
    {
        boolean isSetPathFileDone = false;
        chooser = new JFileChooser();
        chooser.setCurrentDirectory(new java.io.File(oldPath));
        chooser.setDialogTitle(Language.getTextBundle("PleaseSelectPathForSave"));
        
        chooser.setFileSelectionMode(JFileChooser.DIRECTORIES_ONLY);
        chooser.setApproveButtonText("Save");
        if (chooser.showOpenDialog(this) == JFileChooser.APPROVE_OPTION)
        {
            int index = jComboBoxType.getSelectedIndex();
            if(index == 0)
            {
                setFileType(Constant.TXT_FILE);
            }
            else if(index == 1)
            {
                setFileType(Constant.XLS_FILE);
            }
            else if(index == 2)
            {
                setFileType(Constant.DBF_FILE);
            }
            oldPath = chooser.getSelectedFile().getPath();
            select_path =  chooser.getSelectedFile().getPath()+"\\";
            isSetPathFileDone = true;
        }
        else
        {
            isSetPathFileDone = false;
        }
        return isSetPathFileDone;
    }
    /**
     *เซ็ตข้อมูลสำหรับบันทึกเป็นไฟล์
     */
    public void setDataForSaveReport()
    {
        if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelResident.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelResident.getResident();
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME);
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelPatientInClinic.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelPatientInClinic.getPatientInClinic();
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME);
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelPatientOPDRemain.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelPatientOPDRemain.getPatientOPDRemain(); 
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME);
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelAccident19Cause.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelAccident19Cause.getAccident19Cause();
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME);
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelEmergencyPatient.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelEmergencyPatient.getEmergencyPatient(); 
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME);
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelPatientOperated.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelPatientOperated.getPatientOperated();
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME);
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelDailyOPDPatient.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelDailyOPDPatient.getDailyOPDPatient(); 
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME + this.theMainReport.thePanelDailyOPDPatient.getNameReport());
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelIPDPatient.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelIPDPatient.getIPDPatient(); 
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME + this.theMainReport.thePanelIPDPatient.getNameReport());
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanel505INClinic.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanel505INClinic.get505INClinic();
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME);
        }
        else if(this.cardname.equalsIgnoreCase(this.theMainReport.thePanelPatientNCD.getCardName()))
        {
            Vector vcData = this.theMainReport.thePanelPatientNCD.getPatientNCD();
            this.theMSC.theManageControl.theExportControl.startExportByVector(vcData,this.select_path,this.fileType,this.report.ENG_NAME + this.theMainReport.thePanelPatientNCD.getNameReport());
        }
    }
    
    private void setFileType(String fileType)
    {
        this.fileType = fileType;
    }
    /*
     *ใช้ในการกลับไปยังหน้า MainReport
     *เพื่อเลือกรายงานทั่วไป
     */
    public void  backToMainReport()
    {
        theMSC.theManageSubject.theShowPanelSelectSubject.notifyCallBackToMainReport();
    }
    
    /**
     *  กำหนดค่าของ Combobox รายงานแสดงชื่อรายงาน
     */
    private void initReportName()
    {
        for(int i=0;i<Constant.Report.size();i++)
        {   report = (Report)Constant.Report.get(String.valueOf(i+1));
            jComboBoxReport.addItem(report.THAI_NAME);
            report = null;
        }
        report = null;
    }
    
    /**
     *  กำหนดค่าของ Combobox บันทึก
     */
    private void initReportType()
    {
        for(int j=0;j<Constant.REPORT_TYPE.length;j++)
        {
            jComboBoxType.addItem(Constant.REPORT_TYPE[j]);
        }
    }
    
    public void showCardReport(String cardname)
    {
        CardLayout layout = (CardLayout)this.jPanelDetail.getLayout();
        layout.show(this.jPanelDetail, cardname);
    }
    
    public void setEnableGUI(boolean isEnable)
    {
        jComboBoxReport.setEnabled(isEnable);
    }
    
    /**
     *  ใช้ในการกำหนดให้ การบันทึกสามารถทำงานได้หรือไม่
     *  @param isEnable เป็น boolean ที่ใช้ในการกำหนดให้แสดงหรือไม่แสดง
     *
     */
    public void setEnableSaveToFile(boolean isEnable)
    {
        jComboBoxType.setEnabled(isEnable);
        jButtonSave.setEnabled(isEnable);
    }
    
    /**ใช้ในการกำหนดค่าวันที่เริ่มต้นและวันที่สิ้นสุดให้กับ combobox
     *  @param startDate เป็น String ของ วันที่เริ่มต้น รูปแบบ เป็น yyyy-mm-dd
     *  @param finishDate เป็น String ของ วันที่สิ้นสุด รูปแบบ เป็น yyyy-mm-dd
     */
    private void setDateCombobox(String startDate,String finishDate)
    {
        dateComboBoxStartDate.setText(DateUtil.getGuiDateTime(startDate));
        dateComboBoxEndDate.setText(DateUtil.getGuiDateTime(finishDate));
    }
    
    /**ใช้ในการ แสดงรายงานใน Combobox ตาม param ที่ส่งเข้ามา
     *  @param report เป็น Object ของ Report
     */
    private void setShowReport(Report report)
    {
        jComboBoxReport.setSelectedItem(report.THAI_NAME);
        this.cardname = report.ENG_NAME;
        this.showCardReport(this.cardname);
        
    }
    private void clearGUI()
    {
        
    }
    
    public static void setFrame(int width ,int height)
    {
        ManageControlSubject hosManage = new ManageControlSubject(null);
        PanelReportFile thePanelReport18File= new PanelReportFile();
        thePanelReport18File.setControl(hosManage);
        thePanelReport18File.setSize(500, 400);
        JFrame frm = new JFrame("PanelReportStandard");
        Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        //thePanelReport18File.setSize(screenSize);
        frm.setSize(width, height);
        frm.setLocation((screenSize.width-frm.getSize().width)/2,(screenSize.height-frm.getSize().height)/2);
        //frm.setDefaultCloseOperation(javax.swing.JFrame.DISPOSE_ON_CLOSE);
        //frm.setVisible(true);
        
        
        frm.getContentPane().add(thePanelReport18File);
        frm.pack();
        frm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frm.setVisible(true);
    }
    
    public void notifyCallBackToMainReport()
    {
        
    }
    
    public void notifyCallReportShow(Report report)
    {
        this.report = report;
        setShowReport(report);
        setEnableSaveToFile(false);
    }
    
    public void notifyReturnStartAndFinishDate(String startDate, String finishDate)
    {
        setDateCombobox(startDate, finishDate);
    }
    
    public void notifyShowSaveToFile(boolean show)
    {
        setEnableSaveToFile(show);
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.hospital_os.utility.DateComboBox dateComboBoxEndDate;
    private com.hospital_os.utility.DateComboBox dateComboBoxStartDate;
    private javax.swing.JButton jButtonSave;
    private javax.swing.JButton jButtonView;
    private javax.swing.JComboBox jComboBoxReport;
    private javax.swing.JComboBox jComboBoxType;
    private javax.swing.JLabel jLabelEndDate;
    private javax.swing.JLabel jLabelReport;
    private javax.swing.JLabel jLabelStartDate;
    private javax.swing.JLabel jLabelType;
    private javax.swing.JPanel jPanel3;
    private javax.swing.JPanel jPanelControl;
    private javax.swing.JPanel jPanelDetail;
    // End of variables declaration//GEN-END:variables
    public void setLanguage()
    {
        jLabelReport.setText(Language.getTextBundle(jLabelReport.getText()));
        jLabelStartDate.setText(Language.getTextBundle(jLabelStartDate.getText()));
        jLabelType.setText(Language.getTextBundle(jLabelType.getText()));
        jLabelEndDate.setText(Language.getTextBundle(jLabelEndDate.getText()));
        jButtonSave.setText(Language.getTextBundle(jButtonSave.getText()));
        jButtonView.setText(Language.getTextBundle(jButtonView.getText()));
    }
}
