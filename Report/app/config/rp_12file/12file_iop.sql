SELECT 	t_visit.visit_vn AS AN  	, t_diag_icd9.diag_icd9_icd9_number AS OPER  	, t_diag_icd9.f_diagnosis_operation_type_id AS OPTYPE  	, b_employee.employee_number AS DROP  	, CASE WHEN (length(t_diag_icd9.diag_icd9_start_time)>=10)then to_char(to_date(to_number(substr(t_diag_icd9.diag_icd9_start_time,1,4),'9999')-543 || substr(t_diag_icd9.diag_icd9_start_time,5,6),'yyyy-mm-dd'),'yyyymmdd')                     ELSE ''   END AS DATEIN  	, CASE  WHEN (Length(t_diag_icd9.diag_icd9_start_time) >=16 )  		THEN replace(substring(t_diag_icd9.diag_icd9_start_time from 12 for 5 ),':','') 		ELSE '' END AS TIMEIN  	, CASE WHEN (length(t_diag_icd9.diag_icd9_finish_time)>=10)then to_char(to_date(to_number(substr(t_diag_icd9.diag_icd9_finish_time,1,4),'9999')-543 || substr(t_diag_icd9.diag_icd9_finish_time,5,6),'yyyy-mm-dd'),'yyyymmdd')                     ELSE ''   END AS DATEOUT 	, CASE  WHEN (Length(t_diag_icd9.diag_icd9_finish_time) >=16 )  		THEN replace(substring(t_diag_icd9.diag_icd9_finish_time from 12 for 5 ),':','') 		ELSE '' END AS TIMEOUT   FROM  	t_diag_icd9  	INNER JOIN t_visit ON (t_diag_icd9.diag_icd9_vn = t_visit.t_visit_id )  	LEFT JOIN b_employee ON (t_diag_icd9.diag_icd9_staff_doctor = b_employee.b_employee_id)WHERE   t_visit.f_visit_type_id = '1'  	AND t_visit.f_visit_status_id <> '4'  	AND t_diag_icd9.diag_icd9_active = '1'         AND substring(t_visit.visit_staff_doctor_discharge_date_time,1,10) >= ?       AND substring(t_visit.visit_staff_doctor_discharge_date_time,1,10) <= ?ORDER BY AN