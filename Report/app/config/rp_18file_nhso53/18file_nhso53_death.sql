--death_53SELECT 	b_site.b_visit_office_id AS PCUCODE  --NOT NULL	,t_health_family.patient_pid AS CID     ,t_health_family.health_family_hn_hcis as PID --NOT NULL	,CASE 		WHEN length( t_death.death_date_time) > 11   			THEN  (to_number(substring(t_death.death_date_time,1,4),'9999')-543)       				|| substring(t_death.death_date_time,6,2)       				|| substring(t_death.death_date_time,9,2) 		ELSE '' END AS DDEATH 	, substring(cdeath_a.icd10_number,1,3) || substring(cdeath_a.icd10_number,5,3)  as CDEATH_A	, substring(cdeath_b.icd10_number,1,3) || substring(cdeath_b.icd10_number,5,3) as CDEATH_B	, substring(cdeath_c.icd10_number,1,3) || substring(cdeath_c.icd10_number,5,3) as CDEATH_C	, substring(cdeath_d.icd10_number,1,3) || substring(cdeath_d.icd10_number,5,3) as CDEATH_D 	, substring(t_death.death_external_cause_of_injury,1,3) || substring(t_death.death_external_cause_of_injury,5,3) AS ODISEASE 	, substring(t_death.death_cause,1,3) || substring(t_death.death_cause,5,3) AS CDEATH	, t_death.death_site AS PDEATH 	, CASE when length(t_death.death_date_time)=16                then (to_number(substring(t_death.death_date_time,1,4),'9999') - 543)                              || substring(t_death.death_date_time,6,2)                              || substring(t_death.death_date_time,9,2)                         || substring(t_death.death_date_time,12,2)                         || substring(t_death.death_date_time,15,2)                   --      || substring(t_death.death_date_time,18,2)                         || '00'                when length(t_death.death_date_time)=19                then (to_number(substring(t_death.death_date_time,1,4),'9999') - 543)                              || substring(t_death.death_date_time,6,2)                              || substring(t_death.death_date_time,9,2)                         || substring(t_death.death_date_time,12,2)                         || substring(t_death.death_date_time,15,2)                         || substring(t_death.death_date_time,18,2)  		ELSE ''  END AS D_UPDATE    --NOT NULLFROM  t_death     INNER JOIN  t_health_family ON t_health_family.t_health_family_id = t_death.t_health_family_id     LEFT JOIN b_icd10 as cdeath_a on t_death.death_primary_diagnosis = cdeath_a.b_icd10_id    LEFT JOIN b_icd10 as cdeath_b on t_death.death_comorbidity = cdeath_b.b_icd10_id    LEFT JOIN b_icd10 as cdeath_c on t_death.death_complication = cdeath_c.b_icd10_id    LEFT JOIN b_icd10 as cdeath_d on t_death.death_others = cdeath_d.b_icd10_id	,b_siteWHERE  t_death.death_active = '1'             AND health_family_active = '1'   --    AND substring(t_death.death_date_time,1,10) >= '2551-01-01'--	AND substring(t_death.death_date_time,1,10) <= '2552-09-30'	AND substring(t_death.death_date_time,1,10) >= ?	AND substring(t_death.death_date_time,1,10) <= ?