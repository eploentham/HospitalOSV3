/*
 * PanelExercise.java
 *
 * Created on 7 เมษายน 2549, 9:23 น.
 */

package com.healthy.gui.panel;

import com.healthy.object.ExerciseType;
import com.hosv3.utility.DateUtil;
import com.hosv3.utility.connection.UpdateStatus;
import com.pcu.control.HtControl;
import com.pcu.utility.GutilPCU;
import java.util.*;
import javax.swing.*;
import com.healthy.object.*;
import com.hospital_os.utility.*;
import com.pcu.object.*;
import java.awt.*;

/**
 *
 * @author  hospitalos5 */
public class PanelExercise extends javax.swing.JPanel {
    public Vector theExerciseV;
    public Exercise theExercise;
    public HtControl theHtControl;
    public Family theFamily;
    JDialog jDialog;

    private UpdateStatus theUS;
       
    /** Creates new form PanelExercise */
    public PanelExercise() {
        initComponents();
        theExercise = new Exercise();
        setDisable();
        setLanguage();
    }
    
    public void setControl(HtControl ht,UpdateStatus us){
         theUS = us;
        theHtControl = ht;
        this.jTextFieldYearBudget.setText(theHtControl.getYear());
        this.dateComboBox1.setEditable(true);
        setLanguage();
    }
    
    public void updateOGExercise(Vector v) {
        theExerciseV = v;
        if (v==null) v = new Vector();
        String[] column = {"วันที่ปรับปรุงล่าสุด"};
        GutilPCU.setLanguage(column);
        TaBleModel tm = new TaBleModel(column, v.size());
        
        for (int i=0 ; i<v.size(); i++) {
            Exercise exercise = (Exercise)v.get(i);
            tm.setValueAt(GutilPCU.changDateToString(exercise.record_time), i, 0);            
        }
        this.jTable2.setModel(tm);
    }
    
    public void updateOGExercise(Exercise exercise) {
        //ใส่ค่าในปีงบประมาณ
        this.jTextFieldYearBudget.setText(exercise.idy);
        //ใส่ค่าในวันที่สำรวจ
        this.dateComboBox1.setText(DateUtil.convertFieldDate(exercise.date_serv));
        //ใส่ค่าใน radio ประเภทการออกกำลังกาย
        this.jRdoBtnNoExercise.setSelected(false);
        this.jRdoBtnCustomExercise.setSelected(false);
        this.jRdoBtnNoCustomExercise.setSelected(false);
        if (exercise.exerciseType_id.equals(ExerciseType.CUSTOM_EXERCISE))
            this.jRdoBtnCustomExercise.setSelected(true);
        else if (exercise.exerciseType_id.equals(ExerciseType.NO_CUSTOM_EXERCISE))
            this.jRdoBtnNoCustomExercise.setSelected(true);
        else if (exercise.exerciseType_id.equals(ExerciseType.NO_EXERCISE))
            this.jRdoBtnNoExercise.setSelected(true);
        
        if (exercise.getObjectId() == null) {            
            this.jRdoBtnNoCustomExercise.setSelected(true);            
            this.jTextFieldYearBudget.setText(theHtControl.getYear());
        }
    }
    
    public void updateGOExercise(Exercise exercise) {
        exercise.family_id = theFamily.getObjectId();
       exercise.idy = this.jTextFieldYearBudget.getText();
       exercise.date_serv = this.dateComboBox1.getText();
       
       if (this.jRdoBtnCustomExercise.isSelected())
           exercise.exerciseType_id = ExerciseType.CUSTOM_EXERCISE;
       else if (this.jRdoBtnNoCustomExercise.isSelected())
           exercise.exerciseType_id = ExerciseType.NO_CUSTOM_EXERCISE;
       else if (this.jRdoBtnNoExercise.isSelected())
           exercise.exerciseType_id = ExerciseType.NO_EXERCISE;
    }
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        buttonGroupExercise = new javax.swing.ButtonGroup();
        jPanelExercise = new javax.swing.JPanel();
        jPanel13 = new javax.swing.JPanel();
        jScrollPane2 = new javax.swing.JScrollPane();
        jTable2 = new javax.swing.JTable();
        jPanel15 = new javax.swing.JPanel();
        jLabel32 = new javax.swing.JLabel();
        jLabel33 = new javax.swing.JLabel();
        jLabel34 = new javax.swing.JLabel();
        jPanel30 = new javax.swing.JPanel();
        jRdoBtnNoExercise = new javax.swing.JRadioButton();
        jRdoBtnCustomExercise = new javax.swing.JRadioButton();
        jRdoBtnNoCustomExercise = new javax.swing.JRadioButton();
        dateComboBox1 = new com.hospital_os.utility.DateComboBox();
        jTextFieldYearBudget = new javax.swing.JTextField();
        jPanel17 = new javax.swing.JPanel();
        jButtonAdd = new javax.swing.JButton();
        jButtonDelete = new javax.swing.JButton();
        jButtonSave = new javax.swing.JButton();

        setLayout(new java.awt.BorderLayout());

        jPanelExercise.setLayout(new java.awt.GridBagLayout());

        jPanelExercise.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                jPanelExerciseMouseReleased(evt);
            }
        });

        jPanel13.setLayout(new java.awt.GridBagLayout());

        jPanel13.setBorder(javax.swing.BorderFactory.createTitledBorder("\u0e1b\u0e23\u0e30\u0e27\u0e31\u0e15\u0e34\u0e01\u0e32\u0e23\u0e04\u0e31\u0e14\u0e01\u0e23\u0e2d\u0e07"));
        jPanel13.setMinimumSize(new java.awt.Dimension(180, 90));
        jPanel13.setPreferredSize(new java.awt.Dimension(180, 90));
        jScrollPane2.setFont(new java.awt.Font("MS Sans Serif", 0, 10));
        jScrollPane2.setMinimumSize(new java.awt.Dimension(24, 150));
        jScrollPane2.setPreferredSize(new java.awt.Dimension(4, 150));
        jTable2.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null}
            },
            new String [] {
                "Title 1"
            }
        ));
        jTable2.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                jTable2MouseReleased(evt);
            }
        });

        jScrollPane2.setViewportView(jTable2);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel13.add(jScrollPane2, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.VERTICAL;
        gridBagConstraints.weighty = 1.0;
        jPanelExercise.add(jPanel13, gridBagConstraints);

        jPanel15.setLayout(new java.awt.GridBagLayout());

        jPanel15.setBorder(javax.swing.BorderFactory.createTitledBorder("\u0e02\u0e49\u0e2d\u0e21\u0e39\u0e25\u0e01\u0e32\u0e23\u0e2d\u0e2d\u0e01\u0e01\u0e33\u0e25\u0e31\u0e07\u0e01\u0e32\u0e22"));
        jLabel32.setText("\u0e1b\u0e35\u0e07\u0e1a\u0e1b\u0e23\u0e30\u0e21\u0e32\u0e13 : ");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(2, 2, 0, 0);
        jPanel15.add(jLabel32, gridBagConstraints);

        jLabel33.setText("\u0e27\u0e31\u0e19\u0e17\u0e35\u0e48\u0e2a\u0e33\u0e23\u0e27\u0e08 : ");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.insets = new java.awt.Insets(2, 11, 0, 0);
        jPanel15.add(jLabel33, gridBagConstraints);

        jLabel34.setText("\u0e01\u0e32\u0e23\u0e2d\u0e2d\u0e01\u0e01\u0e33\u0e25\u0e31\u0e07\u0e01\u0e32\u0e22 : ");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(0, 2, 2, 0);
        jPanel15.add(jLabel34, gridBagConstraints);

        jPanel30.setLayout(new java.awt.GridBagLayout());

        buttonGroupExercise.add(jRdoBtnNoExercise);
        jRdoBtnNoExercise.setText("\u0e44\u0e21\u0e48\u0e2d\u0e2d\u0e01\u0e01\u0e33\u0e25\u0e31\u0e07\u0e01\u0e32\u0e22");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        jPanel30.add(jRdoBtnNoExercise, gridBagConstraints);

        buttonGroupExercise.add(jRdoBtnCustomExercise);
        jRdoBtnCustomExercise.setText("\u0e21\u0e35\u0e41\u0e1a\u0e1a\u0e41\u0e1c\u0e19");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 0, 0);
        jPanel30.add(jRdoBtnCustomExercise, gridBagConstraints);

        buttonGroupExercise.add(jRdoBtnNoCustomExercise);
        jRdoBtnNoCustomExercise.setSelected(true);
        jRdoBtnNoCustomExercise.setText("\u0e44\u0e21\u0e48\u0e21\u0e35\u0e41\u0e1a\u0e1a\u0e41\u0e1c\u0e19");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        jPanel30.add(jRdoBtnNoCustomExercise, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 2, 2);
        jPanel15.add(jPanel30, gridBagConstraints);

        dateComboBox1.setMinimumSize(new java.awt.Dimension(100, 24));
        dateComboBox1.setPreferredSize(new java.awt.Dimension(100, 24));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        jPanel15.add(dateComboBox1, gridBagConstraints);

        jTextFieldYearBudget.setMinimumSize(new java.awt.Dimension(100, 24));
        jTextFieldYearBudget.setPreferredSize(new java.awt.Dimension(100, 24));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        jPanel15.add(jTextFieldYearBudget, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 0, 0);
        jPanelExercise.add(jPanel15, gridBagConstraints);

        jPanel17.setLayout(new java.awt.GridBagLayout());

        jButtonAdd.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/hosv3/gui/images/plus16.gif")));
        jButtonAdd.setMargin(new java.awt.Insets(0, 0, 0, 0));
        jButtonAdd.setMaximumSize(new java.awt.Dimension(24, 24));
        jButtonAdd.setMinimumSize(new java.awt.Dimension(24, 24));
        jButtonAdd.setPreferredSize(new java.awt.Dimension(24, 24));
        jButtonAdd.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonAddActionPerformed(evt);
            }
        });

        jPanel17.add(jButtonAdd, new java.awt.GridBagConstraints());

        jButtonDelete.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/hosv3/gui/images/minus16.gif")));
        jButtonDelete.setMargin(new java.awt.Insets(0, 0, 0, 0));
        jButtonDelete.setMaximumSize(new java.awt.Dimension(24, 24));
        jButtonDelete.setMinimumSize(new java.awt.Dimension(24, 24));
        jButtonDelete.setPreferredSize(new java.awt.Dimension(24, 24));
        jButtonDelete.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonDeleteActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 0);
        jPanel17.add(jButtonDelete, gridBagConstraints);

        jButtonSave.setText("\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01");
        jButtonSave.setMargin(new java.awt.Insets(0, 0, 0, 0));
        jButtonSave.setMaximumSize(new java.awt.Dimension(60, 24));
        jButtonSave.setMinimumSize(new java.awt.Dimension(60, 24));
        jButtonSave.setPreferredSize(new java.awt.Dimension(60, 24));
        jButtonSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.weightx = 1.0;
        jPanel17.add(jButtonSave, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanelExercise.add(jPanel17, gridBagConstraints);

        add(jPanelExercise, java.awt.BorderLayout.CENTER);

    }// </editor-fold>//GEN-END:initComponents

    private void jTable2MouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jTable2MouseReleased
        this.setCursor(new java.awt.Cursor(java.awt.Cursor.WAIT_CURSOR));            
        int index = this.jTable2.getSelectedRow();
        if(index==-1)
            return;
        theExercise = (Exercise)theExerciseV.get(index);
        updateOGExercise(theExercise);
        /*this.jTextFieldStatus.setText(theImageLink.image_path);
        this.jTextFieldHN1.setText(theImageLink.note);
        this.jCheckBox1.setSelected(theImageLink.note.equals(
            ImageLink.ST_PatientImage));
        this.jTextFieldHN1.setEditable(!this.jCheckBox1.isSelected());*/
        this.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR)); 
        buttonDeleteEnable();
        setEnable();
    }//GEN-LAST:event_jTable2MouseReleased

    private void jPanelExerciseMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_jPanelExerciseMouseReleased
        
    }//GEN-LAST:event_jPanelExerciseMouseReleased

    private void jButtonSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonSaveActionPerformed
        this.updateGOExercise(theExercise);
        this.theHtControl.saveExercise(theExercise);
        this.updateFamily(theFamily);
        buttonDeleteEnable();
    }//GEN-LAST:event_jButtonSaveActionPerformed

    private void jButtonDeleteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonDeleteActionPerformed
        if (theUS.confirmBox("คุณต้องการลบข้อมูลที่เลือกหรือไม่",UpdateStatus.WARNING))
        {
            this.theHtControl.deleteExercise(theExercise);
            this.updateFamily(theFamily);
            theExercise = new Exercise();
            updateOGExercise(theExercise);
            buttonDeleteEnable();
            setDisable();
        }
    }//GEN-LAST:event_jButtonDeleteActionPerformed

    private void jButtonAddActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonAddActionPerformed
        theExercise = new Exercise(); 
        this.updateOGExercise(theExercise);
        setEnable();
    }//GEN-LAST:event_jButtonAddActionPerformed
    
     private void setEnable() {
        this.jTextFieldYearBudget.setEnabled(true);
        this.dateComboBox1.setEnabled(true);
        this.jRdoBtnCustomExercise.setEnabled(true);
        this.jRdoBtnNoCustomExercise.setEnabled(true);
        this.jRdoBtnNoExercise.setEnabled(true);
        this.jButtonSave.setEnabled(true);
     }
     
     private void buttonDeleteEnable() {
        if (theExercise.getObjectId()!=null) 
            this.jButtonDelete.setEnabled(true);
        else
            this.jButtonDelete.setEnabled(false);
    }
     
     private void setDisable() {
        this.jTextFieldYearBudget.setEnabled(false);
        this.dateComboBox1.setEnabled(false);
        this.jRdoBtnCustomExercise.setEnabled(false);
        this.jRdoBtnNoCustomExercise.setEnabled(false);
        this.jRdoBtnNoExercise.setEnabled(false);
        this.jButtonSave.setEnabled(false);
     }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.ButtonGroup buttonGroupExercise;
    private com.hospital_os.utility.DateComboBox dateComboBox1;
    private javax.swing.JButton jButtonAdd;
    private javax.swing.JButton jButtonDelete;
    private javax.swing.JButton jButtonSave;
    private javax.swing.JLabel jLabel32;
    private javax.swing.JLabel jLabel33;
    private javax.swing.JLabel jLabel34;
    private javax.swing.JPanel jPanel13;
    private javax.swing.JPanel jPanel15;
    private javax.swing.JPanel jPanel17;
    private javax.swing.JPanel jPanel30;
    private javax.swing.JPanel jPanelExercise;
    private javax.swing.JRadioButton jRdoBtnCustomExercise;
    private javax.swing.JRadioButton jRdoBtnNoCustomExercise;
    private javax.swing.JRadioButton jRdoBtnNoExercise;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JTable jTable2;
    private javax.swing.JTextField jTextFieldYearBudget;
    // End of variables declaration//GEN-END:variables

    public void updateFamily(Family family) {
        theFamily = family;
        Vector familyV = theHtControl.listExerciseByFid(family.getObjectId());
        updateOGExercise(familyV);
        updateOGExercise(new Exercise());
   }
   public void showDialog(Family family) 
   {
        if(jDialog==null)
        {        
            if(theHtControl.theUS!=null)
                jDialog = new JDialog(this.theHtControl.theUS.getJFrame(),true);
            else
                jDialog = new JDialog();
            jDialog.getContentPane().add(this);
            jDialog.setSize(650, 140);
            Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();
            jDialog.setLocation((screenSize.width-jDialog.getSize().width)/2
                    , (screenSize.height-jDialog.getSize().height)/2);
        }
        updateFamily(family);
        setDisable();
        jDialog.setVisible(true);
    }
   
//   public static void showDialog(Family family, ConnectionInf con) {
//        JDialog jDialog = new JDialog();
//        PanelExercise panel = new PanelExercise();
//        jDialog.getContentPane().add(panel);
//        HtControl hc = new HtControl(con);
//        panel.setControl(hc);
//        panel.updateFamily(family);
//        jDialog.setSize(660, 330);
//        jDialog.setVisible(true);
//       
//    }
   
    public static void main(String[] argc)
    {
        System.setProperty("debug", "1");
        Family family = new Family();
        family.hospital_site = "00000";
        family.setObjectId("555");
        PanelExercise thePanelExercise = new PanelExercise();
        HtControl hc = new HtControl();
        //hc.setUpdateStatus(thePanelExercise);
        thePanelExercise.setControl(hc,hc.theUS);
        thePanelExercise.showDialog(family);
    }

    private void setLanguage() {
        GutilPCU.setLanguage(jPanel13);
        GutilPCU.setLanguage(jPanel15);
        GutilPCU.setLanguage(jLabel32);
        GutilPCU.setLanguage(jLabel33);
        GutilPCU.setLanguage(jLabel34);
        GutilPCU.setLanguage(jRdoBtnNoExercise);
        GutilPCU.setLanguage(jRdoBtnCustomExercise);
        GutilPCU.setLanguage(jRdoBtnNoCustomExercise);
        GutilPCU.setLanguage(jButtonSave);

    }
    
}

