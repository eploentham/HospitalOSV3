/*
 * DialogPersonStatus.java
 *
 * Created on 28 กุมภาพันธ์ 2549, 13:39 น.
 */

package com.pcu.gui.dialog;

import com.pcu.control.HosManage;
import com.pcu.control.AllComboBoxControl;
import com.pcu.control.HomeControl;
import com.pcu.object.*;
import com.pcu.subject.HomePatientSubject;
import com.pcu.utility.GutilPCU;
import java.awt.*;
import javax.swing.*;

import com.hospital_os.utility.ComboboxModel;
import com.hospital_os.utility.Gutil;
import com.hospital_os.object.*; 

import com.hosv3.gui.dialog.DialogDeath;
/**
 *
 * @author  Jao
 */
public class DialogPersonStatus extends javax.swing.JDialog {
    
    private HosManage theHosManage;
    private AllComboBoxControl theAllComboBoxControl;
    private HomeControl theHomeControl;
    private Family theFamily;
    private HomePatientSubject theHomePatientSubject;
    private DialogDeath theDialogDeath;
    boolean action_perform = false;
    
    /** Creates new form DialogPersonStatus */
    public DialogPersonStatus(HosManage hm,JFrame frm) { 
        super(frm,true);
        theHosManage = hm;
        theAllComboBoxControl = hm.theHosControl.theAllComboBoxControl;
        theHomeControl = hm.theHosControl.theHomeControl;
        theHomePatientSubject = hm.theHosSubject.theHomePatientSubject;
        initComponents();
        setSize(400,170);
        setTitle("บันทึกสถานะประชากร");
        initData();
        setLanguage();
        
    }
    
    private void initData()
    {
        ComboboxModel.initComboBox(jComboBoxDischargeStatus,theAllComboBoxControl.listDischargeStatus());
    }
    
    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel1 = new javax.swing.JPanel();
        jPanel2 = new javax.swing.JPanel();
        jComboBoxDischargeStatus = new javax.swing.JComboBox();
        jLabelType = new javax.swing.JLabel();
        jLabelDischargedate = new javax.swing.JLabel();
        dateComboBoxDischargedate = new com.pcu.utility.DateComboBox();
        jPanel3 = new javax.swing.JPanel();
        jButtonSave = new javax.swing.JButton();
        jButtonCancel = new javax.swing.JButton();

        getContentPane().setLayout(new java.awt.GridBagLayout());

        jPanel1.setLayout(new java.awt.GridBagLayout());

        jPanel1.setMaximumSize(new java.awt.Dimension(229, 95));
        jPanel1.setMinimumSize(new java.awt.Dimension(229, 95));
        jPanel1.setPreferredSize(new java.awt.Dimension(229, 95));
        jPanel2.setLayout(new java.awt.GridBagLayout());

        jComboBoxDischargeStatus.setMaximumSize(new java.awt.Dimension(100, 24));
        jComboBoxDischargeStatus.setMinimumSize(new java.awt.Dimension(100, 24));
        jComboBoxDischargeStatus.setPreferredSize(new java.awt.Dimension(100, 24));
        jComboBoxDischargeStatus.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jComboBoxDischargeStatusActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel2.add(jComboBoxDischargeStatus, gridBagConstraints);

        jLabelType.setText("Discharge_status");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel2.add(jLabelType, gridBagConstraints);

        jLabelDischargedate.setText("Discharge_date");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel2.add(jLabelDischargedate, gridBagConstraints);

        dateComboBoxDischargedate.setEditable(true);
        dateComboBoxDischargedate.setMinimumSize(new java.awt.Dimension(100, 20));
        dateComboBoxDischargedate.setPreferredSize(new java.awt.Dimension(100, 20));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 0);
        jPanel2.add(dateComboBoxDischargedate, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(5, 5, 0, 5);
        jPanel1.add(jPanel2, gridBagConstraints);

        jPanel3.setLayout(new java.awt.GridBagLayout());

        jButtonSave.setText("\u0e1a\u0e31\u0e19\u0e17\u0e36\u0e01");
        jButtonSave.setMaximumSize(new java.awt.Dimension(72, 26));
        jButtonSave.setMinimumSize(new java.awt.Dimension(72, 26));
        jButtonSave.setPreferredSize(new java.awt.Dimension(72, 26));
        jButtonSave.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonSaveActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.weightx = 1.0;
        jPanel3.add(jButtonSave, gridBagConstraints);

        jButtonCancel.setText("\u0e22\u0e01\u0e40\u0e25\u0e34\u0e01");
        jButtonCancel.setMaximumSize(new java.awt.Dimension(72, 26));
        jButtonCancel.setMinimumSize(new java.awt.Dimension(72, 26));
        jButtonCancel.setPreferredSize(new java.awt.Dimension(72, 26));
        jButtonCancel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButtonCancelActionPerformed(evt);
            }
        });

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.anchor = java.awt.GridBagConstraints.EAST;
        gridBagConstraints.insets = new java.awt.Insets(0, 3, 0, 0);
        jPanel3.add(jButtonCancel, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 5, 1, 5);
        jPanel1.add(jPanel3, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        getContentPane().add(jPanel1, gridBagConstraints);

    }
    // </editor-fold>//GEN-END:initComponents

    private void jButtonSaveActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonSaveActionPerformed

        updatePerson();
        action_perform = true;
        dispose();
    }//GEN-LAST:event_jButtonSaveActionPerformed

    private void jComboBoxDischargeStatusActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jComboBoxDischargeStatusActionPerformed

        setVisitbleGui();        
    }//GEN-LAST:event_jComboBoxDischargeStatusActionPerformed

    private void jButtonCancelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButtonCancelActionPerformed
        
        dispose();
    }//GEN-LAST:event_jButtonCancelActionPerformed
    /**
     * Show Dialog
     * @param  Object fm
     * @return  boolean
     * @author jao
     * @date 27-02-2549
     */
     public boolean showDialog(Family fm)
    {
         action_perform = false;
        this.theFamily = fm;
        setSize(250,150);
        setTitle("บันทึกสถานะประชากร");         
        Toolkit thekit = getToolkit();
        Dimension screenSize = Toolkit.getDefaultToolkit().getScreenSize();//thekit.getScreenSize();
      //  dlg.setBounds((screenSize.width + dlg.getSize().width + 200 )/4,(screenSize.height + dlg.getSize().height + 50)/4, dlg.getSize().width,dlg.getSize().height);
        setLocation((screenSize.width-getSize().width)/2, (screenSize.height-getSize().height)/2);                        
        setVisible(true);
        if(this.theFamily!=null)
        {     
            setDatatoGui(this.theFamily);           
        }
        return action_perform;
     }
     
     
   /**
     * Set ค่าลงใน Dialog
     * @param  Object family
     * @return  
     * @author jao
     * @date 01-03-2549
     */
     private void setDatatoGui(Family family)
     {
         if(!family.discharge_status_id.equals(""))
         {
             ComboboxModel.setCodeComboBox(this.jComboBoxDischargeStatus,family.discharge_status_id);
             this.dateComboBoxDischargedate.setText(Gutil.convertFieldDate(family.discharge_date_time));
             
         }
     }
     
     /**
     * Update ข้อมูลสถานะ
     * @param  
     * @return  
     * @author jao
     * @date 01-03-2549
     */
     private void updatePerson()
     {  String dis = Gutil.getGuiData(this.jComboBoxDischargeStatus); 
        if(dis.equals(Dischar.DEATH))
        {   
            this.theFamily.discharge_status_id = Gutil.getGuiData(this.jComboBoxDischargeStatus);
            this.theFamily.discharge_date_time = this.dateComboBoxDischargedate.getText();
            return;
        }
        else if(dis.equals(Dischar.MOVE))        
        {   
            this.theFamily.discharge_status_id = Gutil.getGuiData(this.jComboBoxDischargeStatus);
            this.theFamily.discharge_date_time = this.dateComboBoxDischargedate.getText();
        }
        else
        {   
            this.theFamily.discharge_status_id = Gutil.getGuiData(this.jComboBoxDischargeStatus);            
            this.theFamily.discharge_date_time = this.dateComboBoxDischargedate.getText();
        }
        this.theFamily.modify_date_time = Gutil.getTextCurrentDateTime(this.theAllComboBoxControl.theConnectionInf);
        theHomePatientSubject.notifySaveStatus(this.theFamily, 1);
     }
     
    /**
     * ซ่อน DateComboBox
     * @param  
     * @return 
     * @author jao
     * @date 1-03-2549
     */ 
    private void setVisitbleGui()
    {
        String dis = Gutil.getGuiData(this.jComboBoxDischargeStatus); 
        if(dis.equals(Dischar.DEATH))
        {
            
            
            dateComboBoxDischargedate.setVisible(true);
            jLabelDischargedate.setVisible(true);            
        }       
        else
        {
            
            dateComboBoxDischargedate.setVisible(true);
            jLabelDischargedate.setVisible(true);
        }
    }
     
    
    /**
     * Set ภาษา
     * @param  
     * @return 
     * @author jao
     * @date 1-03-2549
     */
     public void setLanguage()
    {
        jLabelType.setText(GutilPCU.getTextBundle(jLabelType.getText()));
        jLabelDischargedate.setText(GutilPCU.getTextBundle(jLabelDischargedate.getText()));
        
      
    } 
     
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private com.pcu.utility.DateComboBox dateComboBoxDischargedate;
    private javax.swing.JButton jButtonCancel;
    private javax.swing.JButton jButtonSave;
    private javax.swing.JComboBox jComboBoxDischargeStatus;
    private javax.swing.JLabel jLabelDischargedate;
    private javax.swing.JLabel jLabelType;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPanel jPanel3;
    // End of variables declaration//GEN-END:variables
    
}
