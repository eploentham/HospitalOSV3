package com.pcu.utility;import java.awt.event.*;import javax.swing.*;import java.text.*;import javax.swing.text.*;/** * <p>Title: </p> * <p>Description: </p> * <p>Copyright: Copyright (c) 2003</p> * <p>Company: </p> * @author neng * @version 1.0 */public class DoubleTextField extends JTextField implements KeyListener, FocusListener{  /** ตัวจัดรูปแบบทศนิยม */  public NumberFormat numberFormat = NumberFormat.getInstance();  public DoubleTextField()  {    setDocument(new DoubleDocument());    addKeyListener(this);    addFocusListener(this);    numberFormat.setMaximumFractionDigits(2);    numberFormat.setGroupingUsed(false);  }  /** ช่วยควบคุมรูปแบบตัวเลข */  protected class DoubleDocument extends PlainDocument  {    public void insertString(int offs, String str, AttributeSet a) throws BadLocationException    {     if(str!=null)     {      char[] source = str.toCharArray();      char[] result = new char[source.length];      int j = 0;      // ตรวจสอบการมีจุด      boolean noDot = true;      for(int i = 0; i<result.length; i++)      {        if(Character.isDigit(source[i]) || (source[i]=='.'))        {          if(source[i]!='.')          {            result[j++] = source[i];          }          else if(source[i]=='.' && noDot)          {            result[j++] = source[i];            noDot = false;          }                  }        else        {          //Toolkit.getDefaultToolkit().beep();           // Constant.println("Char : " + source[i]);        }      }      super.insertString(offs, new String(result, 0, j), a);     }    }   public void remove(int offs, int len) throws BadLocationException    {      super.remove(offs, len);    }  }  public void keyReleased(KeyEvent e)  {   try   {     if(e.getKeyCode()!=KeyEvent.VK_UP && e.getKeyCode()!=KeyEvent.VK_DOWN &&      e.getKeyCode()!=KeyEvent.VK_LEFT && e.getKeyCode()!=KeyEvent.VK_RIGHT &&      e.getKeyCode()!=KeyEvent.VK_TAB && e.getKeyCode()!=KeyEvent.VK_SHIFT       )     {       numberFormat.parse(getText());     }    }    catch(Exception ex)    {    //ex.printStackTrace();    }  }  public void keyPressed(KeyEvent e)  {  }  public void keyTyped(KeyEvent e)  {  }  public void focusGained(FocusEvent e)  {    setSelectionStart(0);  }  public void focusLost(FocusEvent e)  {  }      public static void  main(String[] argv)  {             DoubleTextField dtf = new DoubleTextField();      JButton button = new JButton("OK");      JFrame frm = new JFrame("Test HNTextField");      dtf.setText("093.09");      frm.getContentPane().add(dtf);            dtf.setSize(100, 21);      frm.pack();      frm.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);      frm.setVisible(true);      frm.setVisible(true);        }}